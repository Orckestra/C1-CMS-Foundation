bespin.tiki.register("::text_editor",{name:"text_editor",dependencies:{completion:"0.0.0",undomanager:"0.0.0",settings:"0.0.0",canon:"0.0.0",rangeutils:"0.0.0",traits:"0.0.0",theme_manager:"0.0.0",keyboard:"0.0.0",edit_session:"0.0.0",syntax_manager:"0.0.0"}});
bespin.tiki.module("text_editor:commands/editing",function(A,u){var v=A("settings").settings,r=A("environment").env,o=A("rangeutils:utils/range");u.backspace=function(){r.view.performBackspaceOrDelete(true)};u.deleteCommand=function(){r.view.performBackspaceOrDelete(false)};u.deleteLines=function(){if(!r.model.readOnly)if(r.model.lines.length!=1){var e=r.view;e.groupChanges(function(){var f=e.getSelectedRange(),q=r.model.lines,h=q.length-1,k;k=f.start.row==h?{col:q[h-1].length,row:h-1}:{col:0,row:f.start.row};
e.replaceCharacters({start:k,end:f.end.row==h?{col:q[h].length,row:h}:{col:0,row:f.end.row+1}},"");e.moveCursorTo(k)})}};var i=function(e,f){var q=f.getSelectedRange().start;e=/^\s*/.exec(e.lines[q.row].substring(0,q.col));f.insertText("\n"+e)};u.insertText=function(e){r.view.insertText(e.text)};u.newline=function(){i(r.model,r.view)};u.joinLines=function(){var e=r.model;if(!e.readOnly){var f=r.view,q=f.getSelectedRange(),h=e.lines,k=q.end.row;h.length!=k&&f.groupChanges(function(){f.replaceCharacters({start:{col:h[k].length,
row:k},end:{col:/^\s*/.exec(h[k+1])[0].length,row:k+1}},"")})}};u.openLine=function(){if(!r.model.readOnly){var e=r.model,f=r.view,q=f.getSelectedRange().end.row;f.moveCursorTo({row:q,col:e.lines[q].length});i(e,f)}};u.tab=function(){var e=r.view;e.groupChanges(function(){var f=v.get("tabstop"),q=e.getSelectedRange(),h="";if(o.isZeroLength(q)){var k=r.model.lines[q.start.row].substring(q.start.col).match(/^\s*/)[0].length;f=f-(q.start.col+k)%f;for(var j=0;j<f;j++)h+=" ";e.replaceCharacters({start:q.start,
end:q.start},h);e.moveCursorTo({col:q.start.col+f+k,row:q.end.row})}else{for(j=0;j<f;j++)h+=" ";for(j=q.start.row-1;j++<q.end.row;){k=j==q.start.row?q.start.col:0;e.replaceCharacters({start:{row:j,col:k},end:{row:j,col:k}},h)}e.setSelection({start:q.start,end:{col:q.end.col+f,row:q.end.row}})}}.bind(this))};u.untab=function(){var e=r.view;e.groupChanges(function(){var f=v.get("tabstop"),q=e.getSelectedRange(),h=r.model.lines,k=0;if(o.isZeroLength(q)){k=Math.min(h[q.start.row].substring(0,q.start.col).match(/\s*$/)[0].length,
(q.start.col-f)%f||f);e.replaceCharacters({start:{col:q.start.col-k,row:q.start.row},end:q.start},"");e.moveCursorTo({row:q.start.row,col:q.end.col-k})}else{for(var j,p=q.start.row-1;p++<q.end.row;){j=p==q.start.row?q.start.col:0;k=Math.min(h[p].substring(j).match(/^\s*/)[0].length,f);e.replaceCharacters({start:{row:p,col:j},end:{row:p,col:j+k}},"")}e.setSelection({start:{row:q.start.row,col:q.start.col},end:{row:q.end.row,col:q.end.col-k}})}}.bind(this))}});
bespin.tiki.module("text_editor:commands/editor",function(A,u){A("bespin:plugins");var v=A("settings").settings,r=A("environment").env;u.findNextCommand=function(){var i=r.view,e=i.editor.searchController,f=i.getSelectedRange();if(e=e.findNext(f.end,true)){i.setSelection(e,true);i.focus()}};u.findPrevCommand=function(){var i=r.view,e=i.editor.searchController,f=i.getSelectedRange();if(e=e.findPrevious(f.start,true)){i.setSelection(e,true);i.focus()}};var o=function(i){var e=r.view,f=e.getSelectedCharacters();
i=i(f);e=e.getSelectedRange();r.model.replaceCharacters(e,i)};u.replaceCommand=function(i){o(function(e){return e.replace(i.search+"/g",i.replace)})};u.entabCommand=function(){tabstop=v.get("tabstop");o(function(i){return i.replace(" {"+tabstop+"}","\t")})};u.detabCommand=function(){tabstop=v.get("tabstop");o(function(i){return i.replace("\t",(new Array(tabstop+1)).join(" "))})};u.trimCommand=function(i){o(function(e){e=e.split("\n");e=e.map(function(f){if(i.side==="left"||i.side==="both")f=f.replace(/^\s+/,
"");if(i.side==="right"||i.side==="both")f=f.replace(/\s+$/,"");return f});return e.join("\n")})};u.ucCommand=function(){o(function(i){return i.toUpperCase()})};u.lcCommand=function(){o(function(i){return i.toLowerCase()})}});
bespin.tiki.module("text_editor:commands/movement",function(A,u){A("rangeutils:utils/range");var v=A("environment").env;u.moveDown=function(){v.view.moveDown()};u.moveLeft=function(){v.view.moveLeft()};u.moveRight=function(){v.view.moveRight()};u.moveUp=function(){v.view.moveUp()};u.selectDown=function(){v.view.selectDown()};u.selectLeft=function(){v.view.selectLeft()};u.selectRight=function(){v.view.selectRight()};u.selectUp=function(){v.view.selectUp()};var r=function(q,h){var k=v.view,j=v.model.lines,
p=k.getSelectedRange(true);h=h?p.end.row:j.length-1;k.moveCursorTo({row:h,col:j[h].length},q)};u.moveLineEnd=function(){r(false,true)};u.selectLineEnd=function(){r(true,true)};u.moveDocEnd=function(){r(false,false)};u.selectDocEnd=function(){r(true,false)};var o=function(q,h){var k=v.view,j=k.getSelectedRange(true);k.moveCursorTo({row:h?j.end.row:0,col:0},q)};u.moveLineStart=function(){o(false,true)};u.selectLineStart=function(){o(true,true)};u.moveDocStart=function(){o(false,false)};u.selectDocStart=
function(){o(true,false)};var i=function(q,h,k,j,p){var t=0,B=false;if(j<0){k--;if(p)t=1}for(;k<h.length&&k>-1;){if(p=q.isDelimiter(h[k]))t++;else B=true;if((p||t>1)&&B)break;k+=j}j<0&&k++;return k},e=function(q){var h=v.view,k=v.model.lines,j=h.getSelectedRange(true).end,p=j.row;j=j.col;var t=k[p],B=false;if(j>=t.length){p++;B=true;if(p<k.length){j=0;t=k[p]}else t=""}j=i(h,t,j,1,B);h.moveCursorTo({row:p,col:j},q)},f=function(q){var h=v.view,k=v.model.lines,j=h.getSelectedRange(true).end,p=j.row;
j=j.col;var t=k[p],B=false;if(j>t.length)j=t.length;else if(j==0){p--;B=true;if(p>-1){t=k[p];j=t.length}else t=""}j=i(h,t,j,-1,B);h.moveCursorTo({row:p,col:j},q)};u.moveNextWord=function(){e(false)};u.selectNextWord=function(){e(true)};u.movePreviousWord=function(){f(false)};u.selectPreviousWord=function(){f(true)};u.selectAll=function(){v.view.selectAll()}});
bespin.tiki.module("text_editor:commands/scrolling",function(A,u){var v=A("environment").env;u.scrollDocStart=function(){v.view.scrollToPosition({col:0,row:0})};u.scrollDocEnd=function(){v.view.scrollToPosition(v.model.range.end)};u.scrollPageDown=function(){v.view.scrollPageDown()};u.scrollPageUp=function(){v.view.scrollPageUp()}});
bespin.tiki.module("text_editor:controllers/layoutmanager",function(A,u){var v=A("bespin:util/util"),r=A("events").Event;A("rangeutils:utils/range");var o=A("syntax_manager").SyntaxManager,i=A("models/textstorage").TextStorage,e=A("bespin:plugins").catalog,f=A("settings").settings,q=A("bespin:util/scratchcanvas"),h={};A=function(){var k=f.get("fontsize"),j=f.get("fontface");j=k+"px "+j;for(var p=q.get(),t="",B=0;B<100;B++)t+="M";j=p.measureStringWidth(j,t)/100;h.characterWidth=j;h.lineHeight=Math.floor(k*
1.6);h.lineAscent=Math.floor(k*1.3)};A();e.registerExtension("settingChange",{match:"font[size|face]",pointer:A});u.LayoutManager=function(k){this.changedTextAtRow=new r;this.invalidatedRects=new r;this.fontDimension=h;if(k.textStorage){k._textStorage=k.textStorage;delete k.textStorage}else this._textStorage=new i;v.mixin(this,k);this._textStorage.changed.add(this.textStorageChanged.bind(this));this.textLines=[{characters:"",colors:[{start:0,end:0,color:"plain"}]}];this.syntaxManager=k=new o(this);
k.attrsChanged.add(this._attrsChanged.bind(this));this._size={width:0,height:0};this.sizeChanged=new r;this._height=0;this._recomputeEntireLayout()};u.LayoutManager.prototype={_maximumWidth:0,_textStorage:null,_size:null,sizeChanged:null,_theme:{},margin:{left:5,bottom:6,top:0,right:12},pluginCatalog:e,syntaxManager:null,textLines:null,_attrsChanged:function(k,j){this.updateTextRows(k,j);this.invalidatedRects(this,this.rectsForRange({start:{row:k,col:0},end:{row:j,col:0}}))},_computeInvalidRects:function(k,
j){var p=this.characterRectForPosition(k.start),t={x:p.x,y:p.y,width:Number.MAX_VALUE,height:p.height};return k.end.row===j.end.row?[t]:[t,{x:0,y:p.y+h.lineHeight,width:Number.MAX_VALUE,height:Number.MAX_VALUE}]},_lastCharacterPosition:function(){return{row:this.textLines.length-1,col:this._maximumWidth}},_recalculateMaximumWidth:function(){var k=0;this.textLines.forEach(function(j){j=j.characters.length;if(k<j)k=j});this._maximumWidth=k;this.size={width:k,height:this.textLines.length}},_recomputeEntireLayout:function(){var k=
this._textStorage.range;this._recomputeLayoutForRanges(k,k)},_recomputeLayoutForRanges:function(k,j){for(var p=k.start.row,t=k.end.row,B=j.end.row,C=B-p+1,d=this._textStorage.lines,J=this._theme.plain,M=[],l=0;l<C;l++)M[l]={characters:d[p+l],colors:[{start:0,end:null,color:J}]};this.textLines=v.replace(this.textLines,p,t-p+1,M);this._recalculateMaximumWidth();t=this.textLines.length;C=this.syntaxManager;if(this._height!==t)this._height=t;C.invalidateRow(p);this.updateTextRows(p,B+1);this.changedTextAtRow(this,
p);this.invalidatedRects(this,this._computeInvalidRects(k,j))},boundingRect:function(){return this.rectsForRange({start:{row:0,col:0},end:{row:this.textLines.length-1,col:this._maximumWidth}})[0]},characterAtPoint:function(k){var j=this.margin,p=k.x-j.left,t=h.characterWidth,B=this._textStorage;k=B.clampPosition({row:Math.floor((k.y-j.top)/h.lineHeight),col:Math.floor(p/t)});B=B.lines[k.row].length;k.partialFraction=p<0||k.col===B?0:p%t/t;return k},characterRangeForBoundingRect:function(k){var j=
h.lineHeight,p=h.characterWidth,t=this.margin,B=k.x-t.left;t=k.y-t.top;return{start:{row:Math.max(Math.floor(t/j),0),col:Math.max(Math.floor(B/p),0)},end:{row:Math.floor((t+k.height-1)/j),col:Math.floor((B+k.width-1)/p)+1}}},characterRectForPosition:function(k){return this.rectsForRange({start:k,end:{row:k.row,col:k.col+1}})[0]},lineRectForRow:function(k){return this.rectsForRange({start:{row:k,col:0},end:{row:k,col:this._maximumWidth}})[0]},rectForPosition:function(k){var j=this.margin,p=h.characterWidth,
t=h.lineHeight;return{x:j.left+p*k.col,y:j.top+t*k.row,width:p,height:t}},rectsForRange:function(k){var j=h.characterWidth,p=h.lineHeight,t=this._maximumWidth,B=this.margin,C=k.start,d=k.end;k=C.row;var J=C.col;C=d.row;d=d.col;if(k===C)return[{x:B.left+j*J,y:B.top+p*k,width:j*(d-J),height:p}];var M=[],l;if(J===0)l=k;else{l=k+1;M.push({x:B.left+j*J,y:B.top+p*k,width:99999,height:p})}if(d===0)t=C-1;else if(d===t)t=C;else{t=C-1;M.push({x:B.left,y:B.top+p*C,width:j*d,height:p})}M.push({x:B.left,y:B.top+
p*l,width:99999,height:p*(t-l+1)});return M},textStorageChanged:function(k,j){this._recomputeLayoutForRanges(k,j)},updateTextRows:function(k,j){var p=this.textLines;j=this.syntaxManager.getAttrsForRows(k,j);for(var t=0;t<j.length;t++)p[k+t].colors=j[t]}};Object.defineProperties(u.LayoutManager.prototype,{size:{set:function(k){if(k.width!==this._size.width||k.height!==this._size.height){this.sizeChanged(k);this._size=k}},get:function(){return this._size}},textStorage:{get:function(){return this._textStorage}}})});
bespin.tiki.module("text_editor:controllers/search",function(A,u){var v=A("bespin:util/util");A("rangeutils:utils/range");A("bespin:console");u.EditorSearchController=function(r){this.editor=r};u.EditorSearchController.prototype={editor:null,_escapeString:/(\/|\.|\*|\+|\?|\||\(|\)|\[|\]|\{|\}|\\)/g,_findMatchesInString:function(r){var o=[],i=this.searchRegExp,e;for(i.lastIndex=0;;){e=i.exec(r);if(e===null)break;o.push(e);i.lastIndex=e.index+e[0].length}return o},_makeRange:function(r,o){return{start:{row:o,
col:r.index},end:{row:o,col:r.index+r[0].length}}},isRegExp:null,searchRegExp:null,searchText:null,setSearchText:function(r,o){this.searchRegExp=o?new RegExp(r):new RegExp(r.replace(this._escapeString,"\\$1"),"gi");this.isRegExp=o;this.searchText=r},findNext:function(r,o){var i=this.searchRegExp;if(v.none(i))return null;r=r||this.editor.textView.getSelectedRange().end;var e=this.editor.layoutManager.textStorage.lines,f;i.lastIndex=r.col;var q;for(q=r.row;q<e.length;q++){f=i.exec(e[q]);if(!v.none(f))return this._makeRange(f,
q)}if(!o)return null;for(q=0;q<=r.row;q++){f=i.exec(e[q]);if(!v.none(f))return this._makeRange(f,q)}return null},findPrevious:function(r,o){if(v.none(this.searchRegExp))return null;r=r||this.editor.textView.getSelectedRange().start;var i=this.editor.buffer.layoutManager.textStorage.lines,e;e=this._findMatchesInString(i[r.row].substring(0,r.col));if(e.length!==0)return this._makeRange(e[e.length-1],r.row);var f;for(f=r.row-1;f!==-1;f--){e=this._findMatchesInString(i[f]);if(e.length!==0)return this._makeRange(e[e.length-
1],f)}if(!o)return null;for(f=i.length-1;f>=r.row;f--){e=this._findMatchesInString(i[f]);if(e.length!==0)return this._makeRange(e[e.length-1],f)}return null}}});
bespin.tiki.module("text_editor:controllers/undo",function(A,u){var v=A("bespin:console").console,r=A("environment").env;u.EditorUndoController=function(o){this.editor=o;o=this.textView=o.textView;o.beganChangeGroup.add(function(i,e){this._beginTransaction();this._record.selectionBefore=e}.bind(this));o.endedChangeGroup.add(function(i,e){this._record.selectionAfter=e;this._endTransaction()}.bind(this));o.replacedCharacters.add(function(i,e,f){if(!this._inTransaction)throw new Error("UndoController.textViewReplacedCharacters() called outside a transaction");
this._record.patches.push({oldCharacters:this._deletedCharacters,oldRange:e,newCharacters:f,newRange:this.editor.layoutManager.textStorage.resultingRangeForReplacement(e,f.split("\n"))});this._deletedCharacters=null}.bind(this));o.willReplaceRange.add(function(i,e){if(!this._inTransaction)throw new Error("UndoController.textViewWillReplaceRange() called outside a transaction");this._deletedCharacters=this.editor.layoutManager.textStorage.getCharacters(e)}.bind(this))};u.EditorUndoController.prototype=
{_inTransaction:false,_record:null,textView:null,_beginTransaction:function(){if(this._inTransaction){v.trace();throw new Error("UndoController._beginTransaction() called with a transaction already in place");}this._inTransaction=true;this._record={patches:[]}},_endTransaction:function(){if(!this._inTransaction)throw new Error("UndoController._endTransaction() called without a transaction in place");this.editor.buffer.undoManager.registerUndo(this,this._record);this._record=null;this._inTransaction=
false},_tryApplyingPatches:function(o){var i=this.editor.layoutManager.textStorage;o.forEach(function(e){i.replaceCharacters(e.oldRange,e.newCharacters)});return true},_undoOrRedo:function(o,i){if(this._inTransaction)throw new Error("UndoController._undoOrRedo() called while in a transaction");if(!this._tryApplyingPatches(o))return false;this.textView.setSelection(i,true);return true},redo:function(o){var i=o.patches.concat();i.reverse();return this._undoOrRedo(i,o.selectionAfter)},undo:function(o){return this._undoOrRedo(o.patches.map(function(i){return{oldCharacters:i.newCharacters,
oldRange:i.newRange,newCharacters:i.oldCharacters,newRange:i.oldRange}}),o.selectionBefore)}};u.undoManagerCommand=function(o,i){r.editor.buffer.undoManager[i.commandExt.name]()}});
bespin.tiki.module("text_editor:models/buffer",function(A,u){var v=A("environment").env,r=A("bespin:util/util"),o=A("bespin:promise").Promise,i=A("models/textstorage").TextStorage,e=A("controllers/layoutmanager").LayoutManager,f=A("undomanager").UndoManager;u.Buffer=function(q,h){this._file=q;this._model=new i(h);this._layoutManager=new e({textStorage:this._model});this.undoManager=new f;if(q)this.reload().then(function(){this._updateSyntaxManagerInitialContext()}.bind(this));else{this.loadPromise=
new o;this.loadPromise.resolve()}h=v.session?v.session.history:null;var k,j,p;if(h&&q&&(k=h.getHistoryForPath(q.path))){j=k.selection;p=k.scroll}this._selectedRange=j||{start:{row:0,col:0},end:{row:0,col:0}};this._scrollOffset=p||{x:0,y:0}};u.Buffer.prototype={undoManager:null,loadPromise:null,_scrollOffset:null,_selectedRange:null,_selectedRangeEndVirtual:null,_layoutManager:null,_file:null,_model:null,save:function(){return this._file.saveContents(this._model.value)},saveAs:function(q){var h=new o;
q.saveContents(this._model.value).then(function(){this._file=q;this._updateSyntaxManagerInitialContext();h.resolve()}.bind(this),function(k){h.reject(k)});return h},reload:function(){var q=this,h;return this.loadPromise=h=this._file.loadContents().then(function(k){q._model.value=k})},_updateSyntaxManagerInitialContext:function(){var q=this._file.extension();this._layoutManager.syntaxManager.setSyntaxFromFileExt(q===null?"":q)},untitled:function(){return r.none(this._file)}};Object.defineProperties(u.Buffer.prototype,
{layoutManager:{get:function(){return this._layoutManager}},syntaxManager:{get:function(){}},file:{get:function(){return this._file}},model:{get:function(){return this._model}}})});
bespin.tiki.module("text_editor:models/textstorage",function(A,u){var v=A("events").Event,r=A("bespin:util/util");A=function(o){this._lines=o!==null&&o!==undefined?o.split("\n"):[""];this.changed=new v;return this};A.prototype={_lines:null,readOnly:false,clampPosition:function(o){var i=this._lines,e=o.row;if(e<0)return{row:0,col:0};else if(e>=i.length)return this.range.end;o=Math.max(0,Math.min(o.col,i[e].length));return{row:e,col:o}},clampRange:function(o){var i=this.clampPosition(o.start);o=this.clampPosition(o.end);
return{start:i,end:o}},deleteCharacters:function(o){this.replaceCharacters(o,"")},displacePosition:function(o,i){var e=i>0,f=this._lines,q=f.length;for(i=Math.abs(i);i!==0;i--)if(e){var h=f[o.row].length;if(o.row===q-1&&o.col===h)return o;o=o.col===h?{row:o.row+1,col:0}:{row:o.row,col:o.col+1}}else{if(o.row===0&&o.col==0)return o;if(o.col===0){f=this._lines;o={row:o.row-1,col:f[o.row-1].length}}else o={row:o.row,col:o.col-1}}return o},getCharacters:function(o){var i=this._lines,e=o.start,f=o.end,
q=e.row;o=f.row;var h=e.col;e=f.col;if(q===o)return i[q].substring(h,e);f=i[q].substring(h);q=i.slice(q+1,o);i=i[o].substring(0,e);return[f].concat(q,i).join("\n")},getLines:function(){return this._lines},getRange:function(){var o=this._lines,i=o.length-1;return{start:{row:0,col:0},end:{row:i,col:o[i].length}}},getValue:function(){return this._lines.join("\n")},insertCharacters:function(o,i){this.replaceCharacters({start:o,end:o},i)},replaceCharacters:function(o,i){if(this.readOnly)throw new Error("Attempt to modify a read-only text storage object");
var e=i.split("\n"),f=e.length,q=this.resultingRangeForReplacement(o,e),h=o.start,k=o.end,j=h.row,p=k.row,t=this._lines;e[0]=t[j].substring(0,h.col)+e[0];e[f-1]+=t[p].substring(k.col);this._lines=r.replace(t,j,p-j+1,e);this.changed(o,q,i)},resultingRangeForReplacement:function(o,i){var e=i.length;o=o.start;return{start:o,end:{row:o.row+e-1,col:(e===1?o.col:0)+i[e-1].length}}},setLines:function(o){this.setValue(o.join("\n"))},setValue:function(o){this.replaceCharacters(this.range,o)}};u.TextStorage=
A;Object.defineProperties(u.TextStorage.prototype,{lines:{get:function(){return this.getLines()},set:function(o){return this.setLines(o)}},range:{get:function(){return this.getRange()}},value:{get:function(){return this.getValue()},set:function(o){this.setValue(o)}}})});
bespin.tiki.module("text_editor:utils/rect",function(A,u){u._distanceFromBounds=function(v,r,o){if(v<r)return v-r;if(v>=o)return v-o;return 0};u.merge=function(v){var r;do{r=false;for(var o=[],i=0;i<v.length;i++){var e=v[i];o.push(e);for(var f=i+1;f<v.length;f++){var q=v[f];if(u.rectsSideBySide(e,q)||u.rectsIntersect(e,q)){v.splice(f,1);o[o.length-1]=u.unionRects(e,q);r=true;break}}}v=o}while(r);return v};u.offsetFromRect=function(v,r){return{x:u._distanceFromBounds(r.x,v.x,u.maxX(v)),y:u._distanceFromBounds(r.y,
v.y,u.maxY(v))}};u.rectsIntersect=function(v,r){v=u.intersectRects(v,r);return v.width!==0&&v.height!==0};u.rectsSideBySide=function(v,r){if(v.x==r.x&&v.width==r.width)return v.y<r.y?v.y+v.height==r.y:r.y+r.height==v.y;else if(v.y==r.y&&v.height==r.height)return v.x<r.x?v.x+v.width==r.x:r.x+r.width==v.x;return false};u.intersectRects=function(v,r){v={x:Math.max(u.minX(v),u.minX(r)),y:Math.max(u.minY(v),u.minY(r)),width:Math.min(u.maxX(v),u.maxX(r)),height:Math.min(u.maxY(v),u.maxY(r))};v.width=Math.max(0,
v.width-v.x);v.height=Math.max(0,v.height-v.y);return v};u.minX=function(v){return v.x||0};u.maxX=function(v){return(v.x||0)+(v.width||0)};u.minY=function(v){return v.y||0};u.maxY=function(v){return(v.y||0)+(v.height||0)};u.pointInRect=function(v,r){return v.x>=u.minX(r)&&v.y>=u.minY(r)&&v.x<=u.maxX(r)&&v.y<=u.maxY(r)};u.unionRects=function(v,r){v={x:Math.min(u.minX(v),u.minX(r)),y:Math.min(u.minY(v),u.minY(r)),width:Math.max(u.maxX(v),u.maxX(r)),height:Math.max(u.maxY(v),u.maxY(r))};v.width=Math.max(0,
v.width-v.x);v.height=Math.max(0,v.height-v.y);return v};u.rectsEqual=function(v,r,o){if(!v||!r)return v==r;if(!o&&o!==0)o=0.1;if(v.y!=r.y&&Math.abs(v.y-r.y)>o)return false;if(v.x!=r.x&&Math.abs(v.x-r.x)>o)return false;if(v.width!=r.width&&Math.abs(v.width-r.width)>o)return false;if(v.height!=r.height&&Math.abs(v.height-r.height)>o)return false;return true}});
bespin.tiki.module("text_editor:views/canvas",function(A,u){var v=A("bespin:util/util"),r=A("utils/rect"),o=A("events").Event;u.CanvasView=function(i,e,f){if(i){this._preventDownsize=e||false;this._clearOnFullInvalid=f||false;this._clippingFrame=this._frame={x:0,y:0,width:0,height:0};this._invalidRects=[];e=document.createElement("canvas");e.setAttribute("style","position: absolute");e.innerHTML="canvas tag not supported by your browser";i.appendChild(e);this.domNode=e;this.clippingChanged=new o;
this.clippingChanged.add(this.clippingFrameChanged.bind(this))}};u.CanvasView.prototype={domNode:null,clippingChanged:null,_canvasContext:null,_canvasId:null,_invalidRects:null,_lastRedrawTime:null,_redrawTimer:null,_clippingFrame:null,_preventDownsize:false,_clearOnFullInvalid:false,_frame:null,_getContext:function(){if(this._canvasContext===null)this._canvasContext=this.domNode.getContext("2d");return this._canvasContext},computeWithClippingFrame:function(i,e){var f=this.clippingFrame;return{x:i+
f.x,y:e+f.y}},minimumRedrawDelay:1E3/30,clippingFrameChanged:function(){this.invalidate()},drawRect:function(){},render:function(){if(!(this._renderTimer||this._redrawTimer))this._renderTimer=setTimeout(this._tryRedraw.bind(this),0)},invalidate:function(){this._invalidRects="all";this.render()},invalidateRect:function(i){var e=this._invalidRects;if(e!=="all"){e.push(i);this.render()}},_tryRedraw:function(){this._renderTimer=null;var i=(new Date).getTime(),e=this._lastRedrawTime,f=this.minimumRedrawDelay;
if(e===null||i-e>=f)this._redraw();else if(this._redrawTimer===null)this._redrawTimer=window.setTimeout(this._redraw.bind(this),f)},_redraw:function(){var i=this.clippingFrame;i={x:Math.round(i.x),y:Math.round(i.y),width:i.width,height:i.height};var e=this._getContext();e.save();e.translate(-i.x,-i.y);var f=this._invalidRects;if(f==="all"){this._clearOnFullInvalid&&e.clearRect(0,0,this.domNode.width,this.domNode.height);this.drawRect(i,e)}else r.merge(f).forEach(function(q){q=r.intersectRects(q,i);
if(q.width!==0&&q.height!==0){e.save();var h=q.x,k=q.y,j=q.width,p=q.height;e.beginPath();e.moveTo(h,k);e.lineTo(h+j,k);e.lineTo(h+j,k+p);e.lineTo(h,k+p);e.closePath();e.clip();this.drawRect(q,e);e.restore()}},this);e.restore();this._invalidRects=[];this._redrawTimer=null;this._lastRedrawTime=(new Date).getTime()}};Object.defineProperties(u.CanvasView.prototype,{clippingFrame:{get:function(){return this._clippingFrame},set:function(i){i=v.mixin(v.clone(this._clippingFrame),i);if(this._clippingFrame===
null||!r.rectsEqual(i,this._clippingFrame)){this._clippingFrame=i;this.clippingChanged()}}},frame:{get:function(){return this._frame},set:function(i){var e=this.domNode,f=e.style,q=this._preventDownsize,h=e.width,k=e.height;f=e.style;f.left=i.x+"px";f.top=i.y+"px";var j,p;if(i.width!==h)if(i.width<h)q||(j=true);else j=true;if(i.height!==k)if(i.height<k)q||(p=true);else p=true;if(j)this.domNode.width=i.width;if(p)this.domNode.height=i.height;this._frame=i;this.clippingFrame={width:i.width,height:i.height}}}})});
bespin.tiki.module("text_editor:views/editor",function(A,u){function v(l){var w=C.plugins.text_editor.provides,D=w.length,K={};if(l){l=l.themestyles;if(l.currentThemeVariables&&l.currentThemeVariables.text_editor)K=l.currentThemeVariables.text_editor}for(;D--;)if(w[D].ep==="themevariable"){l=i.mixin(i.clone(w[D].defaultValue),K[w[D].name]);switch(w[D].name){case "gutter":case "editor":case "scroller":case "highlighter":M[w[D].name]=l}}}var r=A("rangeutils:utils/range"),o=A("views/scroller"),i=A("bespin:util/util"),
e=A("models/buffer").Buffer,f=A("completion:controller").CompletionController,q=A("controllers/search").EditorSearchController,h=A("controllers/undo").EditorUndoController,k=A("events").Event,j=A("views/gutter").GutterView;A("controllers/layoutmanager");var p=o.ScrollerCanvasView,t=A("views/text").TextView,B=A("underscore")._,C=A("bespin:plugins").catalog,d=A("keyboard:keyboard").keyboardManager,J=A("settings").settings,M={};v();C.registerExtension("themeChange",{pointer:v});u.EditorView=function(l){this.elementAppended=
new k;var w=this.element=this.container=document.createElement("div");w.style.overflow="visible";w.style.position="relative";this.scrollOffsetChanged=new k;this.willChangeBuffer=new k;this.selectionChanged=new k;this.textChanged=new k;this.gutterView=new j(w,this);this.textView=new t(w,this);var D=new p(this,o.LAYOUT_VERTICAL),K=new p(this,o.LAYOUT_HORIZONTAL);this.verticalScroller=D;this.horizontalScroller=K;this.completionController=new f(this);this.editorUndoController=new h(this);this.searchController=
new q(this);this._textViewSize=this._oldSize={width:0,height:0};this._themeData=M;this.buffer=new e(null,l);this.elementAppended.add(function(){var P=J.get("fontsize"),X=J.get("fontface");this._font=P+"px "+X;C.registerExtension("themeChange",{pointer:this._themeVariableChange.bind(this)});C.registerExtension("settingChange",{match:"font[size|face]",pointer:this._fontSettingChanged.bind(this)});C.registerExtension("dimensionsChanged",{pointer:this.dimensionsChanged.bind(this)});this._dontRecomputeLayout=
false;this._recomputeLayout();w.addEventListener(i.isMozilla?"DOMMouseScroll":"mousewheel",this._onMouseWheel.bind(this),false);D.valueChanged.add(function(U){this.scrollOffset={y:U}}.bind(this));K.valueChanged.add(function(U){this.scrollOffset={x:U}}.bind(this));this.scrollOffsetChanged.add(function(U){this._updateScrollOffsetChanged(U)}.bind(this))}.bind(this))};u.EditorView.prototype={elementAppended:null,textChanged:null,selectionChanged:null,scrollOffsetChanged:null,willChangeBuffer:null,_textViewSize:null,
_textLinesCount:0,_gutterViewWidth:0,_oldSize:null,_buffer:null,_dontRecomputeLayout:true,_themeData:null,_layoutManagerSizeChanged:function(l){var w=this.layoutManager.fontDimension;this._textViewSize={width:l.width*w.characterWidth,height:l.height*w.lineHeight};if(this._textLinesCount!==l.height){this.gutterView.computeWidth()!==this._gutterViewWidth?this._recomputeLayout(true):this.gutterView.invalidate();this._textLinesLength=l.height}this._updateScrollers();this.scrollOffset={}},_updateScrollers:function(){if(!this._dontRecomputeLayout){var l=
this.textViewPaddingFrame,w=this._textViewSize.width,D=this._textViewSize.height,K=this.scrollOffset,P=this.verticalScroller,X=this.horizontalScroller;if(D<l.height)P.isVisible=false;else{P.isVisible=true;P.proportion=l.height/D;P.maximum=D-l.height;P.value=K.y}if(w<l.width)X.isVisible=false;else{X.isVisible=true;X.proportion=l.width/w;X.maximum=w-l.width;X.value=K.x}}},_onMouseWheel:function(l){var w=0;if(l.wheelDelta)w=-l.wheelDelta;else if(l.detail)w=l.detail*40;var D=true;if(l.axis){if(l.axis==
l.HORIZONTAL_AXIS)D=false}else if(l.wheelDeltaY||l.wheelDeltaX){if(l.wheelDeltaX==l.wheelDelta)D=false}else if(l.shiftKey)D=false;D?this.scrollBy(0,w):this.scrollBy(w*5,0);i.stopEvent(l)},scrollTo:function(l){this.scrollOffset=l},scrollBy:function(l,w){this.scrollOffset={x:this.scrollOffset.x+l,y:this.scrollOffset.y+w}},_recomputeLayout:function(l){if(!this._dontRecomputeLayout){var w=this.container.offsetWidth,D=this.container.offsetHeight;if(!(!l&&w==this._oldSize.width&&D==this._oldSize.height)){this._oldSize=
{width:w,height:D};this._gutterViewWidth=l=this.gutterView.computeWidth();this.gutterView.frame={x:0,y:0,width:l,height:D};this.textView.frame={x:l,y:0,width:w-l,height:D};var K=this._themeData.scroller.padding,P=this._themeData.scroller.thickness;this.horizontalScroller.frame={x:l+K,y:D-(P+K),width:w-(l+2*K+P),height:P};this.verticalScroller.frame={x:w-(K+P),y:K,width:P,height:D-(2*K+P)};this.scrollOffset={};this._updateScrollers();this.gutterView.invalidate();this.textView.invalidate();this.verticalScroller.invalidate();
this.horizontalScroller.invalidate()}}},dimensionsChanged:function(){this._recomputeLayout()},_font:null,_fontSettingChanged:function(){var l=J.get("fontsize"),w=J.get("fontface");this._font=l+"px "+w;this.layoutManager._recalculateMaximumWidth();this._layoutManagerSizeChanged(this.layoutManager.size);this.textView.invalidate()},_themeVariableChange:function(){this._recomputeLayout(true)},_updateScrollOffsetChanged:function(l){this.verticalScroller.value=l.y;this.horizontalScroller.value=l.x;this.textView.clippingFrame=
{x:l.x,y:l.y};this.gutterView.clippingFrame={y:l.y};this._updateScrollers();this.gutterView.invalidate();this.textView.invalidate()},processKeyEvent:function(l,w,D){D=B(D).clone();D.completing=this.completionController.isCompleting();return d.processKeyEvent(l,w,D)},convertTextViewPoint:function(l){var w=this.scrollOffset;return{x:l.x-w.x+this._gutterViewWidth,y:l.y-w.y}},replace:function(l,w,D){if(!r.isRange(l))throw new Error('replace(): expected range but found "'+l+"'");if(!i.isString(w))throw new Error('replace(): expected text string but found "'+
text+'"');var K=r.normalizeRange(l),P=this.textView,X=P.getSelectedRange(false);return P.groupChanges(function(){P.replaceCharacters(K,w);if(D)P.setSelection(X);else{var U=w.split("\n");U=U.length>1?{row:l.start.row+U.length-1,col:U[U.length-1].length}:r.addPositions(l.start,{row:0,col:w.length});P.moveCursorTo(U)}})},getText:function(l){if(!r.isRange(l))throw new Error('getText(): expected range but found "'+l+'"');return this.layoutManager.textStorage.getCharacters(r.normalizeRange(l))},setLineNumber:function(l){if(!i.isNumber(l))throw new Error("setLineNumber(): lineNumber must be a number");
this.textView.moveCursorTo({row:l-1,col:0})},setCursor:function(l){if(!r.isPosition(l))throw new Error('setCursor(): expected position but found "'+l+'"');this.textView.moveCursorTo(l)},changeGroup:function(l){return this.textView.groupChanges(function(){l(this)}.bind(this))},addTags:function(l){this.completionController.tags.add(l)}};Object.defineProperties(u.EditorView.prototype,{themeData:{get:function(){return this._themeData},set:function(){throw new Error("themeData can't be changed directly. Use themeManager.");
}},font:{get:function(){return this._font},set:function(){throw new Error("font can't be changed directly. Use settings fontsize and fontface.");}},buffer:{set:function(l){if(l!==this._buffer){if(!l.loadPromise.isResolved())throw new Error("buffer.set(): the new buffer must first be loaded!");if(this._buffer!==null){this.layoutManager.sizeChanged.remove(this);this.layoutManager.textStorage.changed.remove(this);this.textView.selectionChanged.remove(this)}this.willChangeBuffer(l);C.publish(this,"editorChange",
"buffer",l);this.layoutManager=l.layoutManager;this._buffer=l;var w=this.layoutManager,D=this.textView;w.sizeChanged.add(this,this._layoutManagerSizeChanged.bind(this));w.textStorage.changed.add(this,this.textChanged.bind(this));D.selectionChanged.add(this,this.selectionChanged.bind(this));this.textView.setSelection(l._selectedRange,false);this.scrollOffsetChanged(l._scrollOffset);this.layoutManager.sizeChanged(this.layoutManager.size);this._recomputeLayout()}},get:function(){return this._buffer}},
frame:{get:function(){return{width:this.container.offsetWidth,height:this.container.offsetHeight}}},textViewPaddingFrame:{get:function(){var l=i.clone(this.textView.frame),w=this.textView.padding;l.width-=w.left+w.right;l.height-=w.top+w.bottom;return l}},scrollOffset:{set:function(l){if(l.x===undefined)l.x=this.scrollOffset.x;if(l.y===undefined)l.y=this.scrollOffset.y;var w=this.textViewPaddingFrame;if(l.y<0)l.y=0;else if(this._textViewSize.height<w.height)l.y=0;else if(l.y+w.height>this._textViewSize.height)l.y=
this._textViewSize.height-w.height;if(l.x<0)l.x=0;else if(this._textViewSize.width<w.width)l.x=0;else if(l.x+w.width>this._textViewSize.width)l.x=this._textViewSize.width-w.width;if(!(l.x===this.scrollOffset.x&&l.y===this.scrollOffset.y)){this.buffer._scrollOffset=l;this.scrollOffsetChanged(l);C.publish(this,"editorChange","scrollOffset",l)}},get:function(){return this.buffer._scrollOffset}},readOnly:{get:function(){return this._buffer.model.readOnly},set:function(l){this._buffer.model.readOnly=l}},
focus:{get:function(){return this.textView.hasFocus},set:function(l){if(!i.isBoolean(l))throw new Error('set focus: expected boolean but found "'+l+'"');this.textView.hasFocus=l}},selection:{get:function(){return i.clone(this.textView.getSelectedRange(false))},set:function(l){if(!r.isRange(l))throw new Error("set selection: position/selection must be supplied");this.textView.setSelection(l)}},selectedText:{get:function(){return this.getText(this.selection)},set:function(l){if(!i.isString(l))throw new Error('set selectedText: expected string but found "'+
l+'"');return this.replace(this.selection,l)}},value:{get:function(){return this.layoutManager.textStorage.value},set:function(l){if(!i.isString(l))throw new Error('set value: expected string but found "'+l+'"');return this.replace(this.layoutManager.textStorage.range,l,false)}},syntax:{get:function(){return this.layoutManager.syntaxManager.getSyntax()},set:function(l){if(!i.isString(l))throw new Error('set syntax: expected string but found "'+newValue+'"');return this.layoutManager.syntaxManager.setSyntax(l)}}})});
bespin.tiki.module("text_editor:views/gutter",function(A,u){var v=A("bespin:util/util"),r=A("views/canvas").CanvasView;u.GutterView=function(o,i){r.call(this,o,true);this.editor=i};u.GutterView.prototype=new r;v.mixin(u.GutterView.prototype,{drawRect:function(o,i){var e=this.editor.themeData.gutter;i.fillStyle=e.backgroundColor;i.fillRect(o.x,o.y,o.width,o.height);i.save();i.translate(e.paddingLeft,0);var f=this.editor.layoutManager,q=f.characterRangeForBoundingRect(o);o=Math.min(q.end.row,f.textLines.length-
1);var h=f.fontDimension.lineAscent;i.fillStyle=e.color;i.font=this.editor.font;for(e=q.start.row;e<=o;e++)i.fillText(""+(e+1),-0.5,f.lineRectForRow(e).y+h-0.5);i.restore()},computeWidth:function(){var o=this.editor.themeData.gutter,i=this.editor.layoutManager;return i.fontDimension.characterWidth*(""+i.textLines.length).length+(o.paddingLeft+o.paddingRight)}})});
bespin.tiki.module("text_editor:views/scroller",function(A,u){var v=A("bespin:util/util"),r=A("events").Event,o=A("bespin:console").console,i=A("utils/rect"),e=A("views/canvas").CanvasView,f=u.LAYOUT_HORIZONTAL=0,q=u.LAYOUT_VERTICAL=1;u.ScrollerCanvasView=function(h,k){e.call(this,h.container,false,true);this.editor=h;this.layoutDirection=k;h=function(j,p,t){t=t||this.domNode;t.addEventListener(j,function(B){p.call(this,B);v.stopEvent(B)}.bind(this),false)}.bind(this);h("mouseover",this.mouseEntered);
h("mouseout",this.mouseExited);h("mousedown",this.mouseDown);h("mouseup",this.mouseUp,window);h("mousemove",this.mouseMove,window);this.valueChanged=new r};u.ScrollerCanvasView.prototype=new e;v.mixin(u.ScrollerCanvasView.prototype,{lineHeight:20,proportion:0,layoutDirection:q,_isVisible:false,_maximum:0,_value:0,valueChanged:null,padding:{left:0,bottom:0,top:0,right:0},_mouseDownScreenPoint:null,_mouseDownValue:null,_isMouseOver:false,_scrollTimer:null,_mouseEventPosition:null,_mouseOverHandle:false,
_drawNib:function(h){var k=this.editor.themeData.scroller,j,p;j=k.nibStyle;p=k.nibArrowStyle;k=k.nibStrokeStyle;var t=Math.floor(7.5);h.fillStyle=j;h.beginPath();h.arc(0,0,Math.floor(7.5),0,Math.PI*2,true);h.closePath();h.fill();h.strokeStyle=k;h.stroke();h.fillStyle=p;h.beginPath();h.moveTo(0,-t+3);h.lineTo(-t+3,t-5);h.lineTo(t-3,t-5);h.closePath();h.fill()},_drawNibs:function(h,k){var j=this._getClientThickness(),p=this._value,t=this._maximum,B=this._isHighlighted();if(B||p!==0){h.save();h.translate(8,
j/2);h.rotate(Math.PI*1.5);h.moveTo(0,0);this._drawNib(h,k);h.restore()}if(B||p!==t){h.save();h.translate(this._getClientLength()-8,j/2);h.rotate(Math.PI*0.5);h.moveTo(0,0);this._drawNib(h,k);h.restore()}},_getClientFrame:function(){var h=this.frame,k=this.padding;return{x:k.left,y:k.top,width:h.width-(k.left+k.right),height:h.height-(k.top+k.bottom)}},_getClientLength:function(){var h=this._getClientFrame();switch(this.layoutDirection){case f:return h.width;case q:return h.height;default:o.error("unknown layout direction");
return null}},_getClientThickness:function(){var h=this.padding,k=this.editor.themeData.scroller.thickness;switch(this.layoutDirection){case q:return k-(h.left+h.right);case f:return k-(h.top+h.bottom);default:o.error("unknown layout direction");return null}},_getFrameLength:function(){switch(this.layoutDirection){case f:return this.frame.width;case q:return this.frame.height;default:o.error("unknown layout direction");return null}},_getGutterFrame:function(){var h=this._getClientFrame(),k=this._getClientThickness();
switch(this.layoutDirection){case q:return{x:h.x,y:h.y+15,width:k,height:Math.max(0,h.height-30)};case f:return{x:h.x+15,y:h.y,width:Math.max(0,h.width-30),height:k};default:o.error("unknown layout direction");return null}},_getGutterLength:function(){var h=this._getGutterFrame(),k;switch(this.layoutDirection){case f:k=h.width;break;case q:k=h.height;break;default:o.error("unknown layout direction");break}return k},_getHandleFrame:function(){var h=this._getGutterFrame(),k=this._getHandleOffset(),
j=this._getHandleLength();switch(this.layoutDirection){case q:return{x:h.x,y:h.y+k,width:h.width,height:j};case f:return{x:h.x+k,y:h.y,width:j,height:h.height}}},_getHandleLength:function(){var h=this._getGutterLength();return Math.max(h*this.proportion,20)},_getHandleOffset:function(){var h=this._maximum;if(h===0)return 0;var k=this._getGutterLength(),j=this._getHandleLength();return(k-j)*this._value/h},_isHighlighted:function(){return this._isMouseOver===true||this._mouseDownScreenPoint!==null},
_segmentForMouseEvent:function(h){h={x:h.layerX,y:h.layerY};var k=this._getClientFrame(),j=this.padding;if(!i.pointInRect(h,k))return null;var p=this.layoutDirection;switch(p){case f:if(h.x-j.left<15)return"nib-start";else if(h.x>=k.width-15)return"nib-end";break;case q:if(h.y-j.top<15)return"nib-start";else if(h.y>=k.height-15)return"nib-end";break;default:o.error("unknown layout direction");break}j=this._getHandleFrame();if(i.pointInRect(h,j))return"handle";switch(p){case f:if(h.x<j.x)return"gutter-before";
else if(h.x>=j.x+j.width)return"gutter-after";break;case q:if(h.y<j.y)return"gutter-before";else if(h.y>=j.y+j.height)return"gutter-after";break;default:o.error("unknown layout direction");break}o.error("_segmentForMouseEvent: point ",h," outside view with handle frame ",j," and client frame ",k);return null},adjustFrame:function(){var h=this.frame;this.set("layout",{left:0,top:0,width:h.width,height:h.height})},drawRect:function(h,k){if(this._isVisible){var j=this._isHighlighted();h=this.editor.themeData.scroller;
var p=j?h.fullAlpha:h.particalAlpha,t=this.frame;k.clearRect(0,0,t.width,t.height);k.save();t=this.padding;k.translate(t.left,t.top);this._getHandleFrame();t=this._getGutterLength();var B=this._getClientThickness(),C=B/2,d=this.layoutDirection,J=this._getHandleOffset()+15,M=this._getHandleLength();if(d===q){k.translate(B+1,0);k.rotate(Math.PI*0.5)}if(!(t<=M)){k.globalAlpha=p;if(j){j=this._getClientLength();k.fillStyle=h.trackFillStyle;k.fillRect(8.5,0.5,j-16,B-1);k.strokeStyle=h.trackStrokeStyle;
k.strokeRect(8.5,0.5,j-16,B-1)}j=function(){k.beginPath();k.arc(J+C+0.5,C,C-0.5,Math.PI/2,3*Math.PI/2,false);k.arc(J+M-C-0.5,C,C-0.5,3*Math.PI/2,Math.PI/2,false);k.lineTo(J+C+0.5,B-0.5);k.closePath()};j();t=k.createLinearGradient(J,0,J,B);t.addColorStop(0,h.barFillGradientTopStart);t.addColorStop(0.4,h.barFillGradientTopStop);t.addColorStop(0.41,h.barFillStyle);t.addColorStop(0.8,h.barFillGradientBottomStart);t.addColorStop(1,h.barFillGradientBottomStop);k.fillStyle=t;k.fill();k.save();k.clip();k.fillStyle=
h.barFillStyle;k.beginPath();k.moveTo(J+C*0.4,C*0.6);k.lineTo(J+C*0.9,B*0.4);k.lineTo(J,B*0.4);k.closePath();k.fill();k.beginPath();k.moveTo(J+M-C*0.4,0+C*0.6);k.lineTo(J+M-C*0.9,0+B*0.4);k.lineTo(J+M,0+B*0.4);k.closePath();k.fill();k.restore();k.save();j();k.strokeStyle=h.trackStrokeStyle;k.stroke();k.restore();this._drawNibs(k,p);k.restore()}}},_repeatAction:function(h,k){if(h()!==false){var j=function(){this._repeatAction(h,100)}.bind(this);this._scrollTimer=setTimeout(j,k)}},_scrollByDelta:function(h){this.value=
this._value+h},_scrollUpOneLine:function(){this._scrollByDelta(-this.lineHeight);return true},_scrollDownOneLine:function(){this._scrollByDelta(this.lineHeight);return true},_scrollPage:function(){switch(this._segmentForMouseEvent(this._mouseEventPosition)){case "gutter-before":this._scrollByDelta(this._getGutterLength()*-1);break;case "gutter-after":this._scrollByDelta(this._getGutterLength());break;case null:break;default:return false}return true},mouseDown:function(h){this._mouseEventPosition=
h;this._mouseOverHandle=false;this._getGutterLength();switch(this._segmentForMouseEvent(h)){case "nib-start":this._repeatAction(this._scrollUpOneLine.bind(this),500);break;case "nib-end":this._repeatAction(this._scrollDownOneLine.bind(this),500);break;case "gutter-before":this._repeatAction(this._scrollPage.bind(this),500);break;case "gutter-after":this._repeatAction(this._scrollPage.bind(this),500);break;case "handle":break;default:o.error("_segmentForMouseEvent returned an unknown value");break}switch(this.layoutDirection){case f:this._mouseDownScreenPoint=
h.pageX;break;case q:this._mouseDownScreenPoint=h.pageY;break;default:o.error("unknown layout direction");break}},mouseMove:function(h){if(this._mouseDownScreenPoint!==null){if(this._segmentForMouseEvent(h)=="handle"||this._mouseOverHandle===true){this._mouseOverHandle=true;if(this._scrollTimer!==null){clearTimeout(this._scrollTimer);this._scrollTimer=null}var k;switch(this.layoutDirection){case f:k=h.pageX;break;case q:k=h.pageY;break;default:o.error("unknown layout direction");break}var j=k-this._mouseDownScreenPoint,
p=this._maximum,t=this._value,B=this._getGutterLength(),C=this._getHandleLength();this.value=t+p*j/(B-C);this._mouseDownScreenPoint=k}this._mouseEventPosition=h}},mouseEntered:function(){this._isMouseOver=true;this.invalidate()},mouseExited:function(){this._isMouseOver=false;this.invalidate()},mouseUp:function(){this._mouseDownValue=this._mouseDownScreenPoint=null;if(this._scrollTimer){clearTimeout(this._scrollTimer);this._scrollTimer=null}this.invalidate()}});Object.defineProperties(u.ScrollerCanvasView.prototype,
{isVisible:{set:function(h){if(this._isVisible!==h){this._isVisible=h;this.domNode.style.display=h?"block":"none";h&&this.invalidate()}}},maximum:{set:function(h){if(this._value>this._maximum)this._value=this._maximum;if(h!==this._maximum){this._maximum=h;this.invalidate()}}},value:{set:function(h){if(h<0)h=0;else if(h>this._maximum)h=this._maximum;if(h!==this._value){this._value=h;this.valueChanged(h);this.invalidate()}}}})});
bespin.tiki.module("text_editor:views/text",function(A,u){var v=A("bespin:plugins").catalog,r=A("bespin:util/util"),o=A("events").Event,i=A("views/canvas").CanvasView;A("controllers/layoutmanager");var e=A("rangeutils:utils/range"),f=A("utils/rect"),q=A("views/textinput").TextInput,h=A("bespin:console").console,k=A("settings").settings;u.TextView=function(j,p){i.call(this,j,true);this.editor=p;this.textInput=new q(j,this);this.padding={top:0,bottom:30,left:0,right:30};this.clippingChanged.add(this.clippingFrameChanged.bind(this));
j=this.domNode;j.style.cursor="text";j.addEventListener("mousedown",this.mouseDown.bind(this),false);j.addEventListener("mousemove",this.mouseMove.bind(this),false);window.addEventListener("mouseup",this.mouseUp.bind(this),false);p.willChangeBuffer.add(this.editorWillChangeBuffer.bind(this));this.selectionChanged=new o;this.beganChangeGroup=new o;this.endedChangeGroup=new o;this.willReplaceRange=new o;this.replacedCharacters=new o};u.TextView.prototype=new i;r.mixin(u.TextView.prototype,{_dragPoint:null,
_dragTimer:null,_enclosingScrollView:null,_inChangeGroup:false,_insertionPointBlinkTimer:null,_insertionPointVisible:true,_keyBuffer:"",_keyMetaBuffer:"",_keyState:"start",_hasFocus:false,_mouseIsDown:false,selectionChanged:null,beganChangeGroup:null,endedChangeGroup:null,willReplaceRange:null,replacedCharacters:null,editorWillChangeBuffer:function(j){if(this.editor.layoutManager){var p=this.editor.layoutManager;p.invalidatedRects.remove(this);p.changedTextAtRow.remove(this)}p=j.layoutManager;p.invalidatedRects.add(this,
this.layoutManagerInvalidatedRects.bind(this));p.changedTextAtRow.add(this,this.layoutManagerChangedTextAtRow.bind(this))},didFocus:function(){this._setFocus(true,true)},didBlur:function(){this._setFocus(false,true)},_drag:function(){var j=this._dragPoint,p=f.offsetFromRect(this.clippingFrame,j);this.moveCursorTo(this._selectionPositionForPoint({x:j.x-p.x,y:j.y-p.y}),true)},_drawInsertionPoint:function(j,p){if(this._insertionPointVisible){var t=this.editor.layoutManager.characterRectForPosition(this.editor.buffer._selectedRange.start);
j=Math.floor(t.x);var B=t.y,C=Math.ceil(t.width);t=t.height;p.save();var d=this.editor.themeData.editor;if(this._hasFocus){p.strokeStyle=d.cursorColor;p.beginPath();p.moveTo(j+0.5,B);p.lineTo(j+0.5,B+t);p.closePath();p.stroke()}else{p.fillStyle=d.unfocusedCursorBackgroundColor;p.fillRect(j+0.5,B,C-0.5,t);p.strokeStyle=d.unfocusedCursorColor;p.strokeRect(j+0.5,B+0.5,C-1,t-1)}p.restore()}},_drawLines:function(j,p){var t=this.editor.layoutManager,B=t.textLines,C=t.fontDimension.lineAscent,d=this.editor.themeData.highlighter;
p.save();p.font=this.editor.font;var J=t.characterRangeForBoundingRect(j),M=J.start;J=J.end;for(var l=J.row,w=M.row;w<=l;w++){var D=B[w];if(!r.none(D)){var K=D.characters,P=K.length,X=Math.min(J.col,P),U=M.col;if(!(U>=P)){D=D.colors;if(D==null)D=[];for(P=0;P<D.length&&U<D[P].start;)P++;for(var $=P<D.length?D[P].start:U;$<X;){j=D[P];U=j!=null?j.end:X;j=j!=null?j.tag:"plain";j=d.hasOwnProperty(j)?d[j]:"red";p.fillStyle=j;j=t.characterRectForPosition({row:w,col:$});$=K.substring($,U);p.fillText($,j.x,
j.y+C);$=U;P++}}}}p.restore()},_drawSelectionHighlight:function(j,p){j=this.editor.themeData.editor;j=this._hasFocus?j.selectedTextBackgroundColor:j.unfocusedCursorBackgroundColor;var t=this.editor.layoutManager;p.save();var B=e.normalizeRange(this.editor.buffer._selectedRange);p.fillStyle=j;t.rectsForRange(B).forEach(function(C){p.fillRect(C.x,C.y,C.width,C.height)});p.restore()},_drawSelection:function(j,p){this._rangeIsInsertionPoint(this.editor.buffer._selectedRange)?this._drawInsertionPoint(j,
p):this._drawSelectionHighlight(j,p)},_getVirtualSelection:function(j){var p=this.editor.buffer._selectedRange,t=this.editor.buffer._selectedRangeEndVirtual;return{start:j&&t?t:p.start,end:t||p.end}},_invalidateSelection:function(){var j=function(B){return{x:B.x-1,y:B.y,width:B.width+2,height:B.height}},p=this.editor.layoutManager,t=e.normalizeRange(this.editor.buffer._selectedRange);if(this._rangeIsInsertionPoint(t)){p=p.characterRectForPosition(t.start);this.invalidateRect(j(p))}else p.rectsForRange(t).forEach(function(B){this.invalidateRect(j(B))},
this)},_isReadOnly:function(){return this.editor.layoutManager.textStorage.readOnly},_keymappingChanged:function(){this._keyBuffer="";this._keyState="start"},_performVerticalKeyboardSelection:function(j){var p=this.editor.buffer._selectedRangeEndVirtual;this.moveCursorTo(e.addPositions(p!==null?p:this.editor.buffer._selectedRange.end,{row:j,col:0}),true,true)},_rangeIsInsertionPoint:function(j){return e.isZeroLength(j)},_rearmInsertionPointBlinkTimer:function(){this._insertionPointVisible||this.blinkInsertionPoint();
this._insertionPointBlinkTimer!==null&&clearInterval(this._insertionPointBlinkTimer);this._insertionPointBlinkTimer=setInterval(this.blinkInsertionPoint.bind(this),750)},_repositionSelection:function(){var j=this.editor.layoutManager.textLines,p=j.length,t=this.editor.buffer._selectedRange,B=Math.min(t.start.row,p-1);p=Math.min(t.end.row,p-1);var C=j[p];this.setSelection({start:{row:B,col:Math.min(t.start.col,j[B].characters.length)},end:{row:p,col:Math.min(t.end.col,C.characters.length)}})},_scrollPage:function(j){this.editor.scrollBy(0,
(this.clippingFrame.height+this.editor.layoutManager.fontDimension.lineAscent)*(j?-1:1))},_scrollWhileDragging:function(){var j=this._dragPoint;j=this.computeWithClippingFrame(j.layerX,j.layerY);r.mixin(this._dragPoint,j);this._drag()},_selectionPositionForPoint:function(j){j=this.editor.layoutManager.characterAtPoint(j);return j.partialFraction<0.5?j:e.addPositions(j,{row:0,col:1})},_syntaxManagerUpdatedSyntaxForRows:function(j,p){if(j!==p){var t=this.editor.layoutManager;t.updateTextRows(j,p);t.rectsForRange({start:{row:j,
col:0},end:{row:p,col:0}}).forEach(this.invalidateRect,this)}},blinkInsertionPoint:function(){this._insertionPointVisible=!this._insertionPointVisible;this._invalidateSelection()},copy:function(){return this.getSelectedCharacters()},cut:function(){var j=this.getSelectedCharacters();j!=""&&this.performBackspaceOrDelete(false);return j},drawRect:function(j,p){p.fillStyle=this.editor.themeData.editor.backgroundColor;p.fillRect(j.x,j.y,j.width,j.height);this._drawSelection(j,p);this._drawLines(j,p)},
focus:function(){this.textInput.focus()},getInsertionPointPosition:function(){var j=this.editor;j=j.layoutManager.characterRectForPosition(j.buffer._selectedRange.start);return{x:j.x,y:j.y}},getSelectedCharacters:function(){return this._rangeIsInsertionPoint(this.editor.buffer._selectedRange)?"":this.editor.layoutManager.textStorage.getCharacters(e.normalizeRange(this.editor.buffer._selectedRange))},getSelectedRange:function(j){return j?this.editor.buffer._selectedRange:e.normalizeRange(this.editor.buffer._selectedRange)},
groupChanges:function(j){if(this._isReadOnly())return false;if(this._inChangeGroup){j();return true}this._inChangeGroup=true;this.beganChangeGroup(this,this.editor.buffer._selectedRange);try{j()}catch(p){h.error("Error in groupChanges(): "+p);this._inChangeGroup=false;this.endedChangeGroup(this,this.editor.buffer._selectedRange);return false}finally{this._inChangeGroup=false;this.endedChangeGroup(this,this.editor.buffer._selectedRange);return true}},insertText:function(j){if(this._isReadOnly())return false;
this.groupChanges(function(){var p=e.normalizeRange(this.editor.buffer._selectedRange);this.replaceCharacters(p,j);var t=j.split("\n");this.moveCursorTo(t.length>1?{row:p.start.row+t.length-1,col:t[t.length-1].length}:e.addPositions(p.start,{row:0,col:j.length}))}.bind(this));return true},isDelimiter:function(j){return"\"',;.!~@#$%^&*?[]<>():/\\-+ \t".indexOf(j)!==-1},keyDown:function(j){if(j.charCode===0||j._charCode===0)return this.editor.processKeyEvent(j,this,{isTextView:true});else if(j.keyCode===
9)j.preventDefault();else return false},layoutManagerChangedTextAtRow:function(){this._repositionSelection()},layoutManagerInvalidatedRects:function(j,p){p.forEach(this.invalidateRect,this)},mouseDown:function(j){r.stopEvent(j);this._mouseIsDown=this.hasFocus=true;var p=this.computeWithClippingFrame(j.layerX,j.layerY);r.mixin(p,{layerX:j.layerX,layerY:j.layerY});switch(j.detail){case 1:var t=this._selectionPositionForPoint(p);this.moveCursorTo(t,j.shiftKey);break;case 2:t=this._selectionPositionForPoint(p);
var B=this.editor.layoutManager.textStorage.lines[t.row];if(B.length===0)return true;t.col-=t.col==B.length?1:0;var C=!this.isDelimiter(B[t.col]),d=this,J=function(M,l){for(;M>-1&&M<B.length;M+=l)if(d.isDelimiter(B[M])===C)break;return M+(l==1?0:1)};j=J(t.col,-1);J=J(t.col,1);this.moveCursorTo({row:t.row,col:j});this.moveCursorTo({row:t.row,col:J},true);break;case 3:j=this.editor.layoutManager.textStorage.lines;t=this._selectionPositionForPoint(p);this.setSelection({start:{row:t.row,col:0},end:{row:t.row,
col:j[t.row].length}});break}this._dragPoint=p;this._dragTimer=setInterval(this._scrollWhileDragging.bind(this),100)},mouseMove:function(j){if(this._mouseIsDown){this._dragPoint=this.computeWithClippingFrame(j.layerX,j.layerY);r.mixin(this._dragPoint,{layerX:j.layerX,layerY:j.layerY});this._drag()}},mouseUp:function(){this._mouseIsDown=false;if(this._dragTimer!==null){clearInterval(this._dragTimer);this._dragTimer=null}},moveCursorTo:function(j,p,t){var B=this.editor.layoutManager.textStorage,C=B.clampPosition(j);
this.setSelection({start:p?this.editor.buffer._selectedRange.start:C,end:C});if(t){p=B.lines.length;t=j.row;B=j.col;this.editor.buffer._selectedRangeEndVirtual=t>0&&t<p?j:{row:t<1?0:p-1,col:B}}else this.editor.buffer._selectedRangeEndVirtual=null;this.scrollToPosition(this.editor.buffer._selectedRange.end)},moveDown:function(){var j=this._getVirtualSelection();j=e.normalizeRange(j);j=this._rangeIsInsertionPoint(this.editor.buffer._selectedRange)?j.end:{row:j.end.row,col:j.start.col};j=e.addPositions(j,
{row:1,col:0});this.moveCursorTo(j,false,true)},moveLeft:function(){var j=e.normalizeRange(this.editor.buffer._selectedRange);this._rangeIsInsertionPoint(j)?this.moveCursorTo(this.editor.layoutManager.textStorage.displacePosition(j.start,-1)):this.moveCursorTo(j.start)},moveRight:function(){var j=e.normalizeRange(this.editor.buffer._selectedRange);this._rangeIsInsertionPoint(j)?this.moveCursorTo(this.editor.layoutManager.textStorage.displacePosition(j.end,1)):this.moveCursorTo(j.end)},moveUp:function(){var j=
e.normalizeRange(this._getVirtualSelection(true));position=e.addPositions({row:j.start.row,col:this._getVirtualSelection().end.col},{row:-1,col:0});this.moveCursorTo(position,false,true)},parentViewFrameChanged:function(){arguments.callee.base.apply(this,arguments);this._resize()},replaceCharacters:function(j,p){if(this._isReadOnly())return false;this.groupChanges(function(){j=e.normalizeRange(j);this.willReplaceRange(this,j);this.editor.layoutManager.textStorage.replaceCharacters(j,p);this.replacedCharacters(this,
j,p)}.bind(this));return true},performBackspaceOrDelete:function(j){if(this._isReadOnly())return false;var p=this.editor.layoutManager.textStorage,t=p.lines,B="";B=0;var C=k.get("tabstop"),d=this.getSelectedRange();if(e.isZeroLength(d))if(j){j=d.start;B=t[j.row];B=B.substring(0,j.col).match(/\s*$/)[0].length<C||(j.col-C)%C!=0?1:C;d={start:p.displacePosition(j,B*-1),end:d.end}}else{j=d.end;B=t[j.row];B=B.substring(j.col).match(/^\s*/)[0].length<C?1:C;d={start:d.start,end:p.displacePosition(d.end,B)}}this.groupChanges(function(){this.replaceCharacters(d,
"");this.moveCursorTo(d.start)}.bind(this));return true},resetKeyBuffers:function(){this._keyMetaBuffer=this._keyBuffer=""},scrollPageDown:function(){this._scrollPage(false)},scrollPageUp:function(){this._scrollPage(true)},scrollToPosition:function(j){var p=this.editor.layoutManager.characterRectForPosition(j);j=p.x;var t=p.y,B=p.width;p=p.height;var C=this.clippingFrame,d=C.x,J=C.y,M=this.padding,l=C.width-M.right;C=C.height-M.bottom;this.editor.scrollTo({x:j>=d+30&&j+B<d+l?d:j-l/2+B/2,y:t>=J&&t+
p<J+C?J:t-C/2+p/2})},selectAll:function(){var j=this.editor.layoutManager.textStorage.lines,p=j.length-1;this.setSelection({start:{row:0,col:0},end:{row:p,col:j[p].length}})},selectDown:function(){this._performVerticalKeyboardSelection(1)},selectLeft:function(){this.moveCursorTo(this.editor.layoutManager.textStorage.displacePosition(this.editor.buffer._selectedRange.end,-1),true)},selectRight:function(){this.moveCursorTo(this.editor.layoutManager.textStorage.displacePosition(this.editor.buffer._selectedRange.end,
1),true)},selectUp:function(){this._performVerticalKeyboardSelection(-1)},setSelection:function(j,p){var t=this.editor.layoutManager.textStorage;j=t.clampRange(j);if(!e.equal(j,this.editor.buffer._selectedRange)){this._invalidateSelection();this.editor.buffer._selectedRange=j=t.clampRange(j);this._invalidateSelection();this._hasFocus&&this._rearmInsertionPointBlinkTimer();p&&this.scrollToPosition(j.end);this.selectionChanged(j);v.publish(this.editor,"editorChange","selection",j)}},textInserted:function(j){if(j!==
"\n")if(!this.editor.processKeyEvent(j,this,{isTextView:true,isCommandKey:false})){this.insertText(j);this.resetKeyBuffers()}},_setFocus:function(j,p){if(j!=this._hasFocus)if(this._hasFocus=j){this._rearmInsertionPointBlinkTimer();this._invalidateSelection();p||this.textInput.focus()}else{if(this._insertionPointBlinkTimer){clearInterval(this._insertionPointBlinkTimer);this._insertionPointBlinkTimer=null}this._insertionPointVisible=true;this._invalidateSelection();p||this.textInput.blur()}}});Object.defineProperties(u.TextView.prototype,
{hasFocus:{get:function(){return this._hasFocus},set:function(j){this._setFocus(j,false)}}})});
bespin.tiki.module("text_editor:views/textinput",function(A,u){var v=A("bespin:util/util");A("events");var r=A("keyboard:keyutil");u.TextInput=function(o,i){var e=this.domNode=document.createElement("textarea");e.setAttribute("style","position: absolute; z-index: -99999; width: 0px; height: 0px; margin: 0px; outline: none; border: 0;");o.appendChild(e);this.delegate=i;this._attachEvents()};u.TextInput.prototype={_composing:false,domNode:null,delegate:null,_textFieldChanged:function(){if(!(this._composing||
this._ignore)){var o=this.domNode,i=o.value;if(i!=""){o.value="";this._textInserted(i)}}},_copy:function(){var o=false,i=this.delegate;if(i&&i.copy)o=i.copy();return o},_cut:function(){var o=false,i=this.delegate;if(i&&i.cut)o=i.cut();return o},_textInserted:function(o){var i=this.delegate;i&&i.textInserted&&i.textInserted(o)},_setValueAndSelect:function(o){var i=this.domNode;i.value=o;i.select()},focus:function(){this.domNode.focus()},blur:function(){this.domNode.blur()},_attachEvents:function(){var o=
this.domNode,i=this;o.addEventListener("focus",function(){i.delegate&&i.delegate.didFocus&&i.delegate.didFocus()},false);o.addEventListener("blur",function(){i.delegate&&i.delegate.didBlur&&i.delegate.didBlur()},false);r.addKeyDownListener(o,function(k){return i.delegate&&i.delegate.keyDown?i.delegate.keyDown(k):false});if(v.isWebKit){v.isChrome||o.addEventListener("compositionend",function(k){i._textInserted(k.data)},false);o.addEventListener("textInput",function(k){i._textInserted(k.data)},false);
o.addEventListener("paste",function(k){i._textInserted(k.clipboardData.getData("text/plain"));k.preventDefault()},false)}else{var e=i._textFieldChanged.bind(i);o.addEventListener("keydown",function(){window.setTimeout(e,0)},false);o.addEventListener("keypress",e,false);o.addEventListener("keyup",e,false);o.addEventListener("compositionstart",function(){i._composing=true},false);o.addEventListener("compositionend",function(){i._composing=false;i._textFieldChanged()},false);o.addEventListener("paste",
function(){i._setValueAndSelect("");window.setTimeout(function(){i._textFieldChanged()},0)},false)}var f=function(k){k=k.type.indexOf("copy")!=-1?i._copy():i._cut();i._setValueAndSelect(k)};if(v.isWebKit&&!v.isChrome&&v.isMac){var q=(new Date).getTime(),h=function(k){var j=k.type.indexOf("cut")!=-1;if(!(j&&(new Date).getTime()-q<10)){f(k);if(j)q=(new Date).getTime()}};o.addEventListener("beforecopy",h,false);o.addEventListener("beforecut",h,false)}else{h=false;if(v.isMozilla)h=function(k){f(k);i._ignore=
true;window.setTimeout(function(){i._setValueAndSelect("");i._ignore=false},0)};o.addEventListener("copy",h||f,false);o.addEventListener("cut",h||f,false)}}}});bespin.tiki.module("text_editor:index",function(){});bespin.tiki.register("::less",{name:"less",dependencies:{}});
bespin.tiki.module("less:index",function(A,u){function v(e){if(e instanceof i.Dimension)return parseFloat(e.unit=="%"?e.value/100:e.value);else if(typeof e==="number")return e;else throw{error:"RuntimeError",message:"color functions take numbers as parameters"};}function r(e){return Math.min(1,Math.max(0,e))}if(!Array.isArray)Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"||e instanceof Array};if(!Array.prototype.forEach)Array.prototype.forEach=function(e,f){for(var q=
this.length>>>0,h=0;h<q;h++)h in this&&e.call(f,this[h],h,this)};if(!Array.prototype.map)Array.prototype.map=function(e,f){for(var q=this.length>>>0,h=new Array(q),k=0;k<q;k++)if(k in this)h[k]=e.call(f,this[k],k,this);return h};if(!Array.prototype.filter)Array.prototype.filter=function(e,f){for(var q=[],h=0;h<this.length;h++)e.call(f,this[h])&&q.push(this[h]);return q};if(!Array.prototype.reduce)Array.prototype.reduce=function(e){var f=this.length>>>0,q=0;if(f===0&&arguments.length===1)throw new TypeError;
if(arguments.length>=2)var h=arguments[1];else{do{if(q in this){h=this[q++];break}if(++q>=f)throw new TypeError;}while(1)}for(;q<f;q++)if(q in this)h=e.call(null,h,this[q],q,this);return h};if(!Array.prototype.indexOf)Array.prototype.indexOf=function(e,f){var q=this.length;f=f||0;if(!q)return-1;if(f>=q)return-1;if(f<0)f+=q;for(;f<q;f++)if(Object.prototype.hasOwnProperty.call(this,f))if(e===this[f])return f;return-1};if(!Object.keys)Object.keys=function(e){var f=[];for(var q in e)Object.prototype.hasOwnProperty.call(e,
q)&&f.push(q);return f};if(!String.prototype.trim)String.prototype.trim=function(){return String(this).replace(/^\s\s*/,"").replace(/\s\s*$/,"")};if(typeof A!=="undefined")var o=u,i={};else o=i={};o.Parser=function(e){function f(l){var w,D,K;if(l instanceof Function)return l.call(C.parsers);else if(typeof l==="string"){w=h.charAt(k)===l?l:null;D=1}else{if(k>=B+t[j].length&&j<t.length-1)B+=t[j++].length;l.lastIndex=K=k-B;if(w=l.exec(t[j])){D=w[0].length;if(l.lastIndex-D!==K)return}}if(w){k+=D;for(D=
B+t[j].length;k<=D;){l=h.charCodeAt(k);if(!(l===32||l===10||l===9))break;k++}return typeof w==="string"?w:w.length===1?w[0]:w}}function q(l){var w;if(typeof l==="string")return h.charAt(k)===l;else{l.lastIndex=k;if((w=l.exec(h))&&l.lastIndex-w[0].length===k)return w}}var h,k,j,p,t,B,C,d=this,J=function(){},M=this.imports={paths:e&&e.paths||[],queue:[],files:{},push:function(l,w){var D=this;this.queue.push(l);o.Parser.importer(l,this.paths,function(K){D.queue.splice(D.queue.indexOf(l),1);D.files[l]=
K;w(K);D.queue.length===0&&J()})}};this.env=e||{};this.optimization="optimization"in this.env?this.env.optimization:1;return C={imports:M,parse:function(l,w){var D,K,P=null;k=j=B=p=0;t=[];h=l.replace(/\r\n/g,"\n");if(d.optimization>0){h=h.replace(/\/\*(?:[^*]|\*+[^\/*])*\*+\//g,function($){return d.optimization>1?"":$.replace(/\n(\s*\n)+/g,"\n")});t=h.split(/^(?=\n)/mg)}else t=[h];D=new i.Ruleset([],f(this.parsers.primary));D.root=true;D.toCSS=function($){var ba,aa;return function(){try{return $.call(this)}catch(ia){aa=
h.split("\n");ba=(h.slice(0,ia.index).match(/\n/g)||"").length+1;for(var ja=ia.index,ka=-1;ja>=0&&h.charAt(ja)!=="\n";ja--)ka++;throw{name:"NameError",message:ia.message,line:ba,column:ka,extract:[aa[ba-2],aa[ba-1],aa[ba]]};}}}(D.toCSS);if(k<h.length-1){k=p;K=h.split("\n");l=(h.slice(0,k).match(/\n/g)||"").length+1;for(var X=k,U=-1;X>=0&&h.charAt(X)!=="\n";X--)U++;P={name:"ParseError",message:"Syntax Error on line "+l,filename:e.filename,line:l,column:U,extract:[K[l-2],K[l-1],K[l]]}}if(this.imports.queue.length>
0)J=function(){w(P,D)};else w(P,D)},parsers:{primary:function(){for(var l,w=[];l=f(this.mixin.definition)||f(this.rule)||f(this.ruleset)||f(this.mixin.call)||f(this.comment)||f(/[\n\s]+/g)||f(this.directive);)w.push(l);return w},comment:function(){var l;if(h.charAt(k)==="/")return(l=f(/\/\*(?:[^*]|\*+[^\/*])*\*+\/\n?/g))?new i.Comment(l):f(/\/\/.*/g)},entities:{quoted:function(){var l;if(!(h.charAt(k)!=='"'&&h.charAt(k)!=="'"))if(l=f(/"((?:[^"\\\r\n]|\\.)*)"|'((?:[^'\\\r\n]|\\.)*)'/g))return new i.Quoted(l[0],
l[1]||l[2])},keyword:function(){var l;if(l=f(/[A-Za-z-]+/g))return new i.Keyword(l)},call:function(){var l,w;if(l=f(/([a-zA-Z0-9_-]+|%)\(/g)){if(l[1].toLowerCase()==="alpha")return f(this.alpha);w=f(this.entities.arguments);if(f(")"))if(l)return new i.Call(l[1],w)}},arguments:function(){for(var l=[],w;w=f(this.expression);){l.push(w);if(!f(","))break}return l},literal:function(){return f(this.entities.dimension)||f(this.entities.color)||f(this.entities.quoted)},url:function(){var l;if(!(h.charAt(k)!==
"u"||!f(/url\(/g))){l=f(this.entities.quoted)||f(/[-a-zA-Z0-9_%@$\/.&=:;#+?]+/g);if(!f(")"))throw new Error("missing closing ) for url()");return new i.URL(l.value?l:new i.Anonymous(l))}},variable:function(){var l,w=k;if(h.charAt(k)==="@"&&(l=f(/@[a-zA-Z0-9_-]+/g)))return new i.Variable(l,w)},color:function(){var l;if(h.charAt(k)==="#"&&(l=f(/#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})/g)))return new i.Color(l[1])},dimension:function(){var l;l=h.charCodeAt(k);if(!(l>57||l<45||l===47))if(l=f(/(-?[0-9]*\.?[0-9]+)(px|%|em|pc|ex|in|deg|s|ms|pt|cm|mm)?/g))return new i.Dimension(l[1],
l[2])}},variable:function(){var l;if(h.charAt(k)==="@"&&(l=f(/(@[a-zA-Z0-9_-]+)\s*:/g)))return l[1]},shorthand:function(){var l,w;if(q(/[@\w.-]+\/[@\w.-]+/g))if((l=f(this.entity))&&f("/")&&(w=f(this.entity)))return new i.Shorthand(l,w)},mixin:{call:function(){for(var l=[],w,D,K,P=k;w=f(/[#.][a-zA-Z0-9_-]+/g);){l.push(new i.Element(D,w));D=f(">")}f("(")&&(K=f(this.entities.arguments))&&f(")");if(l.length>0&&(f(";")||q("}")))return new i.mixin.Call(l,K,P)},definition:function(){var l,w=[],D,K;if(!(h.charAt(k)!==
"."||q(/[^{]*(;|})/g)))if(l=f(/([#.][a-zA-Z0-9_-]+)\s*\(/g)){for(l=l[1];D=f(/@[\w-]+/g)||f(this.entities.literal)||f(this.entities.keyword);){if(D[0]==="@")if(f(":"))if(K=f(this.expression))w.push({name:D,value:K});else throw new Error("Expected value");else w.push({name:D});else w.push({value:D});if(!f(","))break}if(!f(")"))throw new Error("Expected )");if(D=f(this.block))return new i.mixin.Definition(l,w,D)}}},entity:function(){return f(this.entities.literal)||f(this.entities.variable)||f(this.entities.url)||
f(this.entities.call)||f(this.entities.keyword)},end:function(){return f(";")||q("}")},alpha:function(){var l;if(f(/opacity=/gi))if(l=f(/[0-9]+/g)||f(this.entities.variable)){if(!f(")"))throw new Error("missing closing ) for alpha()");return new i.Alpha(l)}},element:function(){var l;c=f(this.combinator);if(l=f(/[.#:]?[a-zA-Z0-9_-]+/g)||f("*")||f(this.attribute)||f(/\([^)@]+\)/g))return new i.Element(c,l)},combinator:function(){var l;return(l=f(/[+>~]/g)||f("&")||f(/::/g))?new i.Combinator(l):new i.Combinator(h.charAt(k-
1)===" "?" ":null)},selector:function(){for(var l,w=[];l=f(this.element);)w.push(l);if(w.length>0)return new i.Selector(w)},tag:function(){return f(/[a-zA-Z][a-zA-Z-]*[0-9]?/g)||f("*")},attribute:function(){var l="",w,D,K;if(f("[")){if(w=f(/[a-z-]+/g)||f(this.entities.quoted))l=(K=f(/[|~*$^]?=/g))&&(D=f(this.entities.quoted)||f(/[\w-]+/g))?[w,K,D.toCSS?D.toCSS():D].join(""):w;if(f("]"))if(l)return"["+l+"]"}},block:function(){var l;if(f("{")&&(l=f(this.primary))&&f("}"))return l},ruleset:function(){var l=
[],w,D,K=k;if(w=q(/([a-z.#: _-]+)[\s\n]*\{/g)){k+=w[0].length-1;l=[new i.Selector([new i.Element(null,w[1])])]}else{for(;w=f(this.selector);){l.push(w);if(!f(","))break}w&&f(this.comment)}if(l.length>0&&(D=f(this.block)))return new i.Ruleset(l,D);else{p=k;k=K}},rule:function(){var l,w=k;if(name=f(this.property)||f(this.variable)){if(name.charAt(0)!="@"&&(match=q(/([^@+\/*(;{}-]*);/g))){k+=match[0].length-1;l=new i.Anonymous(match[1])}else l=name==="font"?f(this.font):f(this.value);if(f(this.end))return new i.Rule(name,
l,w);else{p=k;k=w}}},"import":function(){var l;if(f(/@import\s+/g)&&(l=f(this.entities.quoted)||f(this.entities.url))&&f(";"))return new i.Import(l,M)},directive:function(){var l,w,D;if(h.charAt(k)==="@")if(w=f(this["import"]))return w;else if(l=f(/@media|@page/g)){D=f(/[^{]+/g).trim();if(w=f(this.block))return new i.Directive(l+" "+D,w)}else if(l=f(/@[-a-z]+/g))if(l==="@font-face"){if(w=f(this.block))return new i.Directive(l,w)}else if((w=f(this.entity))&&f(";"))return new i.Directive(l,w)},font:function(){for(var l=
[],w=[],D;D=f(this.shorthand)||f(this.entity);)w.push(D);l.push(new i.Expression(w));if(f(","))for(;D=f(this.expression);){l.push(D);if(!f(","))break}return new i.Value(l,f(this.important))},value:function(){for(var l,w=[];l=f(this.expression);){w.push(l);if(!f(","))break}l=f(this.important);if(w.length>0)return new i.Value(w,l)},important:function(){return f(/!\s*important/g)},sub:function(){var l;if(f("(")&&(l=f(this.expression))&&f(")"))return l},multiplication:function(){var l,w,D,K;if(l=f(this.operand)){for(;(D=
f(/[\/*]/g))&&(w=f(this.operand));)K=new i.Operation(D,[K||l,w]);return K||l}},addition:function(){var l,w,D,K;if(l=f(this.multiplication)){for(;(D=f(/[-+]\s+/g)||h.charAt(k-1)!=" "&&f(/[-+]/g))&&(w=f(this.multiplication));)K=new i.Operation(D,[K||l,w]);return K||l}},operand:function(){return f(this.sub)||f(this.entities.dimension)||f(this.entities.color)||f(this.entities.variable)},expression:function(){for(var l,w=[];l=f(this.addition)||f(this.entity);)w.push(l);if(w.length>0)return new i.Expression(w)},
property:function(){var l;if(l=f(/(\*?-?[-a-z_0-9]+)\s*:/g))return l[1]}}}};o.Parser.importer=null;i.functions={rgb:function(e,f,q){return this.rgba(e,f,q,1)},rgba:function(e,f,q,h){e=[e,f,q].map(function(k){return v(k)});h=v(h);return new i.Color(e,h)},hsl:function(e,f,q){return this.hsla(e,f,q,1)},hsla:function(e,f,q,h){function k(t){t=t<0?t+1:t>1?t-1:t;return t*6<1?p+(j-p)*t*6:t*2<1?j:t*3<2?p+(j-p)*(2/3-t)*6:p}e=(v(e)%360+360)%360/360;f=v(f);q=v(q);h=v(h);var j=q<=0.5?q*(f+1):q+f-q*f,p=q*2-j;return this.rgba(k(e+
1/3)*255,k(e)*255,k(e-1/3)*255,h)},opacity:function(e,f){v(f);return new i.Color(e.rgb,v(f))},saturate:function(e,f){e=e.toHSL();e.s+=f.value/100;e.s=r(e.s);return this.hsl(e.h,e.s,e.l)},desaturate:function(e,f){e=e.toHSL();e.s-=f.value/100;e.s=r(e.s);return this.hsl(e.h,e.s,e.l)},lighten:function(e,f){e=e.toHSL();e.l*=1+f.value/100;e.l=r(e.l);return this.hsl(e.h,e.s,e.l)},darken:function(e,f){e=e.toHSL();e.l*=1-f.value/100;e.l=r(e.l);return this.hsl(e.h,e.s,e.l)},greyscale:function(e){return this.desaturate(e,
new i.Dimension(100))},e:function(e){return new i.Anonymous(e)},"%":function(e){for(var f=Array.prototype.slice.call(arguments,1),q=e.content,h=0;h<f.length;h++)q=q.replace(/%s/,f[h].content).replace(/%[da]/,f[h].toCSS());q=q.replace(/%%/g,"%");return new i.Quoted('"'+q+'"',q)}};i.Alpha=function(e){this.value=e};i.Alpha.prototype={toCSS:function(){return"alpha(opacity="+this.value.toCSS()+")"},eval:function(){return this}};i.Anonymous=function(e){this.value=e.content||e};i.Anonymous.prototype={toCSS:function(){return this.value},
eval:function(){return this}};i.Call=function(e,f){this.name=e;this.args=f};i.Call.prototype={eval:function(e){var f=this.args.map(function(q){return q.eval(e)});return this.name in i.functions?i.functions[this.name].apply(i.functions,f):new i.Anonymous(this.name+"("+f.map(function(q){return q.toCSS()}).join(", ")+")")},toCSS:function(e){return this.eval(e).toCSS()}};i.Color=function(e,f){if(Array.isArray(e)){this.rgb=e;this.alpha=f}else this.rgb=e.length==6?e.match(/.{2}/g).map(function(q){return parseInt(q,
16)}):e.split("").map(function(q){return parseInt(q+q,16)})};i.Color.prototype={eval:function(){return this},toCSS:function(){return this.alpha&&this.alpha<1?"rgba("+this.rgb.concat(this.alpha).join(", ")+")":"#"+this.rgb.map(function(e){e=Math.round(e);e=(e>255?255:e<0?0:e).toString(16);return e.length===1?"0"+e:e}).join("")},operate:function(e,f){var q=[];f instanceof i.Color||(f=f.toColor());for(var h=0;h<3;h++)q[h]=i.operate(e,this.rgb[h],f.rgb[h]);return new i.Color(q)},toHSL:function(){var e=
this.rgb[0]/255,f=this.rgb[1]/255,q=this.rgb[2]/255,h=Math.max(e,f,q),k=Math.min(e,f,q),j,p=(h+k)/2,t=h-k;if(h===k)j=k=0;else{k=p>0.5?t/(2-h-k):t/(h+k);switch(h){case e:j=(f-q)/t+(f<q?6:0);break;case f:j=(q-e)/t+2;break;case q:j=(e-f)/t+4;break}j/=6}return{h:j*360,s:k,l:p}}};i.Comment=function(e){this.value=e};i.Comment.prototype={toCSS:function(){return this.value}};i.Dimension=function(e,f){this.value=parseFloat(e);this.unit=f||null};i.Dimension.prototype={eval:function(){return this},toColor:function(){return new i.Color([this.value,
this.value,this.value])},toCSS:function(){return this.value+this.unit},operate:function(e,f){return new i.Dimension(i.operate(e,this.value,f.value),this.unit||f.unit)}};i.Directive=function(e,f){this.name=e;if(Array.isArray(f))this.ruleset=new i.Ruleset([],f);else this.value=f};i.Directive.prototype={toCSS:function(e,f){if(this.ruleset){this.ruleset.root=true;return this.name+" {\n  "+this.ruleset.toCSS(e,f).trim().replace(/\n/g,"\n  ")+"\n}\n"}else return this.name+" "+this.value.toCSS()+";\n"},
eval:function(e){e.frames.unshift(this);this.ruleset&&this.ruleset.evalRules(e);e.frames.shift();return this},variable:function(e){return i.Ruleset.prototype.variable.call(this.ruleset,e)},find:function(){return i.Ruleset.prototype.find.apply(this.ruleset,arguments)},rulesets:function(){return i.Ruleset.prototype.rulesets.apply(this.ruleset)}};i.Element=function(e,f){this.combinator=e instanceof i.Combinator?e:new i.Combinator(e);this.value=f.trim()};i.Element.prototype.toCSS=function(){return this.combinator.toCSS()+
this.value};i.Combinator=function(e){this.value=e===" "?" ":e?e.trim():""};i.Combinator.prototype.toCSS=function(){switch(this.value){case "":return"";case " ":return" ";case "&":return"";case ":":return" :";case "::":return"::";case "+":return" + ";case "~":return" ~ ";case ">":return" > "}};i.Expression=function(e){this.value=e};i.Expression.prototype={eval:function(e){return this.value.length>1?new i.Expression(this.value.map(function(f){return f.eval(e)})):this.value[0].eval(e)},toCSS:function(){return this.value.map(function(e){return e.toCSS()}).join(" ")}};
i.Import=function(e,f){var q=this;this._path=e;this.path=e instanceof i.Quoted?/\.(le?|c)ss$/.test(e.content)?e.content:e.content+".less":e.value.content||e.value;(this.css=/css$/.test(this.path))||f.push(this.path,function(h){q.root=h})};i.Import.prototype={toCSS:function(){return this.css?"@import "+this._path.toCSS()+";\n":""},eval:function(){if(this.css)return this;else{for(var e=0;e<this.root.rules.length;e++)this.root.rules[e]instanceof i.Import&&Array.prototype.splice.apply(this.root.rules,
[e,1].concat(this.root.rules[e].eval()));return this.root.rules}}};i.Keyword=function(e){this.value=e};i.Keyword.prototype={eval:function(){return this},toCSS:function(){return this.value}};i.mixin={};i.mixin.Call=function(e,f,q){this.selector=new i.Selector(e);this.arguments=f;this.index=q};i.mixin.Call.prototype={eval:function(e){for(var f,q=[],h=false,k=0;k<e.frames.length;k++)if((f=e.frames[k].find(this.selector)).length>0){for(k=0;k<f.length;k++)if(f[k].match(this.arguments,e))try{Array.prototype.push.apply(q,
f[k].eval(this.arguments,e).rules);h=true}catch(j){throw{message:j.message,index:this.index};}if(h)return q;else throw{message:"No matching definition was found for `"+this.selector.toCSS().trim()+"("+this.arguments.map(function(p){return p.toCSS()}).join(", ")+")`",index:this.index};}throw{message:this.selector.toCSS().trim()+" is undefined",index:this.index};}};i.mixin.Definition=function(e,f,q){this.name=e;this.selectors=[new i.Selector([new i.Element(null,e)])];this.params=f;this.arity=f.length;
this.rules=q;this._lookups={};this.required=f.reduce(function(h,k){return k.name&&!k.value?h+1:h},0)};i.mixin.Definition.prototype={toCSS:function(){return""},variable:function(e){return i.Ruleset.prototype.variable.call(this,e)},find:function(){return i.Ruleset.prototype.find.apply(this,arguments)},rulesets:function(){return i.Ruleset.prototype.rulesets.apply(this)},eval:function(e,f){for(var q=new i.Ruleset(null,[]),h=0,k;h<this.params.length;h++)if(this.params[h].name)if(k=e&&e[h]||this.params[h].value)q.rules.unshift(new i.Rule(this.params[h].name,
k.eval(f)));else throw{message:"wrong number of arguments for "+this.name+" ("+e.length+" for "+this.arity+")"};return(new i.Ruleset(null,this.rules)).evalRules({frames:[this,q].concat(f.frames)})},match:function(e,f){var q=e&&e.length||0;if(q<this.required)return false;for(var h=0;h<Math.min(q,this.arity);h++)if(!this.params[h].name)if(!e[h].wildcard)if(e[h].eval(f).toCSS()!=this.params[h].value.eval(f).toCSS())return false;return true}};i.Operation=function(e,f){this.op=e.trim();this.operands=f};
i.Operation.prototype.eval=function(e){var f=this.operands[0].eval(e);e=this.operands[1].eval(e);var q;if(f instanceof i.Dimension&&e instanceof i.Color)if(this.op==="*"||this.op==="+"){q=e;e=f;f=q}else throw{name:"OperationError",message:"Can't substract or divide a color from a number"};return f.operate(this.op,e)};i.operate=function(e,f,q){switch(e){case "+":return f+q;case "-":return f-q;case "*":return f*q;case "/":return f/q}};i.Quoted=function(e,f){this.value=e;this.content=f};i.Quoted.prototype=
{toCSS:function(){return this.value},eval:function(){return this}};i.Rule=function(e,f,q){this.name=e;this.value=f instanceof i.Value?f:new i.Value([f]);this.index=q;this.variable=e.charAt(0)==="@"?true:false};i.Rule.prototype.toCSS=function(){return this.variable?"":this.name+": "+this.value.toCSS()+";"};i.Rule.prototype.eval=function(e){return new i.Rule(this.name,this.value.eval(e))};i.Value=function(e){this.value=e;this.is="value"};i.Value.prototype={eval:function(e){return this.value.length===
1?this.value[0].eval(e):new i.Value(this.value.map(function(f){return f.eval(e)}))},toCSS:function(){return this.value.map(function(e){return e.toCSS()}).join(", ")}};i.Shorthand=function(e,f){this.a=e;this.b=f};i.Shorthand.prototype={toCSS:function(e){return this.a.toCSS(e)+"/"+this.b.toCSS(e)},eval:function(){return this}};i.Ruleset=function(e,f){this.selectors=e;this.rules=f;this._lookups={}};i.Ruleset.prototype={eval:function(){return this},evalRules:function(e){var f=[];this.rules.forEach(function(q){if(q.evalRules)f.push(q.evalRules(e));
else q instanceof i.mixin.Call?Array.prototype.push.apply(f,q.eval(e)):f.push(q.eval(e))});this.rules=f;return this},match:function(e){return!e||e.length===0},variable:function(e){return this._variables?this._variables[e]:(this._variables=this.rules.reduce(function(f,q){if(q instanceof i.Rule&&q.variable===true)f[q.name]=q;return f},{}))[e]},rulesets:function(){return this._rulesets?this._rulesets:(this._rulesets=this.rules.filter(function(e){if(e instanceof i.Ruleset||e instanceof i.mixin.Definition)return e}))},
find:function(e,f){f=f||this;var q=[],h=e.toCSS();if(h in this._lookups)return this._lookups[h];this.rulesets().forEach(function(k){if(k!==f)for(var j=0;j<k.selectors.length;j++)if(e.match(k.selectors[j])){e.elements.length>1?Array.prototype.push.apply(q,k.find(new i.Selector(e.elements.slice(1)),f)):q.push(k);break}});return this._lookups[h]=q},toCSS:function(e,f){var q=[],h=[],k=[],j=[];if(this.root){e=[];f={frames:[]};for(var p=0;p<this.rules.length;p++)this.rules[p]instanceof i.Import&&Array.prototype.splice.apply(this.rules,
[p,1].concat(this.rules[p].eval(f)))}else if(e.length===0)j=this.selectors.map(function(B){return[B]});else for(p=0;p<this.selectors.length;p++)for(var t=0;t<e.length;t++)j.push(e[t].concat([this.selectors[p]]));f.frames.unshift(this);for(p=0;p<this.rules.length;p++)this.rules[p]instanceof i.mixin.Call&&Array.prototype.splice.apply(this.rules,[p,1].concat(this.rules[p].eval(f)));for(p=0;p<this.rules.length;p++){e=this.rules[p];if(e instanceof i.Directive)k.push(e.eval(f).toCSS(j,f));else if(e.rules)k.push(e.toCSS(j,
f));else if(e instanceof i.Comment)this.root?k.push(e.toCSS()):h.push(e.toCSS());else if(e.toCSS&&!e.variable)h.push(e.eval(f).toCSS());else e.value&&!e.variable&&h.push(e.value.toString())}k=k.join("");if(this.root)q.push(h.join("\n"));else if(h.length>0){j=j.map(function(B){return B.map(function(C){return C.toCSS()}).join("").trim()}).join(j.length>3?",\n":", ");q.push(j," {\n  "+h.join("\n  ")+"\n}\n")}q.push(k);f.frames.shift();return q.join("")}};i.Selector=function(e){this.elements=e;if(this.elements[0].combinator.value===
"")this.elements[0].combinator.value=" "};i.Selector.prototype.match=function(e){return this.elements[0].value===e.elements[0].value?true:false};i.Selector.prototype.toCSS=function(){if(this._css)return this._css;return this._css=this.elements.map(function(e){return typeof e==="string"?" "+e.trim():e.toCSS()}).join("")};i.URL=function(e){this.value=e};i.URL.prototype={toCSS:function(){return"url("+this.value.toCSS()+")"},eval:function(){return this}};i.Variable=function(e,f){this.name=e;this.index=
f};i.Variable.prototype={eval:function(e){var f,q,h=this.name;if(f=i.find(e.frames,function(k){if(q=k.variable(h))return q.value.eval(e)}))return f;else throw{message:"variable "+this.name+" is undefined",index:this.index};}};i.find=function(e,f){for(var q=0,h;q<e.length;q++)if(h=f.call(e,e[q]))return h;return null};(function(){function e(C){for(var d=0;d<t.length;d++)f(t[d],C)}function f(C,d){var J=typeof localStorage!=="undefined"&&localStorage.getItem(C.href),M=J&&JSON.parse(J);h(C.href,function(l,
w){if(M&&(new Date(w)).valueOf()===(new Date(M.timestamp)).valueOf()){q(M.css,C);d(null,C,{local:true})}else(new o.Parser({optimization:3})).parse(l,function(D,K){if(D)return p(D,C.href);try{d(K,C,{local:false,lastModified:w})}catch(P){p(P,C.href)}})},function(l){throw new Error("Couldn't load "+C.href+" ("+l+")");})}function q(C,d,J){var M=document.createElement("style");M.type="text/css";M.media="screen";M.title="less-sheet";if(d){M.title=d.title||d.href.match(/(?:^|\/)([-\w]+)\.[a-z]+$/i)[1];J&&
typeof localStorage!=="undefined"&&localStorage.setItem(d.href,JSON.stringify({timestamp:J,css:C}))}if(M.styleSheet)M.styleSheet.cssText=C;else M.appendChild(document.createTextNode(C));document.getElementsByTagName("head")[0].appendChild(M)}function h(C,d,J){var M=k();if(window.location.protocol==="file:"){M.open("GET",C,false);M.send(null);M.status===0?d(M.responseText):J(M.status)}else{M.open("GET",C,true);M.onreadystatechange=function(){if(M.readyState==4)if(M.status>=200&&M.status<300)d(M.responseText,
M.getResponseHeader("Last-Modified"));else typeof J==="function"&&J(M.status)};M.send(null)}}function k(){if(window.XMLHttpRequest)return new XMLHttpRequest;else try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(C){j("less: browser doesn't support AJAX.");return null}}function j(C){o.env=="development"&&typeof console!=="undefined"&&console.log(C)}function p(C,d){var J=document.createElement("div"),M;J.id="less-error-message";J.innerHTML="<h3>"+(C.message||"There is an error in your .less file")+
'</h3><p><a href="'+d+'">'+d+"</a> on line "+C.line+", column "+(C.column+1)+":</p>"+'<div>\n<pre class="ctx"><span>[-1]</span>{0}</pre>\n<pre><span>[0]</span>{current}</pre>\n<pre class="ctx"><span>[1]</span>{2}</pre>\n</div>'.replace(/\[(-?\d)\]/g,function(l,w){return C.line+parseInt(w)}).replace(/\{(\d)\}/g,function(l,w){return C.extract[parseInt(w)]}).replace(/\{current\}/,C.extract[1].slice(0,C.column)+'<span class="error">'+C.extract[1].slice(C.column)+"</span>");q("#less-error-message span {margin-right: 15px;}#less-error-message pre {color: #ee4444;padding: 4px 0;margin: 0;}#less-error-message pre.ctx {color: #dd7777;}#less-error-message h3 {padding: 15px 0 5px 0;margin: 0;}#less-error-message a {color: #10a}#less-error-message .error {color: red;font-weight: bold;padding-bottom: 2px;border-bottom: 1px dashed red;}");
J.style.cssText="font-family: Arial, sans-serif;border: 1px solid #e00;background-color: #eee;border-radius: 5px;color: #e00;padding: 15px;margin-bottom: 15px";if(o.env=="development")M=setInterval(function(){if(document.body){document.body.insertBefore(J,document.body.childNodes[0]);clearInterval(M)}},10)}var t=[];o.env=location.hostname=="127.0.0.1"||location.hostname=="0.0.0.0"||location.hostname=="localhost"||location.protocol=="file:"?"development":"production";var B=setInterval(function(){if(document.body){if(!document.querySelectorAll&&
typeof jQuery==="undefined")j("No selector method found");else t=(document.querySelectorAll||jQuery).call(document,'link[rel="stylesheet/less"]');clearInterval(B);e(function(C,d,J){q(C.toCSS(),d,J.lastModified);J.local?j("less: loading "+d.href+" from local storage."):j("less: parsed "+d.href+" successfully.")})}},10);if(o.env==="development")refreshTimer=setInterval(function(){/!refresh/.test(location.hash)&&e(function(C,d,J){q(C.toCSS(),d,J)})},1E3);o.Parser.importer=function(C,d,J){f({href:C,title:C},
function(M){J(M)})}})()});bespin.tiki.register("::theme_manager_base",{name:"theme_manager_base",dependencies:{}});bespin.tiki.module("theme_manager_base:index",function(){});bespin.tiki.register("::keyboard",{name:"keyboard",dependencies:{canon:"0.0.0",settings:"0.0.0"}});
bespin.tiki.module("keyboard:keyboard",function(A,u){var v=A("bespin:plugins").catalog;A("bespin:console");A("bespin:util/stacktrace");var r=A("bespin:util/util"),o=A("settings").settings,i=A("keyboard:keyutil"),e=A("canon:history"),f=A("canon:request").Request,q=A("environment").env;u.buildFlags=function(h){h.context=q.contexts[0];return h};A=function(){};r.mixin(A.prototype,{_customKeymappingCache:{states:{}},processKeyEvent:function(h,k,j){h=i.commandCodes(h,true)[0];if(r.none(h))return false;
u.buildFlags(j);j.isCommandKey=true;return this._matchCommand(h,k,j)},_matchCommand:function(h,k,j){var p=this._findCommandExtension(h,k,j);if(p&&p.commandExt!=="no command"){j.isTextView&&k.resetKeyBuffers();var t=p.commandExt;t.load(function(B){B=new f({command:B,commandExt:t});e.execute(p.args,B)});return true}return p&&p.commandExt==="no command"?true:false},_buildBindingsRegex:function(h){h.forEach(function(k){if(r.none(k.key))if(Array.isArray(k.regex)){k.key=new RegExp("^"+k.regex[1]+"$");k.regex=
new RegExp(k.regex.join("")+"$")}else k.regex=new RegExp(k.regex+"$");else k.key=new RegExp("^"+k.key+"$")})},_buildKeymappingRegex:function(h){for(state in h.states)this._buildBindingsRegex(h.states[state]);h._convertedRegExp=true},_findCommandExtension:function(h,k,j){if(j.isTextView){var p=k._keyState;if(!j.isCommandKey||h.indexOf("alt_")===-1){k._keyBuffer+=h.replace(/ctrl_meta|meta/,"ctrl");k._keyMetaBuffer+=h}var t=[this._customKeymappingCache];t=t.concat(v.getExtensions("keymapping"));for(var B=
0;B<t.length;B++)if(!r.none(t[B].states[p])){r.none(t[B]._convertedRegExp)&&this._buildKeymappingRegex(t[B]);var C=this._bindingsMatch(h,j,k,t[B]);if(!r.none(C))return C}}k=v.getExtensions("command");var d=null;p={};h=h.replace(/ctrl_meta|meta/,"ctrl");k.some(function(J){if(this._commandMatches(J,h,j)){d=J;return true}return false}.bind(this));return r.none(d)?null:{commandExt:d,args:p}},_bindingsMatch:function(h,k,j,p){var t,B=null,C={},d;d=r.none(p.hasMetaKey)?j._keyMetaBuffer:j._keyBuffer;if(h.indexOf("alt_")===
0&&k.isCommandKey)d+=h;p.states[j._keyState].some(function(J){if(J.key&&!J.key.test(h))return false;if(J.regex&&!(t=J.regex.exec(d)))return false;if(J.disallowMatches)for(var M=0;M<J.disallowMatches.length;M++)if(t[J.disallowMatches[M]])return true;if(!u.flagsMatch(J.predicates,k))return false;if(J.exec){B=v.getExtensionByKey("command",J.exec);if(r.none(B))throw new Error("Can't find command "+J.exec+" in state="+j._keyState+", symbolicName="+h);if(J.params){var l;J.params.forEach(function(w){l=!r.none(w.match)&&
!r.none(t)?t[w.match]||w.defaultValue:w.defaultValue;if(w.type==="number")l=parseInt(l);C[w.name]=l})}j.resetKeyBuffers()}if(J.then){j._keyState=J.then;j.resetKeyBuffers()}if(r.none(B))B="no command";return true});if(r.none(B))return null;return{commandExt:B,args:C}},_commandMatches:function(h,k,j){var p=h.key;if(!p)return false;if(!u.flagsMatch(h.predicates,j))return false;if(typeof p==="string"){if(p!=k)return false;return true}if(!Array.isArray(p)){p=[p];h.key=p}for(h=0;h<p.length;h++){var t=p[h];
if(typeof t==="string"){if(t==k)return true}else if(t.key==k)return u.flagsMatch(t.predicates,j)}return false},_customKeymappingChanged:function(){var h=this._customKeymappingCache=JSON.parse(o.get("customKeymapping"));h.states=h.states||{};for(state in h.states)this._buildBindingsRegex(h.states[state]);h._convertedRegExp=true}});u.flagsMatch=function(h,k){if(r.none(h))return true;if(!k)return false;for(var j in h)if(k[j]!==h[j])return false;return true};u.keyboardManager=new A;v.registerExtension("settingChange",
{match:"customKeymapping",pointer:u.keyboardManager._customKeymappingChanged.bind(u.keyboardManager)})});
bespin.tiki.module("keyboard:keyutil",function(A,u){var v=A("bespin:util/util");u.KeyHelper=function(){var o={MODIFIER_KEYS:{16:"shift",17:"ctrl",18:"alt",224:"meta"},FUNCTION_KEYS:{8:"backspace",9:"tab",13:"return",19:"pause",27:"escape",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",44:"printscreen",45:"insert",46:"delete",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock"},PRINTABLE_KEYS:{32:" ",
48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",188:",",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:'"'},PRINTABLE_KEYS_CHARCODE:{},KEY:{}};for(var i in o.PRINTABLE_KEYS){var e=o.PRINTABLE_KEYS[i];o.PRINTABLE_KEYS_CHARCODE[e.charCodeAt(0)]=i;if(e.toUpperCase()!=
e)o.PRINTABLE_KEYS_CHARCODE[e.toUpperCase().charCodeAt(0)]=i}for(i in o.FUNCTION_KEYS){e=o.FUNCTION_KEYS[i].toUpperCase();o.KEY[e]=parseInt(i,10)}return o}();var r=function(o){return!!(o.altKey||o.ctrlKey||o.metaKey||o.charCode!==o.which&&u.KeyHelper.FUNCTION_KEYS[o.which])};u.commandCodes=function(o,i){var e=o._keyCode||o.keyCode,f=o._charCode===undefined?o.charCode:o._charCode,q=null,h=null,k="",j=true;if(e===0&&o.which===0)return false;if(f!==0)return false;if(u.KeyHelper.MODIFIER_KEYS[f])return[u.KeyHelper.MODIFIER_KEYS[f],
null];if(e){q=u.KeyHelper.FUNCTION_KEYS[e];if(!q&&(o.altKey||o.ctrlKey||o.metaKey)){q=u.KeyHelper.PRINTABLE_KEYS[e];if(e>47&&e<58)j=o.altKey}if(q){if(o.altKey)k+="alt_";if(o.ctrlKey)k+="ctrl_";if(o.metaKey)k+="meta_"}else if(o.ctrlKey||o.metaKey)return false}if(!q){e=o.which;h=q=String.fromCharCode(e);e=q.toLowerCase();if(o.metaKey){k="meta_";q=e}else q=null}if(o.shiftKey&&q&&j)k+="shift_";if(q)q=k+q;if(!i&&q)q=q.replace(/ctrl_meta|meta/,"ctrl");return[q,h]};u.addKeyDownListener=function(o,i){var e=
function(f){var q=i(f);q&&v.stopEvent(f);return q};o.addEventListener("keydown",function(f){if(v.isMozilla)if(u.KeyHelper.FUNCTION_KEYS[f.keyCode])return true;else if((f.ctrlKey||f.metaKey)&&u.KeyHelper.PRINTABLE_KEYS[f.keyCode])return true;if(r(f))return e(f);return true},false);o.addEventListener("keypress",function(f){if(v.isMozilla)if(u.KeyHelper.FUNCTION_KEYS[f.keyCode])return e(f);else if((f.ctrlKey||f.metaKey)&&u.KeyHelper.PRINTABLE_KEYS_CHARCODE[f.charCode]){f._keyCode=u.KeyHelper.PRINTABLE_KEYS_CHARCODE[f.charCode];
f._charCode=0;return e(f)}if(f.charCode!==undefined&&f.charCode===0)return true;return e(f)},false)}});bespin.tiki.module("keyboard:index",function(){});bespin.tiki.register("::edit_session",{name:"edit_session",dependencies:{events:"0.0.0"}});
bespin.tiki.module("edit_session:index",function(A,u){A("bespin:promise");A("bespin:plugins");A("bespin:util/util");A("events");u.EditSession=function(){};u.EditSession.prototype={_currentView:null,currentUser:null,history:null,getCompletePath:function(v){if(v==null)v="";if(v==null||v.substring(0,1)!="/"){var r;if(this._currentView&&this._currentView.buffer)r=this._currentView.buffer;var o;if(r)o=r.file;v=o?o.parentdir()+v:"/"+v}return v}};Object.defineProperties(u.EditSession.prototype,{currentView:{set:function(v){if(v!==
this._currentView)this._currentView=v},get:function(){return this._currentView}}});u.createSession=function(v,r){var o=new u.EditSession;if(v)o.currentView=v.textView;if(r)o.currentUser=r;return o}});bespin.tiki.register("::completion",{name:"completion",dependencies:{jquery:"0.0.0",ctags:"0.0.0",rangeutils:"0.0.0",canon:"0.0.0",underscore:"0.0.0"}});
bespin.tiki.module("completion:controller",function(A,u){function v(h){this._editorView=h;h.selectionChanged.add(this._selectionChanged.bind(this));h.willChangeBuffer.add(this._willChangeBuffer.bind(this));this._syntaxChanged=this._syntaxChanged.bind(this);this.tags=new o.Tags;this.ui=new e(h.element)}function r(h){return function(){return q.editor.completionController[h](q)}}var o=A("ctags"),i=A("rangeutils:utils/range"),e=A("completion:ui").CompletionUI,f=A("bespin:plugins").catalog,q=A("environment").env;
v.prototype={_buffer:null,_completionEngine:null,_completions:null,_stem:null,_hideCompletions:function(){this.ui.hide()},_selectionChanged:function(h){var k=this._completionEngine;if(!(k==null||!i.isZeroLength(h))){var j=this._buffer.layoutManager,p=j.syntaxManager,t=h.start;h=t.col;t=j.textStorage.lines[t.row];j=t.substring(0,h);h=t.substring(h);k=k.getCompletions(j,h,p);if(k==null)this._hideCompletions();else{p=k.tags;this._stem=k.stem;this._showCompletions(p)}}},_showCompletions:function(h){var k=
this._editorView,j=k.textView.getInsertionPointPosition();j=k.convertTextViewPoint(j);this.ui.show(h,j,k.layoutManager.fontDimension.lineHeight)},_syntaxChanged:function(h){h=f.getExtensionByKey("completion",h);if(h==null)this._completionEngine=null;else h.load().then(function(k){this._completionEngine=new k(this.tags)}.bind(this))},_willChangeBuffer:function(h){var k=this._buffer;k!=null&&k.layoutManager.syntaxManager.syntaxChanged.remove(this._syntaxChanged);h.layoutManager.syntaxManager.syntaxChanged.add(this._syntaxChanged);
this._buffer=h},cancel:function(){this.ui.hide()},complete:function(h){var k=this.ui,j=k.getCompletion().name;h.view.insertText(j.substring(this._stem.length));k.hide()},isCompleting:function(){return this.ui.visible},moveDown:function(){this.ui.move("down")},moveUp:function(){this.ui.move("up")},tags:null};u.CompletionController=v;u.completeCommand=r("complete");u.completeCancelCommand=r("cancel");u.completeDownCommand=r("moveDown");u.completeUpCommand=r("moveUp")});
bespin.tiki.module("completion:ui",function(A,u){function v(q){var h=o.uniqueId("bespin-completion-panel"),k=document.createElement("div");k.id=h;k.className="bespin-completion-panel";k.style.display="none";k.innerHTML='<div class="bespin-completion-pointer"></div><div class="bespin-completion-bubble-outer"><div class="bespin-completion-bubble-inner"><div class="bespin-completion-highlight"></div><ul></ul></div></div>';r(q).append(k);this.panel=r(k);this.parent=r(q)}var r=A("jquery").$,o=A("underscore")._,
i=o.template('<span class="bespin-completion-container"> &mdash; <%= container %></span>'),e=o.template('<div class="bespin-completion-second-row"><%= type %></div>'),f=o.template('<li><div class="bespin-completion-top-row"><span class="bespin-completion-kind bespin-completion-kind-<%= kind %>"><%= kind %></span><span class="bespin-completion-ident"><%= ident %></span><%= container %></div><%= second_row %></li>');v.prototype={_fromBottom:false,_index:0,_tags:null,_getHighlightDimensions:function(q){var h=
q.position(),k=q.outerHeight()-2;q=q.outerWidth()-2;return{left:h.left,top:h.top,height:k,width:q}},_listItemForIndex:function(q){return this.panel.find("li:eq("+q+")")},_populate:function(){var q=o(this._tags).map(function(h){var k=h["class"],j=h.module,p=h.namespace;k=k!=null?k:p!=null?p:"";if(j!=null)k=j+(k!=""?"#"+k:"");j=k==""?"":i({container:k});k=h.type;k=k==null?"":e({type:k});return f({kind:h.kind,ident:h.name,container:j,second_row:k})});this.panel.find("ul").html(q.join("\n"))},panel:null,
visible:false,getCompletion:function(){return this.visible?this._tags[this._index]:null},hide:function(){if(this.visible){this.panel.fadeOut(100);this.visible=false}},move:function(q){var h=this._index,k=this._listItemForIndex(h),j=q==="up"?k.prev():k.next();if(j.length!==0){this._index=h=q==="up"?h-1:h+1;h=r(k).find(".bespin-completion-top-row");var p=r(k).find(".bespin-completion-second-row");k=r(j).find(".bespin-completion-top-row");var t=r(j).find(".bespin-completion-second-row");p.hide();t.show();
var B=this.panel.find(".bespin-completion-highlight");B.stop(true,true);j=this._getHighlightDimensions(j);B.animate(j,100);t.hide();if(q==="down"){q=p.height();k.css("top",q);k.animate({top:0},100)}else{q=t.height();h.css("top",-q);h.animate({top:0},100)}t.fadeIn()}},show:function(q,h,k){this._tags=q=o(q).clone();this._populate();var j=this.visible,p=this.panel;p.stop(true,true);j||p.show();var t=this.parent.offset(),B=t.left,C=B+h.x,d=t.top+h.y;t=p.outerWidth();var J=p.outerHeight(),M=r(window).width(),
l=r(window).height();this._fromBottom=d=d+J+k>l;if(this._index>=q.length)this._index=q.length-1;if(d){d=p.find(".bespin-completion-pointer");d.removeClass("bespin-completion-pointer-up");d.addClass("bespin-completion-pointer-down");p.css({bottom:-h.y,top:""});this._tags.reverse();this._populate();if(!j)this._index=q.length-1}else{d=p.find(".bespin-completion-pointer");d.removeClass("bespin-completion-pointer-down");d.addClass("bespin-completion-pointer-up");p.css({top:h.y+k,bottom:""});if(!j)this._index=
0}if(!j){if(C+h.x+t>M){d.css({left:"",right:32});p.css("left",Math.min(M-t-B,h.x-t+43))}else{d.css({left:32,right:""});p.css("left",Math.max(B,h.x-43))}p.hide().animate({opacity:"show"},100)}q=p.find(".bespin-completion-highlight");q.stop(true,true);h=this._listItemForIndex(this._index);h.find(".bespin-completion-second-row").show();h=this._getHighlightDimensions(h);q.css(h);this.visible=true}};u.CompletionUI=v});bespin.tiki.module("completion:index",function(){});
bespin.tiki.register("::rangeutils",{name:"rangeutils",dependencies:{}});
bespin.tiki.module("rangeutils:utils/range",function(A,u){var v=A("bespin:util/util");u.addPositions=function(r,o){return{row:r.row+o.row,col:r.col+o.col}};u.cloneRange=function(r){var o=r.start;r=r.end;return{start:{row:o.row,col:o.col},end:{row:r.row,col:r.col}}};u.comparePositions=function(r,o){var i=r.row-o.row;return i===0?r.col-o.col:i};u.equal=function(r,o){return u.comparePositions(r.start,o.start)===0&&u.comparePositions(r.end,o.end)===0};u.extendRange=function(r,o){var i=r.end;return{start:r.start,
end:{row:i.row+o.row,col:i.col+o.col}}};u.intersectRangeSets=function(r,o){r=v.clone(r);o=v.clone(o);for(var i=[];r.length>0&&o.length>0;){var e=r.shift(),f=o.shift(),q=u.comparePositions(e.start,f.start),h=u.comparePositions(e.end,f.end);if(u.comparePositions(e.end,f.start)<0){i.push(e);o.unshift(f)}else if(u.comparePositions(f.end,e.start)<0){i.push(f);r.unshift(e)}else if(q<0){i.push({start:e.start,end:f.start});r.unshift({start:f.start,end:e.end});o.unshift(f)}else if(q===0)if(h<0)o.unshift({start:e.end,
end:f.end});else h>0&&r.unshift({start:f.end,end:e.end});else if(q>0){i.push({start:f.start,end:e.start});r.unshift(e);o.unshift({start:e.start,end:f.end})}}return i.concat(r,o)};u.isZeroLength=function(r){return r.start.row===r.end.row&&r.start.col===r.end.col};u.maxPosition=function(r,o){return u.comparePositions(r,o)>0?r:o};u.normalizeRange=function(r){return this.comparePositions(r.start,r.end)<0?r:{start:r.end,end:r.start}};u.rangeSetBoundaries=function(r){return{start:r[0].start,end:r[r.length-
1].end}};u.toString=function(r){var o=r.start;r=r.end;return"[ "+o.row+", "+o.col+" "+r.row+","+ +r.col+" ]"};u.unionRanges=function(r,o){return{start:r.start.row<o.start.row||r.start.row===o.start.row&&r.start.col<o.start.col?r.start:o.start,end:r.end.row>o.end.row||r.end.row===o.end.row&&r.end.col>o.end.col?r.end:o.end}};u.isPosition=function(r){return!v.none(r)&&!v.none(r.row)&&!v.none(r.col)};u.isRange=function(r){return!v.none(r)&&u.isPosition(r.start)&&u.isPosition(r.end)}});
bespin.tiki.module("rangeutils:index",function(){});bespin.tiki.register("::undomanager",{name:"undomanager",dependencies:{}});
bespin.tiki.module("undomanager:index",function(A,u){var v=A("bespin:util/util");A("environment");u.UndoManager=function(){};v.mixin(u.UndoManager.prototype,{_redoStack:[],_undoStack:[],_undoOrRedo:function(r,o,i){if(o.length===0)return false;o=o.pop();if(!o.target[r](o.context)){this._redoStack=[];this._undoStack=[];return false}i.push(o);return true},redo:function(){return this._undoOrRedo("redo",this._redoStack,this._undoStack)},registerUndo:function(r,o){this._redoStack=[];this._undoStack.push({target:r,
context:o})},undo:function(){return this._undoOrRedo("undo",this._undoStack,this._redoStack)}});u.global=new u.UndoManager;u.undoManagerCommand=function(r,o){u.global[o.commandExt.name]()}});bespin.tiki.register("::ctags",{name:"ctags",dependencies:{traits:"0.0.0",underscore:"0.0.0"}});
bespin.tiki.module("ctags:index",function(A,u){var v=A("underscore")._,r=A("./reader").TagReader;A=A("traits").Trait;u.Tags=function(){this.tags=[]};u.Tags.prototype=Object.create(Object.prototype,A.compose(A({_search:function(o,i){var e={name:o};o=this.tags;var f=v(o).sortedIndex(e,function(q){return q.name});for(f=e=f;e>=0&&e<o.length&&i(o[e]);)e--;for(;f>=0&&f<o.length&&i(o[f]);)f++;return o.slice(e+1,f)},add:function(o){var i=this.tags;Array.prototype.push.apply(i,o);i.sort(function(e,f){e=e.name;
f=f.name;if(e<f)return-1;if(e===f)return 0;return 1})},get:function(o){return this._search(o,function(i){return i.name===o})},scan:function(o,i,e){if(e===null||e===undefined)e={};var f=o.split("\n");o=parse(o,i,1);i=new Interpreter(o,i,f,e);i.interpret();this.add(i.tags)},stem:function(o){var i=o.length;return this._search(o,function(e){return e.name.substring(0,i)===o})}}),r))});
bespin.tiki.module("ctags:reader",function(A,u){var v=A("underscore")._;A=A("traits").Trait;u.TagReader=A({readLines:function(r){var o=[];v(r).each(function(i){i=i.split("\t");if(!(i.length<3)){var e=i[0];if(!/^!_TAG_/.test(e)){e={name:e,tagfile:i[1],addr:i[2]};var f;if(i.length>3&&i[3].indexOf(":")===-1){e.kind=i[3];f=4}else f=3;var q={};v(i.slice(f)).each(function(h){h=/^([^:]+):(.*)/.exec(h);q[h[1]]=h[2]});e.fields=q;o.push(e)}}});this.add(o)},readString:function(r){this.readLines(r.split("\n"))}})});
bespin.tiki.register("::theme_manager",{name:"theme_manager",dependencies:{theme_manager_base:"0.0.0",settings:"0.0.0",events:"0.0.0",less:"0.0.0"}});
bespin.tiki.module("theme_manager:index",function(A,u){A("bespin:promise");var v=A("bespin:plugins").catalog;A("events");var r=A("themestyles"),o=A("settings").settings,i=null,e=null;u.themestyles=r;u.themeSettingChanged=function(f,q,h){var k=v.getExtensionByKey("theme",h);if(h==="standard"||!h||!k){k=null;if(e!==null)k=v.getExtensionByKey("theme",e)}if(k)k.load().then(function(j){i&&r.unregisterThemeStyles(i);r.currentThemeVariables=j();i=k;r.parseGlobalVariables();r.reparse();k.url&&r.registerThemeStyles(k);
v.publish(u,"themeChange")});else if(i){r.unregisterThemeStyles(i);i=null;r.currentThemeVariables=null;r.parseGlobalVariables();r.reparse();v.publish(this,"themeChange")}};v.registerExtension("settingChange",{match:"theme",pointer:u.themeSettingChanged.bind(u)});u.setStandardTheme=function(f){e=f;f!==o.get("theme")&&u.themeSettingChanged(this)};u.setBasePlugin=function(f){r.basePluginName=f};u.startParsing=function(){r.preventParsing=false;return r.reparse()};u.registerTheme=function(f){var q=o.get("theme");
f.name===q&&u.themeSettingChanged(this,"theme",f.name)};u.unregisterTheme=function(f){f.name===o.get("theme")&&u.themeSettingChanged(this)};u.appLaunched=function(){v.publish(u,"themeChange")}});
bespin.tiki.module("theme_manager:themestyles",function(A,u){var v=A("bespin:util/util"),r=A("bespin:plugins").catalog,o=A("bespin:console").console,i=A("bespin:promise").Promise,e=A("bespin:promise").group,f=A("bespin:proxy"),q=new (A("less").Parser)({optimization:3}),h=1;u.currentThemeVariables=null;u.basePluginName=null;u.preventParsing=true;var k="";u.globalThemeVariables={};var j={},p={},t=function(w){var D={},K=[],P=function(X,U){K.push(X);if(typeof U!="object")D[K.join("_")]=U;else for(prop in U)P(prop,
U[prop]);K.pop()};P("global",w);return D},B={},C={font:"arial, lucida, helvetica, sans-serif",font_size:"14px",line_height:"1.8em",color:"#DAD4BA",text_shadow:"1px 1px rgba(0, 0, 0, 0.4)",error_color:"#F99",header_color:"white",link_color:"#ACF",control:{color:"#E1B41F",border:"1px solid rgba(0, 0, 0, 0.2)",border_radius:"0.25em",background:"rgba(0, 0, 0, 0.2)",active:{color:"#FF9600",border:"1px solid #E1B41F",inset_color:"#ff9600",background:"rgba(0, 0, 0, 0.2)"}},pane:{h1:{font:"'MuseoSans', Helvetica",
font_size:"2.8em",color:"white"},color:"#DAD4BA",text_shadow:"1px 1px rgba(0, 0, 0, 0.4)",link_color:"white",background:"#45443C",border_radius:".5em"},form:{color:"white",text_shadow:"1px 1px rgba(0, 0, 0, 0.4)",font:"'Lucida Sans','Lucida Grande',Verdana,Arial,sans-serif",font_size:"@global_font_size",line_height:"@global_line_height"},button:{color:"white",background:"#3E6CB9"},container:{background:"#1E1916",border:"1px solid black"},selectable:{color:"white",border:"0px solid transparent",background:"transparent",
active:{color:"black",border:"0px solid transparent",background:"#FF8E00"},hover:{color:"black",border:"0px solid transparent",background:"#FF8E00"}},hint:{color:"#AAA",active:{color:"black"},hover:{color:"black"}},accelerator:{color:"#996633",active:{color:"black"},hover:{color:"black"}},menu:{border_color:"black",inset_color_right:"#1E1916",inset_color_top_left:"#3E3936",background:"transparent"}};C=t(C);u.getPluginThemeVariables=function(w){var D=r.plugins[w];if(!D)return null;var K={};if(u.currentThemeVariables&&
u.currentThemeVariables[w])K=u.currentThemeVariables[w];D.provides.forEach(function(P){if(P.ep==="themevariable"){var X=P.name;K[X]=K[X]||P.defaultValue}});return K};u.parseGlobalVariables=function(){var w={},D="",K=u.currentThemeVariables;v.mixin(w,C);K&&K.global&&v.mixin(w,t(K.global));u.globalThemeVariables=w;for(prop in w)D+="@"+prop+":"+w[prop]+";";k=D};u.parseGlobalVariables();var d=function(w,D,K){if(j[D])styleElem=document.getElementById("_bespin_theme_style_"+j[D]);else{styleElem=document.createElement("style");
styleElem.setAttribute("id","_bespin_theme_style_"+h);j[D]=h;h++;document.body.appendChild(styleElem)}q.parse(k+K+p[D],function(P,X){if(P){P="Error less parsing "+D+" "+P.message;o.error(P);w.reject(P)}else{try{var U=X.toCSS()}catch($){P="Error less parsing "+D+" "+$;o.error(P);w.reject(P);return}if(styleElem&&styleElem.firstChild)styleElem.firstChild.textContent=U;else{P=document.createTextNode(U);styleElem.appendChild(P)}w.resolve()}})},J={};u.parsePlugin=function(w){if(u.preventParsing)return(new i).resolve();
var D=r.plugins[w];if(!D)throw"reparsePlugin: plugin "+w+" is not defined!";if(!J[w]){J[w]=new i;setTimeout(function(){var K=u.getPluginThemeVariables(w),P="";for(prop in K)P+="@"+prop+":"+K[prop]+";";K=new i;K.then(function(X){J[this.name].resolve(X);J[this.name]=null}.bind(this),function(){J[this.name].reject(data);J[this.name]=null}.bind(this));d(K,w,P)}.bind(D),0)}return J[w]};var M=function(w,D,K,P){K=K.replace(/url\(['"]*([^'")]*)(['"]*)\)/g,"url("+w+"$1)");p[D]+=K;P&&P.resolve()},l=null;u.registerThemeStyles=
function(w){var D=w.getPluginName(),K=r.getResourceURL(D);if(!(w.url instanceof Array))w.url=[w.url];p[D]="";var P=[],X=u.preventParsing;w.url.forEach(function(U){if(B[D]&&B[D][U])M(K,D,B[D][U]);else{var $=new i;P.push($);var ba=K+U+"?"+(new Date).getTime();f.xhr("GET",ba,true,function(aa){aa.overrideMimeType("text/plain")}).then(function(aa){M(K,D,aa,$)},function(){o.error("registerLessFile: Could not load "+K+U);$.resolve()})}});if(P.length===0)u.parsePlugin(D);else{X||e(P).then(function(){u.parsePlugin(D)});
if(l!==null)P=P.concat(l);l=e(P)}};u.reparse=function(){var w=new i;if(u.preventParsing)return w.resolve();l?l.then(function(){var D=[],K=u.basePluginName;K!==null&&p[K]&&D.push(u.parsePlugin(K));for(var P in p)P!==K&&D.push(u.parsePlugin(P));e(D).then(w.resolve.bind(w),w.reject.bind(w))},function(D){w.reject(D)}):w.resolve();return w};u.unregisterThemeStyles=function(w){w=w.getPluginName();if(j[w]){var D=document.getElementById("_bespin_theme_style_"+j[w]);D.parentNode.removeChild(D);delete j[w];
delete p[w]}}});bespin.tiki.register("::whitetheme",{name:"whitetheme",dependencies:{theme_manager:"0.0.0"}});
bespin.tiki.module("whitetheme:index",function(A,u){u.whiteTheme=function(){return{global:{font:"arial, lucida, helvetica, sans-serif",font_size:"14px",line_height:"1.8em",color:"#2E2E3D",text_shadow:"1px 1px white",error_color:"#C03A38",header_color:"#222222",link_color:"#597BAC",pane:{h1:{font:"'MuseoSans', Helvetica",font_size:"2.8em",color:"#2C3480"},link_color:"@global_link_color",background:"#DFDFDF",border_radius:".5em",color:"#2E2E3D",text_shadow:"1px 1px #DDD"},form:{font:"@global_font",
font_size:"@global_font_size",line_height:"@global_line_height",color:"black",text_shadow:"0px 0px transparent"},control:{color:"#222",border:"1px solid rgba(0, 0, 0, 0.2)",border_radius:"0.25em",background:"rgba(0, 0, 0, 0.1)",active:{color:"#000",border:"1px solid #597BAC",inset_color:"#597BAC",background:"rgba(0, 0, 0, 0.1)"}},button:{color:"white",background:"#3E6CB9"},container:{background:"#F8F8F8",border:"1px solid black"},menu:{border_color:"black",inset_color:"#999",background:"transparent"},
selectable:{color:"black",border:"0px solid transparent",background:"transparent",active:{color:"white",border:"0px solid transparent",background:"#6780E4"},hover:{color:"white",border:"0px solid transparent",background:"#6780E4"}},hint:{color:"#78788D",active:{color:"white"},hover:{color:"white"}},accelerator:{color:"#344DB1",active:{color:"white"},hover:{color:"white"}}},text_editor:{gutter:{color:"#888888",backgroundColor:"#d2d2d2"},editor:{color:"#3D3D3D",backgroundColor:"#ffffff",cursorColor:"#000000",
selectedTextBackgroundColor:"#BDD9FC",unfocusedCursorColor:"#57A1FF",unfocusedCursorBackgroundColor:"#D9E9FC"},highlighter:{plain:"#030303",comment:"#919191",directive:"#999999",error:"#ff0000",identifier:"#A7379F",keyword:"#1414EF",operator:"#477ABE",string:"#017F19"},scroller:{padding:5,thickness:17,backgroundStyle:"#2A211C",fullAlpha:1,particalAlpha:0.3,nibStyle:"rgb(150, 150, 150)",nibArrowStyle:"rgb(255, 255, 255)",nibStrokeStyle:"white",trackFillStyle:"rgba(50, 50, 50, 0.2)",trackStrokeStyle:"rgb(150, 150, 150)",
barFillStyle:"rgb(60, 60, 60)",barFillGradientTopStart:"rgb(150, 150, 150)",barFillGradientTopStop:"rgb(100, 100, 100)",barFillGradientBottomStart:"rgb(82, 82, 82)",barFillGradientBottomStop:"rgb(104, 104, 104)"}}}}});bespin.tiki.register("::jquery",{name:"jquery",dependencies:{}});
bespin.tiki.module("jquery:index",function(A,u){function v(){if(!d.isReady){try{l.documentElement.doScroll("left")}catch(a){setTimeout(v,1);return}d.ready()}}function r(a,b){b.src?d.ajax({url:b.src,async:false,dataType:"script"}):d.globalEval(b.text||b.textContent||b.innerHTML||"");b.parentNode&&b.parentNode.removeChild(b)}function o(a,b,g,n,m,y){var z=a.length;if(typeof b==="object"){for(var I in b)o(a,I,b[I],n,m,g);return a}if(g!==undefined){n=!y&&n&&d.isFunction(g);for(I=0;I<z;I++)m(a[I],b,n?g.call(a[I],
I,m(a[I],b)):g,y);return a}return z?m(a[0],b):undefined}function i(){return(new Date).getTime()}function e(){return false}function f(){return true}function q(a,b,g){g[0].type=a;return d.event.handle.apply(b,g)}function h(a){var b,g=[],n=[],m=arguments,y,z,I,E,H,O;z=d.data(this,"events");if(!(a.liveFired===this||!z||!z.live||a.button&&a.type==="click")){a.liveFired=this;var R=z.live.slice(0);for(E=0;E<R.length;E++){z=R[E];z.origType.replace(na,"")===a.type?n.push(z.selector):R.splice(E--,1)}y=d(a.target).closest(n,
a.currentTarget);H=0;for(O=y.length;H<O;H++)for(E=0;E<R.length;E++){z=R[E];if(y[H].selector===z.selector){I=y[H].elem;n=null;if(z.preType==="mouseenter"||z.preType==="mouseleave")n=d(a.relatedTarget).closest(z.selector)[0];if(!n||n!==I)g.push({elem:I,handleObj:z})}}H=0;for(O=g.length;H<O;H++){y=g[H];a.currentTarget=y.elem;a.data=y.handleObj.data;a.handleObj=y.handleObj;if(y.handleObj.origHandler.apply(y.elem,m)===false){b=false;break}}return b}}function k(a,b){return"live."+(a&&a!=="*"?a+".":"")+
b.replace(/\./g,"`").replace(/ /g,"&")}function j(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function p(a,b){var g=0;b.each(function(){if(this.nodeName===(a[g]&&a[g].nodeName)){var n=d.data(a[g++]),m=d.data(this,n);if(n=n&&n.events){delete m.handle;m.events={};for(var y in n)for(var z in n[y])d.event.add(this,y,n[y][z],n[y][z].data)}}})}function t(a,b,g){var n,m,y;b=b&&b[0]?b[0].ownerDocument||b[0]:l;if(a.length===1&&typeof a[0]==="string"&&a[0].length<512&&b===l&&!Da.test(a[0])&&(d.support.checkClone||
!Ea.test(a[0]))){m=true;if(y=d.fragments[a[0]])if(y!==1)n=y}if(!n){n=b.createDocumentFragment();d.clean(a,b,n,g)}if(m)d.fragments[a[0]]=y?n:1;return{fragment:n,cacheable:m}}function B(a,b){var g={};d.each(Fa.concat.apply([],Fa.slice(0,b)),function(){g[this]=a});return g}function C(a){return"scrollTo"in a&&a.document?a:a.nodeType===9?a.defaultView||a.parentWindow:false}var d=function(a,b){return new d.fn.init(a,b)},J=window.jQuery,M=window.$,l=window.document,w,D=/^[^<]*(<[\w\W]+>)[^>]*$|^#([\w-]+)$/,
K=/^.[^:#\[\.,]*$/,P=/\S/,X=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,U=/^<(\w+)\s*\/?>(?:<\/\1>)?$/;A=navigator.userAgent;var $=false,ba=[],aa,ia=Object.prototype.toString,ja=Object.prototype.hasOwnProperty,ka=Array.prototype.push,oa=Array.prototype.slice,Ga=Array.prototype.indexOf;d.fn=d.prototype={init:function(a,b){var g,n;if(!a)return this;if(a.nodeType){this.context=this[0]=a;this.length=1;return this}if(a==="body"&&!b){this.context=l;this[0]=l.body;this.selector="body";this.length=1;return this}if(typeof a===
"string")if((g=D.exec(a))&&(g[1]||!b))if(g[1]){n=b?b.ownerDocument||b:l;if(a=U.exec(a))if(d.isPlainObject(b)){a=[l.createElement(a[1])];d.fn.attr.call(a,b,true)}else a=[n.createElement(a[1])];else{a=t([g[1]],[n]);a=(a.cacheable?a.fragment.cloneNode(true):a.fragment).childNodes}return d.merge(this,a)}else{if(b=l.getElementById(g[2])){if(b.id!==g[2])return w.find(a);this.length=1;this[0]=b}this.context=l;this.selector=a;return this}else if(!b&&/^\w+$/.test(a)){this.selector=a;this.context=l;a=l.getElementsByTagName(a);
return d.merge(this,a)}else return!b||b.jquery?(b||w).find(a):d(b).find(a);else if(d.isFunction(a))return w.ready(a);if(a.selector!==undefined){this.selector=a.selector;this.context=a.context}return d.makeArray(a,this)},selector:"",jquery:"1.4.2",length:0,size:function(){return this.length},toArray:function(){return oa.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this.slice(a)[0]:this[a]},pushStack:function(a,b,g){var n=d();d.isArray(a)?ka.apply(n,a):d.merge(n,a);n.prevObject=this;
n.context=this.context;if(b==="find")n.selector=this.selector+(this.selector?" ":"")+g;else if(b)n.selector=this.selector+"."+b+"("+g+")";return n},each:function(a,b){return d.each(this,a,b)},ready:function(a){d.bindReady();if(d.isReady)a.call(l,d);else ba&&ba.push(a);return this},eq:function(a){return a===-1?this.slice(a):this.slice(a,+a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(oa.apply(this,arguments),"slice",oa.call(arguments).join(","))},
map:function(a){return this.pushStack(d.map(this,function(b,g){return a.call(b,g,b)}))},end:function(){return this.prevObject||d(null)},push:ka,sort:[].sort,splice:[].splice};d.fn.init.prototype=d.fn;d.extend=d.fn.extend=function(){var a=arguments[0]||{},b=1,g=arguments.length,n=false,m,y,z,I;if(typeof a==="boolean"){n=a;a=arguments[1]||{};b=2}if(typeof a!=="object"&&!d.isFunction(a))a={};if(g===b){a=this;--b}for(;b<g;b++)if((m=arguments[b])!=null)for(y in m){z=a[y];I=m[y];if(a!==I)if(n&&I&&(d.isPlainObject(I)||
d.isArray(I))){z=z&&(d.isPlainObject(z)||d.isArray(z))?z:d.isArray(I)?[]:{};a[y]=d.extend(n,z,I)}else if(I!==undefined)a[y]=I}return a};d.extend({noConflict:function(a){window.$=M;if(a)window.jQuery=J;return d},isReady:false,ready:function(){if(!d.isReady){if(!l.body)return setTimeout(d.ready,13);d.isReady=true;if(ba){for(var a,b=0;a=ba[b++];)a.call(l,d);ba=null}d.fn.triggerHandler&&d(l).triggerHandler("ready")}},bindReady:function(){if(!$){$=true;if(l.readyState==="complete")return d.ready();if(l.addEventListener){l.addEventListener("DOMContentLoaded",
aa,false);window.addEventListener("load",d.ready,false)}else if(l.attachEvent){l.attachEvent("onreadystatechange",aa);window.attachEvent("onload",d.ready);var a=false;try{a=window.frameElement==null}catch(b){}l.documentElement.doScroll&&a&&v()}}},isFunction:function(a){return ia.call(a)==="[object Function]"},isArray:function(a){return ia.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||ia.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!ja.call(a,
"constructor")&&!ja.call(a.constructor.prototype,"isPrototypeOf"))return false;var b;for(b in a);return b===undefined||ja.call(a,b)},isEmptyObject:function(a){for(var b in a)return false;return true},error:function(a){throw a;},parseJSON:function(a){if(typeof a!=="string"||!a)return null;a=d.trim(a);if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return window.JSON&&
window.JSON.parse?window.JSON.parse(a):(new Function("return "+a))();else d.error("Invalid JSON: "+a)},noop:function(){},globalEval:function(a){if(a&&P.test(a)){var b=l.getElementsByTagName("head")[0]||l.documentElement,g=l.createElement("script");g.type="text/javascript";if(d.support.scriptEval)g.appendChild(l.createTextNode(a));else g.text=a;b.insertBefore(g,b.firstChild);b.removeChild(g)}},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,b,g){var n,
m=0,y=a.length,z=y===undefined||d.isFunction(a);if(g)if(z)for(n in a){if(b.apply(a[n],g)===false)break}else for(;m<y;){if(b.apply(a[m++],g)===false)break}else if(z)for(n in a){if(b.call(a[n],n,a[n])===false)break}else for(g=a[0];m<y&&b.call(g,m,g)!==false;g=a[++m]);return a},trim:function(a){return(a||"").replace(X,"")},makeArray:function(a,b){b=b||[];if(a!=null)a.length==null||typeof a==="string"||d.isFunction(a)||typeof a!=="function"&&a.setInterval?ka.call(b,a):d.merge(b,a);return b},inArray:function(a,
b){if(b.indexOf)return b.indexOf(a);for(var g=0,n=b.length;g<n;g++)if(b[g]===a)return g;return-1},merge:function(a,b){var g=a.length,n=0;if(typeof b.length==="number")for(var m=b.length;n<m;n++)a[g++]=b[n];else for(;b[n]!==undefined;)a[g++]=b[n++];a.length=g;return a},grep:function(a,b,g){for(var n=[],m=0,y=a.length;m<y;m++)!g!==!b(a[m],m)&&n.push(a[m]);return n},map:function(a,b,g){for(var n=[],m,y=0,z=a.length;y<z;y++){m=b(a[y],y,g);if(m!=null)n[n.length]=m}return n.concat.apply([],n)},guid:1,proxy:function(a,
b,g){if(arguments.length===2)if(typeof b==="string"){g=a;a=g[b];b=undefined}else if(b&&!d.isFunction(b)){g=b;b=undefined}if(!b&&a)b=function(){return a.apply(g||this,arguments)};if(a)b.guid=a.guid=a.guid||b.guid||d.guid++;return b},uaMatch:function(a){a=a.toLowerCase();a=/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||!/compatible/.test(a)&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(a)||[];return{browser:a[1]||"",version:a[2]||"0"}},browser:{}});
A=d.uaMatch(A);if(A.browser){d.browser[A.browser]=true;d.browser.version=A.version}if(d.browser.webkit)d.browser.safari=true;if(Ga)d.inArray=function(a,b){return Ga.call(b,a)};w=d(l);if(l.addEventListener)aa=function(){l.removeEventListener("DOMContentLoaded",aa,false);d.ready()};else if(l.attachEvent)aa=function(){if(l.readyState==="complete"){l.detachEvent("onreadystatechange",aa);d.ready()}};(function(){d.support={};var a=l.documentElement,b=l.createElement("script"),g=l.createElement("div"),n=
"script"+i();g.style.display="none";g.innerHTML="   <link/><table></table><a href='/a' style='color:red;float:left;opacity:.55;'>a</a><input type='checkbox'/>";var m=g.getElementsByTagName("*"),y=g.getElementsByTagName("a")[0];if(!(!m||!m.length||!y)){d.support={leadingWhitespace:g.firstChild.nodeType===3,tbody:!g.getElementsByTagName("tbody").length,htmlSerialize:!!g.getElementsByTagName("link").length,style:/red/.test(y.getAttribute("style")),hrefNormalized:y.getAttribute("href")==="/a",opacity:/^0.55$/.test(y.style.opacity),
cssFloat:!!y.style.cssFloat,checkOn:g.getElementsByTagName("input")[0].value==="on",optSelected:l.createElement("select").appendChild(l.createElement("option")).selected,parentNode:g.removeChild(g.appendChild(l.createElement("div"))).parentNode===null,deleteExpando:true,checkClone:false,scriptEval:false,noCloneEvent:true,boxModel:null};b.type="text/javascript";try{b.appendChild(l.createTextNode("window."+n+"=1;"))}catch(z){}a.insertBefore(b,a.firstChild);if(window[n]){d.support.scriptEval=true;delete window[n]}try{delete b.test}catch(I){d.support.deleteExpando=
false}a.removeChild(b);if(g.attachEvent&&g.fireEvent){g.attachEvent("onclick",function E(){d.support.noCloneEvent=false;g.detachEvent("onclick",E)});g.cloneNode(true).fireEvent("onclick")}g=l.createElement("div");g.innerHTML="<input type='radio' name='radiotest' checked='checked'/>";a=l.createDocumentFragment();a.appendChild(g.firstChild);d.support.checkClone=a.cloneNode(true).cloneNode(true).lastChild.checked;d(function(){var E=l.createElement("div");E.style.width=E.style.paddingLeft="1px";l.body.appendChild(E);
d.boxModel=d.support.boxModel=E.offsetWidth===2;l.body.removeChild(E).style.display="none"});a=function(E){var H=l.createElement("div");E="on"+E;var O=E in H;if(!O){H.setAttribute(E,"return;");O=typeof H[E]==="function"}return O};d.support.submitBubbles=a("submit");d.support.changeBubbles=a("change");a=b=g=m=y=null}})();d.props={"for":"htmlFor","class":"className",readonly:"readOnly",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",colspan:"colSpan",tabindex:"tabIndex",usemap:"useMap",
frameborder:"frameBorder"};var fa="jQuery"+i(),Ya=0,Ha={};d.extend({cache:{},expando:fa,noData:{embed:true,object:true,applet:true},data:function(a,b,g){if(!(a.nodeName&&d.noData[a.nodeName.toLowerCase()])){a=a==window?Ha:a;var n=a[fa],m=d.cache;if(!n&&typeof b==="string"&&g===undefined)return null;n||(n=++Ya);if(typeof b==="object"){a[fa]=n;m[n]=d.extend(true,{},b)}else if(!m[n]){a[fa]=n;m[n]={}}a=m[n];if(g!==undefined)a[b]=g;return typeof b==="string"?a[b]:a}},removeData:function(a,b){if(!(a.nodeName&&
d.noData[a.nodeName.toLowerCase()])){a=a==window?Ha:a;var g=a[fa],n=d.cache,m=n[g];if(b){if(m){delete m[b];d.isEmptyObject(m)&&d.removeData(a)}}else{if(d.support.deleteExpando)delete a[d.expando];else a.removeAttribute&&a.removeAttribute(d.expando);delete n[g]}}}});d.fn.extend({data:function(a,b){if(typeof a==="undefined"&&this.length)return d.data(this[0]);else if(typeof a==="object")return this.each(function(){d.data(this,a)});var g=a.split(".");g[1]=g[1]?"."+g[1]:"";if(b===undefined){var n=this.triggerHandler("getData"+
g[1]+"!",[g[0]]);if(n===undefined&&this.length)n=d.data(this[0],a);return n===undefined&&g[1]?this.data(g[0]):n}else return this.trigger("setData"+g[1]+"!",[g[0],b]).each(function(){d.data(this,a,b)})},removeData:function(a){return this.each(function(){d.removeData(this,a)})}});d.extend({queue:function(a,b,g){if(a){b=(b||"fx")+"queue";var n=d.data(a,b);if(!g)return n||[];if(!n||d.isArray(g))n=d.data(a,b,d.makeArray(g));else n.push(g);return n}},dequeue:function(a,b){b=b||"fx";var g=d.queue(a,b),n=
g.shift();if(n==="inprogress")n=g.shift();if(n){b==="fx"&&g.unshift("inprogress");n.call(a,function(){d.dequeue(a,b)})}}});d.fn.extend({queue:function(a,b){if(typeof a!=="string"){b=a;a="fx"}if(b===undefined)return d.queue(this[0],a);return this.each(function(){var g=d.queue(this,a,b);a==="fx"&&g[0]!=="inprogress"&&d.dequeue(this,a)})},dequeue:function(a){return this.each(function(){d.dequeue(this,a)})},delay:function(a,b){a=d.fx?d.fx.speeds[a]||a:a;b=b||"fx";return this.queue(b,function(){var g=
this;setTimeout(function(){d.dequeue(g,b)},a)})},clearQueue:function(a){return this.queue(a||"fx",[])}});var Ia=/[\n\t]/g,ta=/\s+/,Za=/\r/g,$a=/href|src|style/,ab=/(button|input)/i,bb=/(button|input|object|select|textarea)/i,cb=/^(a|area)$/i,Ja=/radio|checkbox/;d.fn.extend({attr:function(a,b){return o(this,a,b,true,d.attr)},removeAttr:function(a){return this.each(function(){d.attr(this,a,"");this.nodeType===1&&this.removeAttribute(a)})},addClass:function(a){if(d.isFunction(a))return this.each(function(H){var O=
d(this);O.addClass(a.call(this,H,O.attr("class")))});if(a&&typeof a==="string")for(var b=(a||"").split(ta),g=0,n=this.length;g<n;g++){var m=this[g];if(m.nodeType===1)if(m.className){for(var y=" "+m.className+" ",z=m.className,I=0,E=b.length;I<E;I++)if(y.indexOf(" "+b[I]+" ")<0)z+=" "+b[I];m.className=d.trim(z)}else m.className=a}return this},removeClass:function(a){if(d.isFunction(a))return this.each(function(E){var H=d(this);H.removeClass(a.call(this,E,H.attr("class")))});if(a&&typeof a==="string"||
a===undefined)for(var b=(a||"").split(ta),g=0,n=this.length;g<n;g++){var m=this[g];if(m.nodeType===1&&m.className)if(a){for(var y=(" "+m.className+" ").replace(Ia," "),z=0,I=b.length;z<I;z++)y=y.replace(" "+b[z]+" "," ");m.className=d.trim(y)}else m.className=""}return this},toggleClass:function(a,b){var g=typeof a,n=typeof b==="boolean";if(d.isFunction(a))return this.each(function(m){var y=d(this);y.toggleClass(a.call(this,m,y.attr("class"),b),b)});return this.each(function(){if(g==="string")for(var m,
y=0,z=d(this),I=b,E=a.split(ta);m=E[y++];){I=n?I:!z.hasClass(m);z[I?"addClass":"removeClass"](m)}else if(g==="undefined"||g==="boolean"){this.className&&d.data(this,"__className__",this.className);this.className=this.className||a===false?"":d.data(this,"__className__")||""}})},hasClass:function(a){a=" "+a+" ";for(var b=0,g=this.length;b<g;b++)if((" "+this[b].className+" ").replace(Ia," ").indexOf(a)>-1)return true;return false},val:function(a){if(a===undefined){var b=this[0];if(b){if(d.nodeName(b,
"option"))return(b.attributes.value||{}).specified?b.value:b.text;if(d.nodeName(b,"select")){var g=b.selectedIndex,n=[],m=b.options;b=b.type==="select-one";if(g<0)return null;var y=b?g:0;for(g=b?g+1:m.length;y<g;y++){var z=m[y];if(z.selected){a=d(z).val();if(b)return a;n.push(a)}}return n}if(Ja.test(b.type)&&!d.support.checkOn)return b.getAttribute("value")===null?"on":b.value;return(b.value||"").replace(Za,"")}}else{var I=d.isFunction(a);return this.each(function(E){var H=d(this),O=a;if(this.nodeType===
1){if(I)O=a.call(this,E,H.val());if(typeof O==="number")O+="";if(d.isArray(O)&&Ja.test(this.type))this.checked=d.inArray(H.val(),O)>=0;else if(d.nodeName(this,"select")){var R=d.makeArray(O);d("option",this).each(function(){this.selected=d.inArray(d(this).val(),R)>=0});if(!R.length)this.selectedIndex=-1}else this.value=O}})}}});d.extend({attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},attr:function(a,b,g,n){if(!(!a||a.nodeType===3||a.nodeType===8)){if(n&&
b in d.attrFn)return d(a)[b](g);n=a.nodeType!==1||!d.isXMLDoc(a);var m=g!==undefined;b=n&&d.props[b]||b;if(a.nodeType===1){var y=$a.test(b);if(b in a&&n&&!y){if(m){b==="type"&&ab.test(a.nodeName)&&a.parentNode&&d.error("type property can't be changed");a[b]=g}if(d.nodeName(a,"form")&&a.getAttributeNode(b))return a.getAttributeNode(b).nodeValue;if(b==="tabIndex")return(b=a.getAttributeNode("tabIndex"))&&b.specified?b.value:bb.test(a.nodeName)||cb.test(a.nodeName)&&a.href?0:undefined;return a[b]}if(!d.support.style&&
n&&b==="style"){if(m)a.style.cssText=""+g;return a.style.cssText}m&&a.setAttribute(b,""+g);a=!d.support.hrefNormalized&&n&&y?a.getAttribute(b,2):a.getAttribute(b);return a===null?undefined:a}return d.style(a,b,g)}}});var na=/\.(.*)$/,db=function(a){return a.replace(/[^\w\s\.\|`]/g,function(b){return"\\"+b})};d.event={add:function(a,b,g,n){if(!(a.nodeType===3||a.nodeType===8)){if(a.setInterval&&a!==window&&!a.frameElement)a=window;var m,y;if(g.handler){m=g;g=m.handler}if(!g.guid)g.guid=d.guid++;if(y=
d.data(a)){var z=y.events=y.events||{},I=y.handle;if(!I)y.handle=I=function(){return typeof d!=="undefined"&&!d.event.triggered?d.event.handle.apply(I.elem,arguments):undefined};I.elem=a;b=b.split(" ");for(var E,H=0,O;E=b[H++];){y=m?d.extend({},m):{handler:g,data:n};if(E.indexOf(".")>-1){O=E.split(".");E=O.shift();y.namespace=O.slice(0).sort().join(".")}else{O=[];y.namespace=""}y.type=E;y.guid=g.guid;var R=z[E],W=d.event.special[E]||{};if(!R){R=z[E]=[];if(!W.setup||W.setup.call(a,n,O,I)===false)if(a.addEventListener)a.addEventListener(E,
I,false);else a.attachEvent&&a.attachEvent("on"+E,I)}if(W.add){W.add.call(a,y);if(!y.handler.guid)y.handler.guid=g.guid}R.push(y);d.event.global[E]=true}a=null}}},global:{},remove:function(a,b,g,n){if(!(a.nodeType===3||a.nodeType===8)){var m,y=0,z,I,E,H,O,R,W=d.data(a),Z=W&&W.events;if(W&&Z){if(b&&b.type){g=b.handler;b=b.type}if(!b||typeof b==="string"&&b.charAt(0)==="."){b=b||"";for(m in Z)d.event.remove(a,m+b)}else{for(b=b.split(" ");m=b[y++];){H=m;z=m.indexOf(".")<0;I=[];if(!z){I=m.split(".");
m=I.shift();E=new RegExp("(^|\\.)"+d.map(I.slice(0).sort(),db).join("\\.(?:.*\\.)?")+"(\\.|$)")}if(O=Z[m])if(g){H=d.event.special[m]||{};for(Y=n||0;Y<O.length;Y++){R=O[Y];if(g.guid===R.guid){if(z||E.test(R.namespace)){n==null&&O.splice(Y--,1);H.remove&&H.remove.call(a,R)}if(n!=null)break}}if(O.length===0||n!=null&&O.length===1){if(!H.teardown||H.teardown.call(a,I)===false)Ka(a,m,W.handle);delete Z[m]}}else for(var Y=0;Y<O.length;Y++){R=O[Y];if(z||E.test(R.namespace)){d.event.remove(a,H,R.handler,
Y);O.splice(Y--,1)}}}if(d.isEmptyObject(Z)){if(b=W.handle)b.elem=null;delete W.events;delete W.handle;d.isEmptyObject(W)&&d.removeData(a)}}}}},trigger:function(a,b,g,n){var m=a.type||a;if(!n){a=typeof a==="object"?a[fa]?a:d.extend(d.Event(m),a):d.Event(m);if(m.indexOf("!")>=0){a.type=m=m.slice(0,-1);a.exclusive=true}if(!g){a.stopPropagation();d.event.global[m]&&d.each(d.cache,function(){this.events&&this.events[m]&&d.event.trigger(a,b,this.handle.elem)})}if(!g||g.nodeType===3||g.nodeType===8)return;
a.result=undefined;a.target=g;b=d.makeArray(b);b.unshift(a)}a.currentTarget=g;(n=d.data(g,"handle"))&&n.apply(g,b);n=g.parentNode||g.ownerDocument;try{if(!(g&&g.nodeName&&d.noData[g.nodeName.toLowerCase()]))if(g["on"+m]&&g["on"+m].apply(g,b)===false)a.result=false}catch(y){}if(!a.isPropagationStopped()&&n)d.event.trigger(a,b,n,true);else if(!a.isDefaultPrevented()){n=a.target;var z,I=d.nodeName(n,"a")&&m==="click",E=d.event.special[m]||{};if((!E._default||E._default.call(g,a)===false)&&!I&&!(n&&n.nodeName&&
d.noData[n.nodeName.toLowerCase()])){try{if(n[m]){if(z=n["on"+m])n["on"+m]=null;d.event.triggered=true;n[m]()}}catch(H){}if(z)n["on"+m]=z;d.event.triggered=false}}},handle:function(a){var b,g,n,m;a=arguments[0]=d.event.fix(a||window.event);a.currentTarget=this;b=a.type.indexOf(".")<0&&!a.exclusive;if(!b){g=a.type.split(".");a.type=g.shift();n=new RegExp("(^|\\.)"+g.slice(0).sort().join("\\.(?:.*\\.)?")+"(\\.|$)")}m=d.data(this,"events");g=m[a.type];if(m&&g){g=g.slice(0);m=0;for(var y=g.length;m<y;m++){var z=
g[m];if(b||n.test(z.namespace)){a.handler=z.handler;a.data=z.data;a.handleObj=z;z=z.handler.apply(this,arguments);if(z!==undefined){a.result=z;if(z===false){a.preventDefault();a.stopPropagation()}}if(a.isImmediatePropagationStopped())break}}}return a.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),
fix:function(a){if(a[fa])return a;var b=a;a=d.Event(b);for(var g=this.props.length,n;g;){n=this.props[--g];a[n]=b[n]}if(!a.target)a.target=a.srcElement||l;if(a.target.nodeType===3)a.target=a.target.parentNode;if(!a.relatedTarget&&a.fromElement)a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement;if(a.pageX==null&&a.clientX!=null){b=l.documentElement;g=l.body;a.pageX=a.clientX+(b&&b.scrollLeft||g&&g.scrollLeft||0)-(b&&b.clientLeft||g&&g.clientLeft||0);a.pageY=a.clientY+(b&&b.scrollTop||
g&&g.scrollTop||0)-(b&&b.clientTop||g&&g.clientTop||0)}if(!a.which&&(a.charCode||a.charCode===0?a.charCode:a.keyCode))a.which=a.charCode||a.keyCode;if(!a.metaKey&&a.ctrlKey)a.metaKey=a.ctrlKey;if(!a.which&&a.button!==undefined)a.which=a.button&1?1:a.button&2?3:a.button&4?2:0;return a},guid:1E8,proxy:d.proxy,special:{ready:{setup:d.bindReady,teardown:d.noop},live:{add:function(a){d.event.add(this,a.origType,d.extend({},a,{handler:h}))},remove:function(a){var b=true,g=a.origType.replace(na,"");d.each(d.data(this,
"events").live||[],function(){if(g===this.origType.replace(na,""))return b=false});b&&d.event.remove(this,a.origType,h)}},beforeunload:{setup:function(a,b,g){if(this.setInterval)this.onbeforeunload=g;return false},teardown:function(a,b){if(this.onbeforeunload===b)this.onbeforeunload=null}}}};var Ka=l.removeEventListener?function(a,b,g){a.removeEventListener(b,g,false)}:function(a,b,g){a.detachEvent("on"+b,g)};d.Event=function(a){if(!this.preventDefault)return new d.Event(a);if(a&&a.type){this.originalEvent=
a;this.type=a.type}else this.type=a;this.timeStamp=i();this[fa]=true};d.Event.prototype={preventDefault:function(){this.isDefaultPrevented=f;var a=this.originalEvent;if(a){a.preventDefault&&a.preventDefault();a.returnValue=false}},stopPropagation:function(){this.isPropagationStopped=f;var a=this.originalEvent;if(a){a.stopPropagation&&a.stopPropagation();a.cancelBubble=true}},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=f;this.stopPropagation()},isDefaultPrevented:e,isPropagationStopped:e,
isImmediatePropagationStopped:e};var La=function(a){var b=a.relatedTarget;try{for(;b&&b!==this;)b=b.parentNode;if(b!==this){a.type=a.data;d.event.handle.apply(this,arguments)}}catch(g){}},Ma=function(a){a.type=a.data;d.event.handle.apply(this,arguments)};d.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){d.event.special[a]={setup:function(g){d.event.add(this,b,g&&g.selector?Ma:La,a)},teardown:function(g){d.event.remove(this,b,g&&g.selector?Ma:La)}}});if(!d.support.submitBubbles)d.event.special.submit=
{setup:function(){if(this.nodeName.toLowerCase()!=="form"){d.event.add(this,"click.specialSubmit",function(a){var b=a.target,g=b.type;if((g==="submit"||g==="image")&&d(b).closest("form").length)return q("submit",this,arguments)});d.event.add(this,"keypress.specialSubmit",function(a){var b=a.target,g=b.type;if((g==="text"||g==="password")&&d(b).closest("form").length&&a.keyCode===13)return q("submit",this,arguments)})}else return false},teardown:function(){d.event.remove(this,".specialSubmit")}};if(!d.support.changeBubbles){var ua=
/textarea|input|select/i,va,Na=function(a){var b=a.type,g=a.value;if(b==="radio"||b==="checkbox")g=a.checked;else if(b==="select-multiple")g=a.selectedIndex>-1?d.map(a.options,function(n){return n.selected}).join("-"):"";else if(a.nodeName.toLowerCase()==="select")g=a.selectedIndex;return g},wa=function(a,b){var g=a.target,n,m;if(!(!ua.test(g.nodeName)||g.readOnly)){n=d.data(g,"_change_data");m=Na(g);if(a.type!=="focusout"||g.type!=="radio")d.data(g,"_change_data",m);if(!(n===undefined||m===n))if(n!=
null||m){a.type="change";return d.event.trigger(a,b,g)}}};d.event.special.change={filters:{focusout:wa,click:function(a){var b=a.target,g=b.type;if(g==="radio"||g==="checkbox"||b.nodeName.toLowerCase()==="select")return wa.call(this,a)},keydown:function(a){var b=a.target,g=b.type;if(a.keyCode===13&&b.nodeName.toLowerCase()!=="textarea"||a.keyCode===32&&(g==="checkbox"||g==="radio")||g==="select-multiple")return wa.call(this,a)},beforeactivate:function(a){a=a.target;d.data(a,"_change_data",Na(a))}},
setup:function(){if(this.type==="file")return false;for(var a in va)d.event.add(this,a+".specialChange",va[a]);return ua.test(this.nodeName)},teardown:function(){d.event.remove(this,".specialChange");return ua.test(this.nodeName)}};va=d.event.special.change.filters}l.addEventListener&&d.each({focus:"focusin",blur:"focusout"},function(a,b){function g(n){n=d.event.fix(n);n.type=b;return d.event.handle.call(this,n)}d.event.special[b]={setup:function(){this.addEventListener(a,g,true)},teardown:function(){this.removeEventListener(a,
g,true)}}});d.each(["bind","one"],function(a,b){d.fn[b]=function(g,n,m){if(typeof g==="object"){for(var y in g)this[b](y,n,g[y],m);return this}if(d.isFunction(n)){m=n;n=undefined}var z=b==="one"?d.proxy(m,function(E){d(this).unbind(E,z);return m.apply(this,arguments)}):m;if(g==="unload"&&b!=="one")this.one(g,n,m);else{y=0;for(var I=this.length;y<I;y++)d.event.add(this[y],g,z,n)}return this}});d.fn.extend({unbind:function(a,b){if(typeof a==="object"&&!a.preventDefault)for(var g in a)this.unbind(g,
a[g]);else{g=0;for(var n=this.length;g<n;g++)d.event.remove(this[g],a,b)}return this},delegate:function(a,b,g,n){return this.live(b,g,n,a)},undelegate:function(a,b,g){return arguments.length===0?this.unbind("live"):this.die(b,null,g,a)},trigger:function(a,b){return this.each(function(){d.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0]){a=d.Event(a);a.preventDefault();a.stopPropagation();d.event.trigger(a,b,this[0]);return a.result}},toggle:function(a){for(var b=arguments,g=1;g<
b.length;)d.proxy(a,b[g++]);return this.click(d.proxy(a,function(n){var m=(d.data(this,"lastToggle"+a.guid)||0)%g;d.data(this,"lastToggle"+a.guid,m+1);n.preventDefault();return b[m].apply(this,arguments)||false}))},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});var Oa={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};d.each(["live","die"],function(a,b){d.fn[b]=function(g,n,m,y){var z,I=0,E,H,O=y||this.selector,R=y?this:d(this.context);if(d.isFunction(n)){m=
n;n=undefined}for(g=(g||"").split(" ");(z=g[I++])!=null;){y=na.exec(z);E="";if(y){E=y[0];z=z.replace(na,"")}if(z==="hover")g.push("mouseenter"+E,"mouseleave"+E);else{H=z;if(z==="focus"||z==="blur"){g.push(Oa[z]+E);z+=E}else z=(Oa[z]||z)+E;b==="live"?R.each(function(){d.event.add(this,k(z,O),{data:n,selector:O,handler:m,origType:z,origHandler:m,preType:H})}):R.unbind(k(z,O),m)}}return this}});d.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),
function(a,b){d.fn[b]=function(g){return g?this.bind(b,g):this.trigger(b)};if(d.attrFn)d.attrFn[b]=true});window.attachEvent&&!window.addEventListener&&window.attachEvent("onunload",function(){for(var a in d.cache)if(d.cache[a].handle)try{d.event.remove(d.cache[a].handle.elem)}catch(b){}});(function(){function a(s){for(var x="",F,G=0;s[G];G++){F=s[G];if(F.nodeType===3||F.nodeType===4)x+=F.nodeValue;else if(F.nodeType!==8)x+=a(F.childNodes)}return x}function b(s,x,F,G,N,L){N=0;for(var S=G.length;N<
S;N++){var Q=G[N];if(Q){Q=Q[s];for(var V=false;Q;){if(Q.sizcache===F){V=G[Q.sizset];break}if(Q.nodeType===1&&!L){Q.sizcache=F;Q.sizset=N}if(Q.nodeName.toLowerCase()===x){V=Q;break}Q=Q[s]}G[N]=V}}}function g(s,x,F,G,N,L){N=0;for(var S=G.length;N<S;N++){var Q=G[N];if(Q){Q=Q[s];for(var V=false;Q;){if(Q.sizcache===F){V=G[Q.sizset];break}if(Q.nodeType===1){if(!L){Q.sizcache=F;Q.sizset=N}if(typeof x!=="string"){if(Q===x){V=true;break}}else if(E.filter(x,[Q]).length>0){V=Q;break}}Q=Q[s]}G[N]=V}}}var n=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,
m=0,y=Object.prototype.toString,z=false,I=true;[0,0].sort(function(){I=false;return 0});var E=function(s,x,F,G){F=F||[];var N=x=x||l;if(x.nodeType!==1&&x.nodeType!==9)return[];if(!s||typeof s!=="string")return F;for(var L=[],S,Q,V,pa,ga=true,la=T(x),ha=s;(n.exec(""),S=n.exec(ha))!==null;){ha=S[3];L.push(S[1]);if(S[2]){pa=S[3];break}}if(L.length>1&&O.exec(s))if(L.length===2&&H.relative[L[0]])Q=xa(L[0]+L[1],x);else for(Q=H.relative[L[0]]?[x]:E(L.shift(),x);L.length;){s=L.shift();if(H.relative[s])s+=
L.shift();Q=xa(s,Q)}else{if(!G&&L.length>1&&x.nodeType===9&&!la&&H.match.ID.test(L[0])&&!H.match.ID.test(L[L.length-1])){S=E.find(L.shift(),x,la);x=S.expr?E.filter(S.expr,S.set)[0]:S.set[0]}if(x){S=G?{expr:L.pop(),set:W(G)}:E.find(L.pop(),L.length===1&&(L[0]==="~"||L[0]==="+")&&x.parentNode?x.parentNode:x,la);Q=S.expr?E.filter(S.expr,S.set):S.set;if(L.length>0)V=W(Q);else ga=false;for(;L.length;){var ca=L.pop();S=ca;if(H.relative[ca])S=L.pop();else ca="";if(S==null)S=x;H.relative[ca](V,S,la)}}else V=
[]}V||(V=Q);V||E.error(ca||s);if(y.call(V)==="[object Array]")if(ga)if(x&&x.nodeType===1)for(s=0;V[s]!=null;s++){if(V[s]&&(V[s]===true||V[s].nodeType===1&&da(x,V[s])))F.push(Q[s])}else for(s=0;V[s]!=null;s++)V[s]&&V[s].nodeType===1&&F.push(Q[s]);else F.push.apply(F,V);else W(V,F);if(pa){E(pa,N,F,G);E.uniqueSort(F)}return F};E.uniqueSort=function(s){if(Y){z=I;s.sort(Y);if(z)for(var x=1;x<s.length;x++)s[x]===s[x-1]&&s.splice(x--,1)}return s};E.matches=function(s,x){return E(s,null,null,x)};E.find=function(s,
x,F){var G,N;if(!s)return[];for(var L=0,S=H.order.length;L<S;L++){var Q=H.order[L];if(N=H.leftMatch[Q].exec(s)){var V=N[1];N.splice(1,1);if(V.substr(V.length-1)!=="\\"){N[1]=(N[1]||"").replace(/\\/g,"");G=H.find[Q](N,x,F);if(G!=null){s=s.replace(H.match[Q],"");break}}}}G||(G=x.getElementsByTagName("*"));return{set:G,expr:s}};E.filter=function(s,x,F,G){for(var N=s,L=[],S=x,Q,V,pa=x&&x[0]&&T(x[0]);s&&x.length;){for(var ga in H.filter)if((Q=H.leftMatch[ga].exec(s))!=null&&Q[2]){var la=H.filter[ga],ha,
ca;ca=Q[1];V=false;Q.splice(1,1);if(ca.substr(ca.length-1)!=="\\"){if(S===L)L=[];if(H.preFilter[ga])if(Q=H.preFilter[ga](Q,S,F,L,G,pa)){if(Q===true)continue}else V=ha=true;if(Q)for(var qa=0;(ca=S[qa])!=null;qa++)if(ca){ha=la(ca,Q,qa,S);var Pa=G^!!ha;if(F&&ha!=null)if(Pa)V=true;else S[qa]=false;else if(Pa){L.push(ca);V=true}}if(ha!==undefined){F||(S=L);s=s.replace(H.match[ga],"");if(!V)return[];break}}}if(s===N)if(V==null)E.error(s);else break;N=s}return S};E.error=function(s){throw"Syntax error, unrecognized expression: "+
s;};var H=E.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},
leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(s){return s.getAttribute("href")}},relative:{"+":function(s,x){var F=typeof x==="string",G=F&&!/\W/.test(x);F=F&&!G;if(G)x=x.toLowerCase();G=0;for(var N=s.length,L;G<N;G++)if(L=s[G]){for(;(L=L.previousSibling)&&L.nodeType!==1;);s[G]=F||L&&L.nodeName.toLowerCase()===x?L||false:L===x}F&&E.filter(x,s,true)},">":function(s,x){var F=typeof x==="string";if(F&&!/\W/.test(x)){x=x.toLowerCase();for(var G=0,N=s.length;G<N;G++){var L=
s[G];if(L){F=L.parentNode;s[G]=F.nodeName.toLowerCase()===x?F:false}}}else{G=0;for(N=s.length;G<N;G++)if(L=s[G])s[G]=F?L.parentNode:L.parentNode===x;F&&E.filter(x,s,true)}},"":function(s,x,F){var G=m++,N=g;if(typeof x==="string"&&!/\W/.test(x)){var L=x=x.toLowerCase();N=b}N("parentNode",x,G,s,L,F)},"~":function(s,x,F){var G=m++,N=g;if(typeof x==="string"&&!/\W/.test(x)){var L=x=x.toLowerCase();N=b}N("previousSibling",x,G,s,L,F)}},find:{ID:function(s,x,F){if(typeof x.getElementById!=="undefined"&&
!F)return(s=x.getElementById(s[1]))?[s]:[]},NAME:function(s,x){if(typeof x.getElementsByName!=="undefined"){var F=[];x=x.getElementsByName(s[1]);for(var G=0,N=x.length;G<N;G++)x[G].getAttribute("name")===s[1]&&F.push(x[G]);return F.length===0?null:F}},TAG:function(s,x){return x.getElementsByTagName(s[1])}},preFilter:{CLASS:function(s,x,F,G,N,L){s=" "+s[1].replace(/\\/g,"")+" ";if(L)return s;L=0;for(var S;(S=x[L])!=null;L++)if(S)if(N^(S.className&&(" "+S.className+" ").replace(/[\t\n]/g," ").indexOf(s)>=
0))F||G.push(S);else if(F)x[L]=false;return false},ID:function(s){return s[1].replace(/\\/g,"")},TAG:function(s){return s[1].toLowerCase()},CHILD:function(s){if(s[1]==="nth"){var x=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(s[2]==="even"&&"2n"||s[2]==="odd"&&"2n+1"||!/\D/.test(s[2])&&"0n+"+s[2]||s[2]);s[2]=x[1]+(x[2]||1)-0;s[3]=x[3]-0}s[0]=m++;return s},ATTR:function(s,x,F,G,N,L){x=s[1].replace(/\\/g,"");if(!L&&H.attrMap[x])s[1]=H.attrMap[x];if(s[2]==="~=")s[4]=" "+s[4]+" ";return s},PSEUDO:function(s,x,F,G,
N){if(s[1]==="not")if((n.exec(s[3])||"").length>1||/^\w/.test(s[3]))s[3]=E(s[3],null,null,x);else{s=E.filter(s[3],x,F,true^N);F||G.push.apply(G,s);return false}else if(H.match.POS.test(s[0])||H.match.CHILD.test(s[0]))return true;return s},POS:function(s){s.unshift(true);return s}},filters:{enabled:function(s){return s.disabled===false&&s.type!=="hidden"},disabled:function(s){return s.disabled===true},checked:function(s){return s.checked===true},selected:function(s){return s.selected===true},parent:function(s){return!!s.firstChild},
empty:function(s){return!s.firstChild},has:function(s,x,F){return!!E(F[3],s).length},header:function(s){return/h\d/i.test(s.nodeName)},text:function(s){return"text"===s.type},radio:function(s){return"radio"===s.type},checkbox:function(s){return"checkbox"===s.type},file:function(s){return"file"===s.type},password:function(s){return"password"===s.type},submit:function(s){return"submit"===s.type},image:function(s){return"image"===s.type},reset:function(s){return"reset"===s.type},button:function(s){return"button"===
s.type||s.nodeName.toLowerCase()==="button"},input:function(s){return/input|select|textarea|button/i.test(s.nodeName)}},setFilters:{first:function(s,x){return x===0},last:function(s,x,F,G){return x===G.length-1},even:function(s,x){return x%2===0},odd:function(s,x){return x%2===1},lt:function(s,x,F){return x<F[3]-0},gt:function(s,x,F){return x>F[3]-0},nth:function(s,x,F){return F[3]-0===x},eq:function(s,x,F){return F[3]-0===x}},filter:{PSEUDO:function(s,x,F,G){var N=x[1],L=H.filters[N];if(L)return L(s,
F,x,G);else if(N==="contains")return(s.textContent||s.innerText||a([s])||"").indexOf(x[3])>=0;else if(N==="not"){x=x[3];F=0;for(G=x.length;F<G;F++)if(x[F]===s)return false;return true}else E.error("Syntax error, unrecognized expression: "+N)},CHILD:function(s,x){var F=x[1],G=s;switch(F){case "only":case "first":for(;G=G.previousSibling;)if(G.nodeType===1)return false;if(F==="first")return true;G=s;case "last":for(;G=G.nextSibling;)if(G.nodeType===1)return false;return true;case "nth":F=x[2];var N=
x[3];if(F===1&&N===0)return true;x=x[0];var L=s.parentNode;if(L&&(L.sizcache!==x||!s.nodeIndex)){var S=0;for(G=L.firstChild;G;G=G.nextSibling)if(G.nodeType===1)G.nodeIndex=++S;L.sizcache=x}s=s.nodeIndex-N;return F===0?s===0:s%F===0&&s/F>=0}},ID:function(s,x){return s.nodeType===1&&s.getAttribute("id")===x},TAG:function(s,x){return x==="*"&&s.nodeType===1||s.nodeName.toLowerCase()===x},CLASS:function(s,x){return(" "+(s.className||s.getAttribute("class"))+" ").indexOf(x)>-1},ATTR:function(s,x){var F=
x[1];s=H.attrHandle[F]?H.attrHandle[F](s):s[F]!=null?s[F]:s.getAttribute(F);F=s+"";var G=x[2];x=x[4];return s==null?G==="!=":G==="="?F===x:G==="*="?F.indexOf(x)>=0:G==="~="?(" "+F+" ").indexOf(x)>=0:!x?F&&s!==false:G==="!="?F!==x:G==="^="?F.indexOf(x)===0:G==="$="?F.substr(F.length-x.length)===x:G==="|="?F===x||F.substr(0,x.length+1)===x+"-":false},POS:function(s,x,F,G){var N=H.setFilters[x[2]];if(N)return N(s,F,x,G)}}},O=H.match.POS;for(var R in H.match){H.match[R]=new RegExp(H.match[R].source+/(?![^\[]*\])(?![^\(]*\))/.source);
H.leftMatch[R]=new RegExp(/(^(?:.|\r|\n)*?)/.source+H.match[R].source.replace(/\\(\d+)/g,function(s,x){return"\\"+(x-0+1)}))}var W=function(s,x){s=Array.prototype.slice.call(s,0);if(x){x.push.apply(x,s);return x}return s};try{Array.prototype.slice.call(l.documentElement.childNodes,0)}catch(Z){W=function(s,x){x=x||[];if(y.call(s)==="[object Array]")Array.prototype.push.apply(x,s);else if(typeof s.length==="number")for(var F=0,G=s.length;F<G;F++)x.push(s[F]);else for(F=0;s[F];F++)x.push(s[F]);return x}}var Y;
if(l.documentElement.compareDocumentPosition)Y=function(s,x){if(!s.compareDocumentPosition||!x.compareDocumentPosition){if(s==x)z=true;return s.compareDocumentPosition?-1:1}s=s.compareDocumentPosition(x)&4?-1:s===x?0:1;if(s===0)z=true;return s};else if("sourceIndex"in l.documentElement)Y=function(s,x){if(!s.sourceIndex||!x.sourceIndex){if(s==x)z=true;return s.sourceIndex?-1:1}s=s.sourceIndex-x.sourceIndex;if(s===0)z=true;return s};else if(l.createRange)Y=function(s,x){if(!s.ownerDocument||!x.ownerDocument){if(s==
x)z=true;return s.ownerDocument?-1:1}var F=s.ownerDocument.createRange(),G=x.ownerDocument.createRange();F.setStart(s,0);F.setEnd(s,0);G.setStart(x,0);G.setEnd(x,0);s=F.compareBoundaryPoints(Range.START_TO_END,G);if(s===0)z=true;return s};(function(){var s=l.createElement("div"),x="script"+(new Date).getTime();s.innerHTML="<a name='"+x+"'/>";var F=l.documentElement;F.insertBefore(s,F.firstChild);if(l.getElementById(x)){H.find.ID=function(G,N,L){if(typeof N.getElementById!=="undefined"&&!L)return(N=
N.getElementById(G[1]))?N.id===G[1]||typeof N.getAttributeNode!=="undefined"&&N.getAttributeNode("id").nodeValue===G[1]?[N]:undefined:[]};H.filter.ID=function(G,N){var L=typeof G.getAttributeNode!=="undefined"&&G.getAttributeNode("id");return G.nodeType===1&&L&&L.nodeValue===N}}F.removeChild(s);F=s=null})();(function(){var s=l.createElement("div");s.appendChild(l.createComment(""));if(s.getElementsByTagName("*").length>0)H.find.TAG=function(x,F){F=F.getElementsByTagName(x[1]);if(x[1]==="*"){x=[];
for(var G=0;F[G];G++)F[G].nodeType===1&&x.push(F[G]);F=x}return F};s.innerHTML="<a href='#'></a>";if(s.firstChild&&typeof s.firstChild.getAttribute!=="undefined"&&s.firstChild.getAttribute("href")!=="#")H.attrHandle.href=function(x){return x.getAttribute("href",2)};s=null})();l.querySelectorAll&&function(){var s=E,x=l.createElement("div");x.innerHTML="<p class='TEST'></p>";if(!(x.querySelectorAll&&x.querySelectorAll(".TEST").length===0)){E=function(G,N,L,S){N=N||l;if(!S&&N.nodeType===9&&!T(N))try{return W(N.querySelectorAll(G),
L)}catch(Q){}return s(G,N,L,S)};for(var F in s)E[F]=s[F];x=null}}();(function(){var s=l.createElement("div");s.innerHTML="<div class='test e'></div><div class='test'></div>";if(!(!s.getElementsByClassName||s.getElementsByClassName("e").length===0)){s.lastChild.className="e";if(s.getElementsByClassName("e").length!==1){H.order.splice(1,0,"CLASS");H.find.CLASS=function(x,F,G){if(typeof F.getElementsByClassName!=="undefined"&&!G)return F.getElementsByClassName(x[1])};s=null}}})();var da=l.compareDocumentPosition?
function(s,x){return!!(s.compareDocumentPosition(x)&16)}:function(s,x){return s!==x&&(s.contains?s.contains(x):true)},T=function(s){return(s=(s?s.ownerDocument||s:0).documentElement)?s.nodeName!=="HTML":false},xa=function(s,x){var F=[],G="",N;for(x=x.nodeType?[x]:x;N=H.match.PSEUDO.exec(s);){G+=N[0];s=s.replace(H.match.PSEUDO,"")}s=H.relative[s]?s+"*":s;N=0;for(var L=x.length;N<L;N++)E(s,x[N],F);return E.filter(G,F)};d.find=E;d.expr=E.selectors;d.expr[":"]=d.expr.filters;d.unique=E.uniqueSort;d.text=
a;d.isXMLDoc=T;d.contains=da})();var eb=/Until$/,fb=/^(?:parents|prevUntil|prevAll)/,gb=/,/;oa=Array.prototype.slice;var Qa=function(a,b,g){if(d.isFunction(b))return d.grep(a,function(m,y){return!!b.call(m,y,m)===g});else if(b.nodeType)return d.grep(a,function(m){return m===b===g});else if(typeof b==="string"){var n=d.grep(a,function(m){return m.nodeType===1});if(K.test(b))return d.filter(b,n,!g);else b=d.filter(b,n)}return d.grep(a,function(m){return d.inArray(m,b)>=0===g})};d.fn.extend({find:function(a){for(var b=
this.pushStack("","find",a),g=0,n=0,m=this.length;n<m;n++){g=b.length;d.find(a,this[n],b);if(n>0)for(var y=g;y<b.length;y++)for(var z=0;z<g;z++)if(b[z]===b[y]){b.splice(y--,1);break}}return b},has:function(a){var b=d(a);return this.filter(function(){for(var g=0,n=b.length;g<n;g++)if(d.contains(this,b[g]))return true})},not:function(a){return this.pushStack(Qa(this,a,false),"not",a)},filter:function(a){return this.pushStack(Qa(this,a,true),"filter",a)},is:function(a){return!!a&&d.filter(a,this).length>
0},closest:function(a,b){if(d.isArray(a)){var g=[],n=this[0],m,y={},z;if(n&&a.length){m=0;for(var I=a.length;m<I;m++){z=a[m];y[z]||(y[z]=d.expr.match.POS.test(z)?d(z,b||this.context):z)}for(;n&&n.ownerDocument&&n!==b;){for(z in y){m=y[z];if(m.jquery?m.index(n)>-1:d(n).is(m)){g.push({selector:z,elem:n});delete y[z]}}n=n.parentNode}}return g}var E=d.expr.match.POS.test(a)?d(a,b||this.context):null;return this.map(function(H,O){for(;O&&O.ownerDocument&&O!==b;){if(E?E.index(O)>-1:d(O).is(a))return O;
O=O.parentNode}return null})},index:function(a){if(!a||typeof a==="string")return d.inArray(this[0],a?d(a):this.parent().children());return d.inArray(a.jquery?a[0]:a,this)},add:function(a,b){a=typeof a==="string"?d(a,b||this.context):d.makeArray(a);b=d.merge(this.get(),a);return this.pushStack(j(a[0])||j(b[0])?b:d.unique(b))},andSelf:function(){return this.add(this.prevObject)}});d.each({parent:function(a){return(a=a.parentNode)&&a.nodeType!==11?a:null},parents:function(a){return d.dir(a,"parentNode")},
parentsUntil:function(a,b,g){return d.dir(a,"parentNode",g)},next:function(a){return d.nth(a,2,"nextSibling")},prev:function(a){return d.nth(a,2,"previousSibling")},nextAll:function(a){return d.dir(a,"nextSibling")},prevAll:function(a){return d.dir(a,"previousSibling")},nextUntil:function(a,b,g){return d.dir(a,"nextSibling",g)},prevUntil:function(a,b,g){return d.dir(a,"previousSibling",g)},siblings:function(a){return d.sibling(a.parentNode.firstChild,a)},children:function(a){return d.sibling(a.firstChild)},
contents:function(a){return d.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:d.makeArray(a.childNodes)}},function(a,b){d.fn[a]=function(g,n){var m=d.map(this,b,g);eb.test(a)||(n=g);if(n&&typeof n==="string")m=d.filter(n,m);m=this.length>1?d.unique(m):m;if((this.length>1||gb.test(n))&&fb.test(a))m=m.reverse();return this.pushStack(m,a,oa.call(arguments).join(","))}});d.extend({filter:function(a,b,g){if(g)a=":not("+a+")";return d.find.matches(a,b)},dir:function(a,b,g){var n=[];for(a=
a[b];a&&a.nodeType!==9&&(g===undefined||a.nodeType!==1||!d(a).is(g));){a.nodeType===1&&n.push(a);a=a[b]}return n},nth:function(a,b,g){b=b||1;for(var n=0;a;a=a[g])if(a.nodeType===1&&++n===b)break;return a},sibling:function(a,b){for(var g=[];a;a=a.nextSibling)a.nodeType===1&&a!==b&&g.push(a);return g}});var Ra=/ jQuery\d+="(?:\d+|null)"/g,ra=/^\s+/,Sa=/(<([\w:]+)[^>]*?)\/>/g,hb=/^(?:area|br|col|embed|hr|img|input|link|meta|param)$/i,Ta=/<([\w:]+)/,ib=/<tbody/i,jb=/<|&#?\w+;/,Da=/<script|<object|<embed|<option|<style/i,
Ea=/checked\s*(?:[^=]|=\s*.checked.)/i,Ua=function(a,b,g){return hb.test(g)?a:b+"></"+g+">"},ea={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};ea.optgroup=ea.option;ea.tbody=ea.tfoot=ea.colgroup=ea.caption=ea.thead;ea.th=
ea.td;if(!d.support.htmlSerialize)ea._default=[1,"div<div>","</div>"];d.fn.extend({text:function(a){if(d.isFunction(a))return this.each(function(b){var g=d(this);g.text(a.call(this,b,g.text()))});if(typeof a!=="object"&&a!==undefined)return this.empty().append((this[0]&&this[0].ownerDocument||l).createTextNode(a));return d.text(this)},wrapAll:function(a){if(d.isFunction(a))return this.each(function(g){d(this).wrapAll(a.call(this,g))});if(this[0]){var b=d(a,this[0].ownerDocument).eq(0).clone(true);
this[0].parentNode&&b.insertBefore(this[0]);b.map(function(){for(var g=this;g.firstChild&&g.firstChild.nodeType===1;)g=g.firstChild;return g}).append(this)}return this},wrapInner:function(a){if(d.isFunction(a))return this.each(function(b){d(this).wrapInner(a.call(this,b))});return this.each(function(){var b=d(this),g=b.contents();g.length?g.wrapAll(a):b.append(a)})},wrap:function(a){return this.each(function(){d(this).wrapAll(a)})},unwrap:function(){return this.parent().each(function(){d.nodeName(this,
"body")||d(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,true,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,true,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,false,function(b){this.parentNode.insertBefore(b,this)});else if(arguments.length){var a=d(arguments[0]);a.push.apply(a,this.toArray());
return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,false,function(b){this.parentNode.insertBefore(b,this.nextSibling)});else if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,d(arguments[0]).toArray());return a}},remove:function(a,b){for(var g=0,n;(n=this[g])!=null;g++)if(!a||d.filter(a,[n]).length){if(!b&&n.nodeType===1){d.cleanData(n.getElementsByTagName("*"));d.cleanData([n])}n.parentNode&&
n.parentNode.removeChild(n)}return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++)for(b.nodeType===1&&d.cleanData(b.getElementsByTagName("*"));b.firstChild;)b.removeChild(b.firstChild);return this},clone:function(a){var b=this.map(function(){if(!d.support.noCloneEvent&&!d.isXMLDoc(this)){var g=this.outerHTML,n=this.ownerDocument;if(!g){g=n.createElement("div");g.appendChild(this.cloneNode(true));g=g.innerHTML}return d.clean([g.replace(Ra,"").replace(/=([^="'>\s]+\/)>/g,'="$1">').replace(ra,
"")],n)[0]}else return this.cloneNode(true)});if(a===true){p(this,b);p(this.find("*"),b.find("*"))}return b},html:function(a){if(a===undefined)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(Ra,""):null;else if(typeof a==="string"&&!Da.test(a)&&(d.support.leadingWhitespace||!ra.test(a))&&!ea[(Ta.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Sa,Ua);try{for(var b=0,g=this.length;b<g;b++)if(this[b].nodeType===1){d.cleanData(this[b].getElementsByTagName("*"));this[b].innerHTML=a}}catch(n){this.empty().append(a)}}else d.isFunction(a)?
this.each(function(m){var y=d(this),z=y.html();y.empty().append(function(){return a.call(this,m,z)})}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(d.isFunction(a))return this.each(function(b){var g=d(this),n=g.html();g.replaceWith(a.call(this,b,n))});if(typeof a!=="string")a=d(a).detach();return this.each(function(){var b=this.nextSibling,g=this.parentNode;d(this).remove();b?d(b).before(a):d(g).append(a)})}else return this.pushStack(d(d.isFunction(a)?
a():a),"replaceWith",a)},detach:function(a){return this.remove(a,true)},domManip:function(a,b,g){function n(R){return d.nodeName(R,"table")?R.getElementsByTagName("tbody")[0]||R.appendChild(R.ownerDocument.createElement("tbody")):R}var m,y,z=a[0],I=[],E;if(!d.support.checkClone&&arguments.length===3&&typeof z==="string"&&Ea.test(z))return this.each(function(){d(this).domManip(a,b,g,true)});if(d.isFunction(z))return this.each(function(R){var W=d(this);a[0]=z.call(this,R,b?W.html():undefined);W.domManip(a,
b,g)});if(this[0]){m=z&&z.parentNode;m=d.support.parentNode&&m&&m.nodeType===11&&m.childNodes.length===this.length?{fragment:m}:t(a,this,I);E=m.fragment;if(y=E.childNodes.length===1?(E=E.firstChild):E.firstChild){b=b&&d.nodeName(y,"tr");for(var H=0,O=this.length;H<O;H++)g.call(b?n(this[H],y):this[H],H>0||m.cacheable||this.length>1?E.cloneNode(true):E)}I.length&&d.each(I,r)}return this}});d.fragments={};d.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},
function(a,b){d.fn[a]=function(g){var n=[];g=d(g);var m=this.length===1&&this[0].parentNode;if(m&&m.nodeType===11&&m.childNodes.length===1&&g.length===1){g[b](this[0]);return this}else{m=0;for(var y=g.length;m<y;m++){var z=(m>0?this.clone(true):this).get();d.fn[b].apply(d(g[m]),z);n=n.concat(z)}return this.pushStack(n,a,g.selector)}}});d.extend({clean:function(a,b,g,n){b=b||l;if(typeof b.createElement==="undefined")b=b.ownerDocument||b[0]&&b[0].ownerDocument||l;for(var m=[],y=0,z;(z=a[y])!=null;y++){if(typeof z===
"number")z+="";if(z){if(typeof z==="string"&&!jb.test(z))z=b.createTextNode(z);else if(typeof z==="string"){z=z.replace(Sa,Ua);var I=(Ta.exec(z)||["",""])[1].toLowerCase(),E=ea[I]||ea._default,H=E[0],O=b.createElement("div");for(O.innerHTML=E[1]+z+E[2];H--;)O=O.lastChild;if(!d.support.tbody){H=ib.test(z);I=I==="table"&&!H?O.firstChild&&O.firstChild.childNodes:E[1]==="<table>"&&!H?O.childNodes:[];for(E=I.length-1;E>=0;--E)d.nodeName(I[E],"tbody")&&!I[E].childNodes.length&&I[E].parentNode.removeChild(I[E])}!d.support.leadingWhitespace&&
ra.test(z)&&O.insertBefore(b.createTextNode(ra.exec(z)[0]),O.firstChild);z=O.childNodes}if(z.nodeType)m.push(z);else m=d.merge(m,z)}}if(g)for(y=0;m[y];y++)if(n&&d.nodeName(m[y],"script")&&(!m[y].type||m[y].type.toLowerCase()==="text/javascript"))n.push(m[y].parentNode?m[y].parentNode.removeChild(m[y]):m[y]);else{m[y].nodeType===1&&m.splice.apply(m,[y+1,0].concat(d.makeArray(m[y].getElementsByTagName("script"))));g.appendChild(m[y])}return m},cleanData:function(a){for(var b,g,n=d.cache,m=d.event.special,
y=d.support.deleteExpando,z=0,I;(I=a[z])!=null;z++)if(g=I[d.expando]){b=n[g];if(b.events)for(var E in b.events)m[E]?d.event.remove(I,E):Ka(I,E,b.handle);if(y)delete I[d.expando];else I.removeAttribute&&I.removeAttribute(d.expando);delete n[g]}}});var kb=/z-?index|font-?weight|opacity|zoom|line-?height/i,Va=/alpha\([^)]*\)/,Wa=/opacity=([^)]*)/,ya=/float/i,za=/-([a-z])/ig,lb=/([A-Z])/g,mb=/^-?\d+(?:px)?$/i,nb=/^-?\d/,ob={position:"absolute",visibility:"hidden",display:"block"},pb=["Left","Right"],
qb=["Top","Bottom"],rb=l.defaultView&&l.defaultView.getComputedStyle,Xa=d.support.cssFloat?"cssFloat":"styleFloat",Aa=function(a,b){return b.toUpperCase()};d.fn.css=function(a,b){return o(this,a,b,true,function(g,n,m){if(m===undefined)return d.curCSS(g,n);if(typeof m==="number"&&!kb.test(n))m+="px";d.style(g,n,m)})};d.extend({style:function(a,b,g){if(!(!a||a.nodeType===3||a.nodeType===8)){if((b==="width"||b==="height")&&parseFloat(g)<0)g=undefined;var n=a.style||a,m=g!==undefined;if(!d.support.opacity&&
b==="opacity"){if(m){n.zoom=1;b=parseInt(g,10)+""==="NaN"?"":"alpha(opacity="+g*100+")";a=n.filter||d.curCSS(a,"filter")||"";n.filter=Va.test(a)?a.replace(Va,b):b}return n.filter&&n.filter.indexOf("opacity=")>=0?parseFloat(Wa.exec(n.filter)[1])/100+"":""}if(ya.test(b))b=Xa;b=b.replace(za,Aa);if(m)n[b]=g;return n[b]}},css:function(a,b,g,n){if(b==="width"||b==="height"){var m,y=b==="width"?pb:qb;g=function(){m=b==="width"?a.offsetWidth:a.offsetHeight;n!=="border"&&d.each(y,function(){n||(m-=parseFloat(d.curCSS(a,
"padding"+this,true))||0);if(n==="margin")m+=parseFloat(d.curCSS(a,"margin"+this,true))||0;else m-=parseFloat(d.curCSS(a,"border"+this+"Width",true))||0})};a.offsetWidth!==0?g():d.swap(a,ob,g);return Math.max(0,Math.round(m))}return d.curCSS(a,b,g)},curCSS:function(a,b,g){var n,m=a.style;if(!d.support.opacity&&b==="opacity"&&a.currentStyle){n=Wa.test(a.currentStyle.filter||"")?parseFloat(RegExp.$1)/100+"":"";return n===""?"1":n}if(ya.test(b))b=Xa;if(!g&&m&&m[b])n=m[b];else if(rb){if(ya.test(b))b=
"float";b=b.replace(lb,"-$1").toLowerCase();m=a.ownerDocument.defaultView;if(!m)return null;if(a=m.getComputedStyle(a,null))n=a.getPropertyValue(b);if(b==="opacity"&&n==="")n="1"}else if(a.currentStyle){g=b.replace(za,Aa);n=a.currentStyle[b]||a.currentStyle[g];if(!mb.test(n)&&nb.test(n)){b=m.left;var y=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;m.left=g==="fontSize"?"1em":n||0;n=m.pixelLeft+"px";m.left=b;a.runtimeStyle.left=y}}return n},swap:function(a,b,g){var n={};for(var m in b){n[m]=
a.style[m];a.style[m]=b[m]}g.call(a);for(m in b)a.style[m]=n[m]}});if(d.expr&&d.expr.filters){d.expr.filters.hidden=function(a){var b=a.offsetWidth,g=a.offsetHeight,n=a.nodeName.toLowerCase()==="tr";return b===0&&g===0&&!n?true:b>0&&g>0&&!n?false:d.curCSS(a,"display")==="none"};d.expr.filters.visible=function(a){return!d.expr.filters.hidden(a)}}var sb=i(),tb=/<script(.|\s)*?\/script>/gi,ub=/select|textarea/i,vb=/color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week/i,
ma=/=\?(&|$)/,Ba=/\?/,wb=/(\?|&)_=.*?(&|$)/,xb=/^(\w+:)?\/\/([^\/?#]+)/,yb=/%20/g,zb=d.fn.load;d.fn.extend({load:function(a,b,g){if(typeof a!=="string")return zb.call(this,a);else if(!this.length)return this;var n=a.indexOf(" ");if(n>=0){var m=a.slice(n,a.length);a=a.slice(0,n)}n="GET";if(b)if(d.isFunction(b)){g=b;b=null}else if(typeof b==="object"){b=d.param(b,d.ajaxSettings.traditional);n="POST"}var y=this;d.ajax({url:a,type:n,dataType:"html",data:b,complete:function(z,I){if(I==="success"||I===
"notmodified")y.html(m?d("<div />").append(z.responseText.replace(tb,"")).find(m):z.responseText);g&&y.each(g,[z.responseText,I,z])}});return this},serialize:function(){return d.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?d.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||ub.test(this.nodeName)||vb.test(this.type))}).map(function(a,b){a=d(this).val();return a==null?null:d.isArray(a)?d.map(a,
function(g){return{name:b.name,value:g}}):{name:b.name,value:a}}).get()}});d.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){d.fn[b]=function(g){return this.bind(b,g)}});d.extend({get:function(a,b,g,n){if(d.isFunction(b)){n=n||g;g=b;b=null}return d.ajax({type:"GET",url:a,data:b,success:g,dataType:n})},getScript:function(a,b){return d.get(a,null,b,"script")},getJSON:function(a,b,g){return d.get(a,b,g,"json")},post:function(a,b,g,n){if(d.isFunction(b)){n=
n||g;g=b;b={}}return d.ajax({type:"POST",url:a,data:b,success:g,dataType:n})},ajaxSetup:function(a){d.extend(d.ajaxSettings,a)},ajaxSettings:{url:location.href,global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,xhr:window.XMLHttpRequest&&(window.location.protocol!=="file:"||!window.ActiveXObject)?function(){return new window.XMLHttpRequest}:function(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(a){}},accepts:{xml:"application/xml, text/xml",
html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},lastModified:{},etag:{},ajax:function(a){function b(){m.success&&m.success.call(E,I,z,T);m.global&&n("ajaxSuccess",[T,m])}function g(){m.complete&&m.complete.call(E,T,z);m.global&&n("ajaxComplete",[T,m]);m.global&&!--d.active&&d.event.trigger("ajaxStop")}function n(N,L){(m.context?d(m.context):d.event).trigger(N,L)}var m=d.extend(true,{},d.ajaxSettings,a),y,
z,I,E=a&&a.context||m,H=m.type.toUpperCase();if(m.data&&m.processData&&typeof m.data!=="string")m.data=d.param(m.data,m.traditional);if(m.dataType==="jsonp"){if(H==="GET")ma.test(m.url)||(m.url+=(Ba.test(m.url)?"&":"?")+(m.jsonp||"callback")+"=?");else if(!m.data||!ma.test(m.data))m.data=(m.data?m.data+"&":"")+(m.jsonp||"callback")+"=?";m.dataType="json"}if(m.dataType==="json"&&(m.data&&ma.test(m.data)||ma.test(m.url))){y=m.jsonpCallback||"jsonp"+sb++;if(m.data)m.data=(m.data+"").replace(ma,"="+y+
"$1");m.url=m.url.replace(ma,"="+y+"$1");m.dataType="script";window[y]=window[y]||function(N){I=N;b();g();window[y]=undefined;try{delete window[y]}catch(L){}W&&W.removeChild(Z)}}if(m.dataType==="script"&&m.cache===null)m.cache=false;if(m.cache===false&&H==="GET"){var O=i(),R=m.url.replace(wb,"$1_="+O+"$2");m.url=R+(R===m.url?(Ba.test(m.url)?"&":"?")+"_="+O:"")}if(m.data&&H==="GET")m.url+=(Ba.test(m.url)?"&":"?")+m.data;m.global&&!d.active++&&d.event.trigger("ajaxStart");O=(O=xb.exec(m.url))&&(O[1]&&
O[1]!==location.protocol||O[2]!==location.host);if(m.dataType==="script"&&H==="GET"&&O){var W=l.getElementsByTagName("head")[0]||l.documentElement,Z=l.createElement("script");Z.src=m.url;if(m.scriptCharset)Z.charset=m.scriptCharset;if(!y){var Y=false;Z.onload=Z.onreadystatechange=function(){if(!Y&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){Y=true;b();g();Z.onload=Z.onreadystatechange=null;W&&Z.parentNode&&W.removeChild(Z)}}}W.insertBefore(Z,W.firstChild)}else{var da=
false,T=m.xhr();if(T){m.username?T.open(H,m.url,m.async,m.username,m.password):T.open(H,m.url,m.async);try{if(m.data||a&&a.contentType)T.setRequestHeader("Content-Type",m.contentType);if(m.ifModified){d.lastModified[m.url]&&T.setRequestHeader("If-Modified-Since",d.lastModified[m.url]);d.etag[m.url]&&T.setRequestHeader("If-None-Match",d.etag[m.url])}O||T.setRequestHeader("X-Requested-With","XMLHttpRequest");T.setRequestHeader("Accept",m.dataType&&m.accepts[m.dataType]?m.accepts[m.dataType]+", */*":
m.accepts._default)}catch(xa){}if(m.beforeSend&&m.beforeSend.call(E,T,m)===false){m.global&&!--d.active&&d.event.trigger("ajaxStop");T.abort();return false}m.global&&n("ajaxSend",[T,m]);var s=T.onreadystatechange=function(N){if(!T||T.readyState===0||N==="abort"){da||g();da=true;if(T)T.onreadystatechange=d.noop}else if(!da&&T&&(T.readyState===4||N==="timeout")){da=true;T.onreadystatechange=d.noop;z=N==="timeout"?"timeout":!d.httpSuccess(T)?"error":m.ifModified&&d.httpNotModified(T,m.url)?"notmodified":
"success";var L;if(z==="success")try{I=d.httpData(T,m.dataType,m)}catch(S){z="parsererror";L=S}if(z==="success"||z==="notmodified")y||b();else d.handleError(m,T,z,L);g();N==="timeout"&&T.abort();if(m.async)T=null}};try{var x=T.abort;T.abort=function(){T&&x.call(T);s("abort")}}catch(F){}m.async&&m.timeout>0&&setTimeout(function(){T&&!da&&s("timeout")},m.timeout);try{T.send(H==="POST"||H==="PUT"||H==="DELETE"?m.data:null)}catch(G){d.handleError(m,T,null,G);g()}m.async||s();return T}}},handleError:function(a,
b,g,n){if(a.error)a.error.call(a.context||a,b,g,n);if(a.global)(a.context?d(a.context):d.event).trigger("ajaxError",[b,a,n])},active:0,httpSuccess:function(a){try{return!a.status&&location.protocol==="file:"||a.status>=200&&a.status<300||a.status===304||a.status===1223||a.status===0}catch(b){}return false},httpNotModified:function(a,b){var g=a.getResponseHeader("Last-Modified"),n=a.getResponseHeader("Etag");if(g)d.lastModified[b]=g;if(n)d.etag[b]=n;return a.status===304||a.status===0},httpData:function(a,
b,g){var n=a.getResponseHeader("content-type")||"",m=b==="xml"||!b&&n.indexOf("xml")>=0;a=m?a.responseXML:a.responseText;m&&a.documentElement.nodeName==="parsererror"&&d.error("parsererror");if(g&&g.dataFilter)a=g.dataFilter(a,b);if(typeof a==="string")if(b==="json"||!b&&n.indexOf("json")>=0)a=d.parseJSON(a);else if(b==="script"||!b&&n.indexOf("javascript")>=0)d.globalEval(a);return a},param:function(a,b){function g(z,I){if(d.isArray(I))d.each(I,function(E,H){b||/\[\]$/.test(z)?n(z,H):g(z+"["+(typeof H===
"object"||d.isArray(H)?E:"")+"]",H)});else!b&&I!=null&&typeof I==="object"?d.each(I,function(E,H){g(z+"["+E+"]",H)}):n(z,I)}function n(z,I){I=d.isFunction(I)?I():I;m[m.length]=encodeURIComponent(z)+"="+encodeURIComponent(I)}var m=[];if(b===undefined)b=d.ajaxSettings.traditional;if(d.isArray(a)||a.jquery)d.each(a,function(){n(this.name,this.value)});else for(var y in a)g(y,a[y]);return m.join("&").replace(yb,"+")}});var Ca={},Ab=/toggle|show|hide/,Bb=/^([+-]=)?([\d+-.]+)(.*)$/,sa,Fa=[["height","marginTop",
"marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];d.fn.extend({show:function(a,b){if(a||a===0)return this.animate(B("show",3),a,b);else{a=0;for(b=this.length;a<b;a++){var g=d.data(this[a],"olddisplay");this[a].style.display=g||"";if(d.css(this[a],"display")==="none"){g=this[a].nodeName;var n;if(Ca[g])n=Ca[g];else{var m=d("<"+g+" />").appendTo("body");n=m.css("display");if(n==="none")n="block";m.remove();Ca[g]=n}d.data(this[a],
"olddisplay",n)}}a=0;for(b=this.length;a<b;a++)this[a].style.display=d.data(this[a],"olddisplay")||"";return this}},hide:function(a,b){if(a||a===0)return this.animate(B("hide",3),a,b);else{a=0;for(b=this.length;a<b;a++){var g=d.data(this[a],"olddisplay");!g&&g!=="none"&&d.data(this[a],"olddisplay",d.css(this[a],"display"))}a=0;for(b=this.length;a<b;a++)this[a].style.display="none";return this}},_toggle:d.fn.toggle,toggle:function(a,b){var g=typeof a==="boolean";if(d.isFunction(a)&&d.isFunction(b))this._toggle.apply(this,
arguments);else a==null||g?this.each(function(){var n=g?a:d(this).is(":hidden");d(this)[n?"show":"hide"]()}):this.animate(B("toggle",3),a,b);return this},fadeTo:function(a,b,g){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,g)},animate:function(a,b,g,n){var m=d.speed(b,g,n);if(d.isEmptyObject(a))return this.each(m.complete);return this[m.queue===false?"each":"queue"](function(){var y=d.extend({},m),z,I=this.nodeType===1&&d(this).is(":hidden"),E=this;for(z in a){var H=
z.replace(za,Aa);if(z!==H){a[H]=a[z];delete a[z];z=H}if(a[z]==="hide"&&I||a[z]==="show"&&!I)return y.complete.call(this);if((z==="height"||z==="width")&&this.style){y.display=d.css(this,"display");y.overflow=this.style.overflow}if(d.isArray(a[z])){(y.specialEasing=y.specialEasing||{})[z]=a[z][1];a[z]=a[z][0]}}if(y.overflow!=null)this.style.overflow="hidden";y.curAnim=d.extend({},a);d.each(a,function(O,R){var W=new d.fx(E,y,O);if(Ab.test(R))W[R==="toggle"?I?"show":"hide":R](a);else{var Z=Bb.exec(R),
Y=W.cur(true)||0;if(Z){R=parseFloat(Z[2]);var da=Z[3]||"px";if(da!=="px"){E.style[O]=(R||1)+da;Y=(R||1)/W.cur(true)*Y;E.style[O]=Y+da}if(Z[1])R=(Z[1]==="-="?-1:1)*R+Y;W.custom(Y,R,da)}else W.custom(Y,R,"")}});return true})},stop:function(a,b){var g=d.timers;a&&this.queue([]);this.each(function(){for(var n=g.length-1;n>=0;n--)if(g[n].elem===this){b&&g[n](true);g.splice(n,1)}});b||this.dequeue();return this}});d.each({slideDown:B("show",1),slideUp:B("hide",1),slideToggle:B("toggle",1),fadeIn:{opacity:"show"},
fadeOut:{opacity:"hide"}},function(a,b){d.fn[a]=function(g,n){return this.animate(b,g,n)}});d.extend({speed:function(a,b,g){var n=a&&typeof a==="object"?a:{complete:g||!g&&b||d.isFunction(a)&&a,duration:a,easing:g&&b||b&&!d.isFunction(b)&&b};n.duration=d.fx.off?0:typeof n.duration==="number"?n.duration:d.fx.speeds[n.duration]||d.fx.speeds._default;n.old=n.complete;n.complete=function(){n.queue!==false&&d(this).dequeue();d.isFunction(n.old)&&n.old.call(this)};return n},easing:{linear:function(a,b,
g,n){return g+n*a},swing:function(a,b,g,n){return(-Math.cos(a*Math.PI)/2+0.5)*n+g}},timers:[],fx:function(a,b,g){this.options=b;this.elem=a;this.prop=g;if(!b.orig)b.orig={}}});d.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this);(d.fx.step[this.prop]||d.fx.step._default)(this);if((this.prop==="height"||this.prop==="width")&&this.elem.style)this.elem.style.display="block"},cur:function(a){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==
null))return this.elem[this.prop];return(a=parseFloat(d.css(this.elem,this.prop,a)))&&a>-10000?a:parseFloat(d.curCSS(this.elem,this.prop))||0},custom:function(a,b,g){function n(y){return m.step(y)}this.startTime=i();this.start=a;this.end=b;this.unit=g||this.unit||"px";this.now=this.start;this.pos=this.state=0;var m=this;n.elem=this.elem;if(n()&&d.timers.push(n)&&!sa)sa=setInterval(d.fx.tick,13)},show:function(){this.options.orig[this.prop]=d.style(this.elem,this.prop);this.options.show=true;this.custom(this.prop===
"width"||this.prop==="height"?1:0,this.cur());d(this.elem).show()},hide:function(){this.options.orig[this.prop]=d.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(a){var b=i(),g=true;if(a||b>=this.options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();this.options.curAnim[this.prop]=true;for(var n in this.options.curAnim)if(this.options.curAnim[n]!==true)g=false;if(g){if(this.options.display!=null){this.elem.style.overflow=
this.options.overflow;a=d.data(this.elem,"olddisplay");this.elem.style.display=a?a:this.options.display;if(d.css(this.elem,"display")==="none")this.elem.style.display="block"}this.options.hide&&d(this.elem).hide();if(this.options.hide||this.options.show)for(var m in this.options.curAnim)d.style(this.elem,m,this.options.orig[m]);this.options.complete.call(this.elem)}return false}else{m=b-this.startTime;this.state=m/this.options.duration;a=this.options.easing||(d.easing.swing?"swing":"linear");this.pos=
d.easing[this.options.specialEasing&&this.options.specialEasing[this.prop]||a](this.state,m,0,1,this.options.duration);this.now=this.start+(this.end-this.start)*this.pos;this.update()}return true}};d.extend(d.fx,{tick:function(){for(var a=d.timers,b=0;b<a.length;b++)a[b]()||a.splice(b--,1);a.length||d.fx.stop()},stop:function(){clearInterval(sa);sa=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){d.style(a.elem,"opacity",a.now)},_default:function(a){if(a.elem.style&&a.elem.style[a.prop]!=
null)a.elem.style[a.prop]=(a.prop==="width"||a.prop==="height"?Math.max(0,a.now):a.now)+a.unit;else a.elem[a.prop]=a.now}}});if(d.expr&&d.expr.filters)d.expr.filters.animated=function(a){return d.grep(d.timers,function(b){return a===b.elem}).length};d.fn.offset="getBoundingClientRect"in l.documentElement?function(a){var b=this[0];if(a)return this.each(function(m){d.offset.setOffset(this,a,m)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return d.offset.bodyOffset(b);var g=b.getBoundingClientRect(),
n=b.ownerDocument;b=n.body;n=n.documentElement;return{top:g.top+(self.pageYOffset||d.support.boxModel&&n.scrollTop||b.scrollTop)-(n.clientTop||b.clientTop||0),left:g.left+(self.pageXOffset||d.support.boxModel&&n.scrollLeft||b.scrollLeft)-(n.clientLeft||b.clientLeft||0)}}:function(a){var b=this[0];if(a)return this.each(function(O){d.offset.setOffset(this,a,O)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return d.offset.bodyOffset(b);d.offset.initialize();var g=b.offsetParent,n=
b,m=b.ownerDocument,y,z=m.documentElement,I=m.body;n=(m=m.defaultView)?m.getComputedStyle(b,null):b.currentStyle;for(var E=b.offsetTop,H=b.offsetLeft;(b=b.parentNode)&&b!==I&&b!==z;){if(d.offset.supportsFixedPosition&&n.position==="fixed")break;y=m?m.getComputedStyle(b,null):b.currentStyle;E-=b.scrollTop;H-=b.scrollLeft;if(b===g){E+=b.offsetTop;H+=b.offsetLeft;if(d.offset.doesNotAddBorder&&!(d.offset.doesAddBorderForTableAndCells&&/^t(able|d|h)$/i.test(b.nodeName))){E+=parseFloat(y.borderTopWidth)||
0;H+=parseFloat(y.borderLeftWidth)||0}n=g;g=b.offsetParent}if(d.offset.subtractsBorderForOverflowNotVisible&&y.overflow!=="visible"){E+=parseFloat(y.borderTopWidth)||0;H+=parseFloat(y.borderLeftWidth)||0}n=y}if(n.position==="relative"||n.position==="static"){E+=I.offsetTop;H+=I.offsetLeft}if(d.offset.supportsFixedPosition&&n.position==="fixed"){E+=Math.max(z.scrollTop,I.scrollTop);H+=Math.max(z.scrollLeft,I.scrollLeft)}return{top:E,left:H}};d.offset={initialize:function(){var a=l.body,b=l.createElement("div"),
g,n,m,y=parseFloat(d.curCSS(a,"marginTop",true))||0;d.extend(b.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"});b.innerHTML="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";a.insertBefore(b,a.firstChild);
g=b.firstChild;n=g.firstChild;m=g.nextSibling.firstChild.firstChild;this.doesNotAddBorder=n.offsetTop!==5;this.doesAddBorderForTableAndCells=m.offsetTop===5;n.style.position="fixed";n.style.top="20px";this.supportsFixedPosition=n.offsetTop===20||n.offsetTop===15;n.style.position=n.style.top="";g.style.overflow="hidden";g.style.position="relative";this.subtractsBorderForOverflowNotVisible=n.offsetTop===-5;this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==y;a.removeChild(b);d.offset.initialize=d.noop},
bodyOffset:function(a){var b=a.offsetTop,g=a.offsetLeft;d.offset.initialize();if(d.offset.doesNotIncludeMarginInBodyOffset){b+=parseFloat(d.curCSS(a,"marginTop",true))||0;g+=parseFloat(d.curCSS(a,"marginLeft",true))||0}return{top:b,left:g}},setOffset:function(a,b,g){if(/static/.test(d.curCSS(a,"position")))a.style.position="relative";var n=d(a),m=n.offset(),y=parseInt(d.curCSS(a,"top",true),10)||0,z=parseInt(d.curCSS(a,"left",true),10)||0;if(d.isFunction(b))b=b.call(a,g,m);g={top:b.top-m.top+y,left:b.left-
m.left+z};"using"in b?b.using.call(a,g):n.css(g)}};d.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),g=this.offset(),n=/^body|html$/i.test(b[0].nodeName)?{top:0,left:0}:b.offset();g.top-=parseFloat(d.curCSS(a,"marginTop",true))||0;g.left-=parseFloat(d.curCSS(a,"marginLeft",true))||0;n.top+=parseFloat(d.curCSS(b[0],"borderTopWidth",true))||0;n.left+=parseFloat(d.curCSS(b[0],"borderLeftWidth",true))||0;return{top:g.top-n.top,left:g.left-n.left}},offsetParent:function(){return this.map(function(){for(var a=
this.offsetParent||l.body;a&&!/^body|html$/i.test(a.nodeName)&&d.css(a,"position")==="static";)a=a.offsetParent;return a})}});d.each(["Left","Top"],function(a,b){var g="scroll"+b;d.fn[g]=function(n){var m=this[0],y;if(!m)return null;if(n!==undefined)return this.each(function(){if(y=C(this))y.scrollTo(!a?n:d(y).scrollLeft(),a?n:d(y).scrollTop());else this[g]=n});else return(y=C(m))?"pageXOffset"in y?y[a?"pageYOffset":"pageXOffset"]:d.support.boxModel&&y.document.documentElement[g]||y.document.body[g]:
m[g]}});d.each(["Height","Width"],function(a,b){var g=b.toLowerCase();d.fn["inner"+b]=function(){return this[0]?d.css(this[0],g,false,"padding"):null};d.fn["outer"+b]=function(n){return this[0]?d.css(this[0],g,false,n?"margin":"border"):null};d.fn[g]=function(n){var m=this[0];if(!m)return n==null?null:this;if(d.isFunction(n))return this.each(function(y){var z=d(this);z[g](n.call(this,y,z[g]()))});return"scrollTo"in m&&m.document?m.document.compatMode==="CSS1Compat"&&m.document.documentElement["client"+
b]||m.document.body["client"+b]:m.nodeType===9?Math.max(m.documentElement["client"+b],m.body["scroll"+b],m.documentElement["scroll"+b],m.body["offset"+b],m.documentElement["offset"+b]):n===undefined?d.css(m,g):this.css(g,typeof n==="string"?n:n+"px")}});u.$=u.jQuery=d});bespin.tiki.register("::embedded",{name:"embedded",dependencies:{theme_manager:"0.0.0",text_editor:"0.0.0",appconfig:"0.0.0",edit_session:"0.0.0",screen_theme:"0.0.0"}});bespin.tiki.module("embedded:index",function(){});
bespin.tiki.register("::appconfig",{name:"appconfig",dependencies:{jquery:"0.0.0",canon:"0.0.0",settings:"0.0.0"}});
bespin.tiki.module("appconfig:index",function(A,u){var v=A("jquery").$,r=A("settings").settings,o=A("bespin:promise").group,i=A("bespin:promise").Promise,e=A("bespin:console").console,f=A("bespin:util/stacktrace").Trace,q=A("bespin:util/util"),h=true;u.launch=function(p){var t=new i;v("#_bespin_loading").remove();var B;if(h){B=bespin.tiki.require;h=false}else B=(new (bespin.tiki.require("bespin:sandbox").Sandbox)).createRequire({id:"index",ownerPackage:bespin.tiki.loader.anonymousPackage});var C=
B("bespin:plugins").catalog;p=p||{};u.normalizeConfig(C,p);var d=p.objects;for(var J in d)C.registerObject(J,d[J]);for(var M in p.settings)r.set(M,p.settings[M]);var l=function(){var D=B("environment").env,K=D.editor;if(K){p.lineNumber&&K.setLineNumber(p.lineNumber);if(p.stealFocus)K.focus=true;if(p.readOnly)K.readOnly=p.readOnly;if(p.syntax)K.syntax=p.syntax}if(K=C.getObject("commandLine"))D.commandLine=K;C.publish(this,"appLaunched");t.resolve(D)}.bind(this),w=new i;w.then(function(){d.loginController?
C.createObject("loginController").then(function(D){D.showLogin().then(function(K){p.objects.session.arguments.push(K);u.launchEditor(C,p).then(l,t.reject.bind(t))})}):u.launchEditor(C,p).then(l,t.reject.bind(t))},function(D){t.reject(D)});C.plugins.theme_manager?bespin.tiki.require.ensurePackage("::theme_manager",function(){var D=B("theme_manager");p.theme.basePlugin&&D.setBasePlugin(p.theme.basePlugin);p.theme.standard&&D.setStandardTheme(p.theme.standard);D.startParsing().then(function(){w.resolve()},
function(K){w.reject(K)})}):w.resolve();return t};u.normalizeConfig=function(p,t){if(t.objects===undefined)t.objects={};if(t.autoload===undefined)t.autoload=[];if(t.theme===undefined)t.theme={};if(!t.theme.basePlugin&&p.plugins.screen_theme)t.theme.basePlugin="screen_theme";if(!t.initialContent)t.initialContent="";if(!t.settings)t.settings={};if(!t.objects.notifier&&p.plugins.notifier)t.objects.notifier={};if(!t.objects.loginController&&p.plugins.userident)t.objects.loginController={};if(!t.objects.fileHistory&&
p.plugins.file_history)t.objects.fileHistory={factory:"file_history",arguments:["session"],objects:{"0":"session"}};if(!t.objects.server&&p.plugins.bespin_server){t.objects.server={factory:"bespin_server"};t.objects.filesource={factory:"bespin_filesource",arguments:["server"],objects:{"0":"server"}}}if(!t.objects.files&&p.plugins.filesystem&&t.objects.filesource)t.objects.files={arguments:["filesource"],objects:{"0":"filesource"}};if(!t.objects.editor)t.objects.editor={factory:"text_editor",arguments:[t.initialContent]};
if(!t.objects.session)t.objects.session={arguments:["editor"],objects:{"0":"editor"}};if(!t.objects.commandLine&&p.plugins.command_line)t.objects.commandLine={};if(t.gui===undefined)t.gui={};p={};for(var B in t.gui){var C=t.gui[B];if(C.component)p[C.component]=true}if(!t.gui.center&&t.objects.editor&&!p.editor)t.gui.center={component:"editor"};if(!t.gui.south&&t.objects.commandLine&&!p.commandLine)t.gui.south={component:"commandLine"}};u.launchEditor=function(p,t){var B=new i;if(t===null){e.error("Cannot start editor without a configuration!");
B.reject("Cannot start editor without a configuration!");return B}k(p,t).then(function(){j(p,t,B)},function(C){e.error("Error while creating objects");(new f(C)).log();B.reject(C)});return B};var k=function(p,t){var B=[];for(var C in t.objects)B.push(p.createObject(C));return o(B)},j=function(p,t,B){var C=document.createElement("div");C.setAttribute("class","container");var d=document.createElement("div");d.setAttribute("class","center-container");C.appendChild(d);var J=t.element||document.body;q.addClass(J,
"bespin");J.appendChild(C);for(var M in t.gui){var l=t.gui[M],w=p.getObject(l.component);if(!w){p="Cannot find object "+l.component+" to attach to the Bespin UI";e.error(p);B.reject(p);return}J=w.element;if(!J){p="Component "+l.component+' does not have an "element" attribute to attach to the Bespin UI';e.error(p);B.reject(p);return}v(J).addClass(M);M=="west"||M=="east"||M=="center"?d.appendChild(J):C.appendChild(J);w.elementAppended&&w.elementAppended()}B.resolve()}});
bespin.tiki.register("::screen_theme",{name:"screen_theme",dependencies:{theme_manager:"0.0.0"}});bespin.tiki.module("screen_theme:index",function(){});
(function(){var A=bespin.tiki.require("jquery").$;A(document).ready(function(){bespin.tiki.require("bespin:plugins").catalog.registerMetadata({text_editor:{resourceURL:"resources/text_editor/",description:"Canvas-based text editor component and many common editing commands",dependencies:{completion:"0.0.0",undomanager:"0.0.0",settings:"0.0.0",canon:"0.0.0",rangeutils:"0.0.0",traits:"0.0.0",theme_manager:"0.0.0",keyboard:"0.0.0",edit_session:"0.0.0",syntax_manager:"0.0.0"},testmodules:["tests\\controllers\\testLayoutmanager",
"tests\\models\\testTextstorage","tests\\testScratchcanvas","tests\\utils\\testRect"],provides:[{action:"new",pointer:"views/editor#EditorView",ep:"factory",name:"text_editor"},{pointer:"views/editor#EditorView",ep:"appcomponent",name:"editor_view"},{predicates:{isTextView:true},pointer:"commands/editing#backspace",ep:"command",key:"backspace",name:"backspace"},{predicates:{isTextView:true},pointer:"commands/editing#deleteCommand",ep:"command",key:"delete",name:"delete"},{description:"Delete all lines currently selected",
key:"ctrl_d",predicates:{isTextView:true},pointer:"commands/editing#deleteLines",ep:"command",name:"deletelines"},{description:"Create a new, empty line below the current one",key:"ctrl_return",predicates:{isTextView:true},pointer:"commands/editing#openLine",ep:"command",name:"openline"},{description:"Join the current line with the following",key:"ctrl_shift_j",predicates:{isTextView:true},pointer:"commands/editing#joinLines",ep:"command",name:"joinline"},{params:[{defaultValue:"",type:"text",name:"text",
description:"The text to insert"}],pointer:"commands/editing#insertText",ep:"command",name:"insertText"},{predicates:{completing:false,isTextView:true},pointer:"commands/editing#newline",ep:"command",key:"return",name:"newline"},{predicates:{completing:false,isTextView:true},pointer:"commands/editing#tab",ep:"command",key:"tab",name:"tab"},{predicates:{isTextView:true},pointer:"commands/editing#untab",ep:"command",key:"shift_tab",name:"untab"},{predicates:{isTextView:true},ep:"command",name:"move"},
{description:"Repeat the last search (forward)",pointer:"commands/editor#findNextCommand",ep:"command",key:"ctrl_g",name:"findnext"},{description:"Repeat the last search (backward)",pointer:"commands/editor#findPrevCommand",ep:"command",key:"ctrl_shift_g",name:"findprev"},{predicates:{completing:false,isTextView:true},pointer:"commands/movement#moveDown",ep:"command",key:"down",name:"move down"},{predicates:{isTextView:true},pointer:"commands/movement#moveLeft",ep:"command",key:"left",name:"move left"},
{predicates:{isTextView:true},pointer:"commands/movement#moveRight",ep:"command",key:"right",name:"move right"},{predicates:{completing:false,isTextView:true},pointer:"commands/movement#moveUp",ep:"command",key:"up",name:"move up"},{predicates:{isTextView:true},ep:"command",name:"select"},{predicates:{isTextView:true},pointer:"commands/movement#selectDown",ep:"command",key:"shift_down",name:"select down"},{predicates:{isTextView:true},pointer:"commands/movement#selectLeft",ep:"command",key:"shift_left",
name:"select left"},{predicates:{isTextView:true},pointer:"commands/movement#selectRight",ep:"command",key:"shift_right",name:"select right"},{predicates:{isTextView:true},pointer:"commands/movement#selectUp",ep:"command",key:"shift_up",name:"select up"},{predicates:{isTextView:true},pointer:"commands/movement#moveLineEnd",ep:"command",key:["end","ctrl_right"],name:"move lineend"},{predicates:{isTextView:true},pointer:"commands/movement#selectLineEnd",ep:"command",key:["shift_end","ctrl_shift_right"],
name:"select lineend"},{predicates:{isTextView:true},pointer:"commands/movement#moveDocEnd",ep:"command",key:"ctrl_down",name:"move docend"},{predicates:{isTextView:true},pointer:"commands/movement#selectDocEnd",ep:"command",key:"ctrl_shift_down",name:"select docend"},{predicates:{isTextView:true},pointer:"commands/movement#moveLineStart",ep:"command",key:["home","ctrl_left"],name:"move linestart"},{predicates:{isTextView:true},pointer:"commands/movement#selectLineStart",ep:"command",key:["shift_home",
"ctrl_shift_left"],name:"select linestart"},{predicates:{isTextView:true},pointer:"commands/movement#moveDocStart",ep:"command",key:"ctrl_up",name:"move docstart"},{predicates:{isTextView:true},pointer:"commands/movement#selectDocStart",ep:"command",key:"ctrl_shift_up",name:"select docstart"},{predicates:{isTextView:true},pointer:"commands/movement#moveNextWord",ep:"command",key:["alt_right"],name:"move nextword"},{predicates:{isTextView:true},pointer:"commands/movement#selectNextWord",ep:"command",
key:["alt_shift_right"],name:"select nextword"},{predicates:{isTextView:true},pointer:"commands/movement#movePreviousWord",ep:"command",key:["alt_left"],name:"move prevword"},{predicates:{isTextView:true},pointer:"commands/movement#selectPreviousWord",ep:"command",key:["alt_shift_left"],name:"select prevword"},{predicates:{isTextView:true},pointer:"commands/movement#selectAll",ep:"command",key:["ctrl_a","meta_a"],name:"select all"},{predicates:{isTextView:true},ep:"command",name:"scroll"},{predicates:{isTextView:true},
pointer:"commands/scrolling#scrollDocStart",ep:"command",key:"ctrl_home",name:"scroll start"},{predicates:{isTextView:true},pointer:"commands/scrolling#scrollDocEnd",ep:"command",key:"ctrl_end",name:"scroll end"},{predicates:{isTextView:true},pointer:"commands/scrolling#scrollPageDown",ep:"command",key:"pagedown",name:"scroll down"},{predicates:{isTextView:true},pointer:"commands/scrolling#scrollPageUp",ep:"command",key:"pageup",name:"scroll up"},{pointer:"commands/editor#lcCommand",description:"Change all selected text to lowercase",
withKey:"CMD SHIFT L",ep:"command",name:"lc"},{pointer:"commands/editor#detabCommand",description:"Convert tabs to spaces.",params:[{defaultValue:null,type:"text",name:"tabsize",description:"Optionally, specify a tab size. (Defaults to setting.)"}],ep:"command",name:"detab"},{pointer:"commands/editor#entabCommand",description:"Convert spaces to tabs.",params:[{defaultValue:null,type:"text",name:"tabsize",description:"Optionally, specify a tab size. (Defaults to setting.)"}],ep:"command",name:"entab"},
{pointer:"commands/editor#trimCommand",description:"trim trailing or leading whitespace from each line in selection",params:[{defaultValue:"both",type:{data:[{name:"left"},{name:"right"},{name:"both"}],name:"selection"},name:"side",description:"Do we trim from the left, right or both"}],ep:"command",name:"trim"},{pointer:"commands/editor#ucCommand",description:"Change all selected text to uppercase",withKey:"CMD SHIFT U",ep:"command",name:"uc"},{predicates:{isTextView:true},pointer:"controllers/undo#undoManagerCommand",
ep:"command",key:["ctrl_shift_z"],name:"redo"},{predicates:{isTextView:true},pointer:"controllers/undo#undoManagerCommand",ep:"command",key:["ctrl_z"],name:"undo"},{description:"The distance in characters between each tab",defaultValue:8,type:"number",ep:"setting",name:"tabstop"},{description:"Customize the keymapping",defaultValue:"{}",type:"text",ep:"setting",name:"customKeymapping"},{description:"The keymapping to use",defaultValue:"standard",type:"text",ep:"setting",name:"keymapping"},{description:"The editor font size in pixels",
defaultValue:14,type:"number",ep:"setting",name:"fontsize"},{description:"The editor font face",defaultValue:"Monaco, Lucida Console, monospace",type:"text",ep:"setting",name:"fontface"},{defaultValue:{color:"#e5c138",paddingLeft:5,backgroundColor:"#4c4a41",paddingRight:10},ep:"themevariable",name:"gutter"},{defaultValue:{color:"#e6e6e6",selectedTextBackgroundColor:"#526da5",backgroundColor:"#2a211c",cursorColor:"#879aff",unfocusedCursorBackgroundColor:"#73171e",unfocusedCursorColor:"#ff0033"},ep:"themevariable",
name:"editor"},{defaultValue:{comment:"#666666",directive:"#999999",keyword:"#42A8ED",plain:"#e6e6e6",error:"#ff0000",operator:"#88BBFF",identifier:"#D841FF",string:"#039A0A"},ep:"themevariable",name:"highlighter"},{defaultValue:{nibStrokeStyle:"rgb(150, 150, 150)",fullAlpha:1,barFillStyle:"rgb(0, 0, 0)",particalAlpha:0.3,barFillGradientBottomStop:"rgb(44, 44, 44)",backgroundStyle:"#2A211C",thickness:17,padding:5,trackStrokeStyle:"rgb(150, 150, 150)",nibArrowStyle:"rgb(255, 255, 255)",barFillGradientBottomStart:"rgb(22, 22, 22)",
barFillGradientTopStop:"rgb(40, 40, 40)",barFillGradientTopStart:"rgb(90, 90, 90)",nibStyle:"rgb(100, 100, 100)",trackFillStyle:"rgba(50, 50, 50, 0.8)"},ep:"themevariable",name:"scroller"},{description:"Event: Notify when something within the editor changed.",params:[{required:true,name:"pointer",description:"Function that is called whenever a change happened."}],ep:"extensionpoint",name:"editorChange"}],type:"plugins\\supported",name:"text_editor"},cs_syntax:{resourceURL:"resources/cs_syntax/",name:"cs_syntax",
environments:{worker:true},dependencies:{standard_syntax:"0.0.0"},testmodules:[],provides:[{pointer:"#CSSyntax",ep:"syntax",fileexts:["cs"],name:"cs"}],type:"plugins\\thirdparty",description:"C# syntax highlighter"},less:{resourceURL:"resources/less/",description:"Leaner CSS",contributors:[],author:"Alexis Sellier <self@cloudhead.net>",url:"http://lesscss.org",version:"1.0.11",dependencies:{},testmodules:[],provides:[],keywords:["css","parser","lesscss","browser"],type:"plugins\\thirdparty",name:"less"},
theme_manager_base:{resourceURL:"resources/theme_manager_base/",name:"theme_manager_base",share:true,environments:{main:true},dependencies:{},testmodules:[],provides:[{description:"(Less)files holding the CSS style information for the UI.",params:[{required:true,name:"url",description:"Name of the ThemeStylesFile - can also be an array of files."}],ep:"extensionpoint",name:"themestyles"},{description:"Event: Notify when the theme(styles) changed.",params:[{required:true,name:"pointer",description:"Function that is called whenever the theme is changed."}],
ep:"extensionpoint",name:"themeChange"},{indexOn:"name",description:"A theme is a way change the look of the application.",params:[{required:false,name:"url",description:"Name of a ThemeStylesFile that holds theme specific CSS rules - can also be an array of files."},{required:true,name:"pointer",description:"Function that returns the ThemeData"}],ep:"extensionpoint",name:"theme"}],type:"plugins\\supported",description:"Defines extension points required for theming"},keyboard:{resourceURL:"resources/keyboard/",
description:"Keyboard shortcuts",dependencies:{canon:"0.0",settings:"0.0"},testmodules:["tests\\testKeyboard"],provides:[{description:"A keymapping defines how keystrokes are interpreted.",params:[{required:true,name:"states",description:"Holds the states and all the informations about the keymapping. See docs: pluginguide/keymapping"}],ep:"extensionpoint",name:"keymapping"}],type:"plugins\\supported",name:"keyboard"},edit_session:{resourceURL:"resources/edit_session/",description:"Ties together the files being edited with the views on screen",
dependencies:{events:"0.0.0"},testmodules:["tests\\testSession"],provides:[{action:"call",pointer:"#createSession",ep:"factory",name:"session"}],type:"plugins\\supported",name:"edit_session"},completion:{resourceURL:"resources/completion/",description:"Code completion support",dependencies:{jquery:"0.0.0",ctags:"0.0.0",rangeutils:"0.0.0",canon:"0.0.0",underscore:"0.0.0"},testmodules:[],provides:[{indexOn:"name",description:"Code completion support for specific languages",ep:"extensionpoint",name:"completion"},
{description:"Accept the chosen completion",key:["return","tab"],predicates:{completing:true},pointer:"controller#completeCommand",ep:"command",name:"complete"},{description:"Abandon the completion",key:"escape",predicates:{completing:true},pointer:"controller#completeCancelCommand",ep:"command",name:"complete cancel"},{description:"Choose the completion below",key:"down",predicates:{completing:true},pointer:"controller#completeDownCommand",ep:"command",name:"complete down"},{description:"Choose the completion above",
key:"up",predicates:{completing:true},pointer:"controller#completeUpCommand",ep:"command",name:"complete up"}],type:"plugins\\supported",name:"completion"},undomanager:{resourceURL:"resources/undomanager/",description:"Manages undoable events",testmodules:["tests\\testUndomanager"],provides:[{pointer:"#undoManagerCommand",ep:"command",key:["ctrl_shift_z"],name:"redo"},{pointer:"#undoManagerCommand",ep:"command",key:["ctrl_z"],name:"undo"}],type:"plugins\\supported",name:"undomanager"},rangeutils:{testmodules:["tests\\test"],
type:"plugins\\supported",resourceURL:"resources/rangeutils/",description:"Utility functions for dealing with ranges of text",name:"rangeutils"},stylesheet:{resourceURL:"resources/stylesheet/",name:"stylesheet",environments:{worker:true},dependencies:{standard_syntax:"0.0.0"},testmodules:[],provides:[{pointer:"#CSSSyntax",ep:"syntax",fileexts:["css","less"],name:"css"}],type:"plugins\\supported",description:"CSS syntax highlighter"},html:{resourceURL:"resources/html/",name:"html",environments:{worker:true},
dependencies:{standard_syntax:"0.0.0"},testmodules:[],provides:[{pointer:"#HTMLSyntax",ep:"syntax",fileexts:["htm","html"],name:"html"}],type:"plugins\\supported",description:"HTML syntax highlighter"},js_syntax:{resourceURL:"resources/js_syntax/",name:"js_syntax",environments:{worker:true},dependencies:{standard_syntax:"0.0.0"},testmodules:[],provides:[{pointer:"#JSSyntax",ep:"syntax",fileexts:["js","json"],name:"js"}],type:"plugins\\supported",description:"JavaScript syntax highlighter"},ctags:{resourceURL:"resources/ctags/",
description:"Reads and writes tag files",dependencies:{traits:"0.0.0",underscore:"0.0.0"},testmodules:[],type:"plugins\\supported",name:"ctags"},theme_manager:{resourceURL:"resources/theme_manager/",name:"theme_manager",share:true,environments:{main:true,worker:false},dependencies:{theme_manager_base:"0.0.0",settings:"0.0.0",events:"0.0.0",less:"0.0.0"},testmodules:[],provides:[{unregister:"themestyles#unregisterThemeStyles",register:"themestyles#registerThemeStyles",ep:"extensionhandler",name:"themestyles"},
{unregister:"index#unregisterTheme",register:"index#registerTheme",ep:"extensionhandler",name:"theme"},{defaultValue:"standard",description:"The theme plugin's name to use. If set to 'standard' no theme will be used",type:"text",ep:"setting",name:"theme"},{pointer:"#appLaunched",ep:"appLaunched"}],type:"plugins\\supported",description:"Handles colors in Bespin"},whitetheme:{resourceURL:"resources/whitetheme/",description:"Provides a white theme for Bespin",dependencies:{theme_manager:"0.0.0"},testmodules:[],
provides:[{url:["theme.less"],description:"A basic white theme",pointer:"index#whiteTheme",ep:"theme",name:"white"}],type:"plugins\\supported",name:"whitetheme"},standard_syntax:{resourceURL:"resources/standard_syntax/",description:"Easy-to-use basis for syntax engines",environments:{worker:true},dependencies:{syntax_worker:"0.0.0",syntax_directory:"0.0.0",underscore:"0.0.0"},testmodules:[],type:"plugins\\supported",name:"standard_syntax"},jquery:{testmodules:[],resourceURL:"resources/jquery/",name:"jquery",
type:"plugins\\thirdparty"},embedded:{testmodules:[],dependencies:{theme_manager:"0.0.0",text_editor:"0.0.0",appconfig:"0.0.0",edit_session:"0.0.0",screen_theme:"0.0.0"},resourceURL:"resources/embedded/",name:"embedded",type:"plugins\\supported"},sql_syntax:{resourceURL:"resources/sql_syntax/",name:"sql_syntax",environments:{worker:true},dependencies:{syntax_manager:"0.0.0"},testmodules:[],provides:[{pointer:"#SQLSyntax",ep:"syntax",fileexts:["sql"],name:"sql"}],type:"plugins\\thirdparty",description:"Python syntax highlighter"},
appconfig:{resourceURL:"resources/appconfig/",description:"Instantiates components and displays the GUI based on configuration.",dependencies:{jquery:"0.0.0",canon:"0.0.0",settings:"0.0.0"},testmodules:[],provides:[{description:"Event: Fired when the app is completely launched.",ep:"extensionpoint",name:"appLaunched"}],type:"plugins\\supported",name:"appconfig"},syntax_worker:{resourceURL:"resources/syntax_worker/",description:"Coordinates multiple syntax engines",environments:{worker:true},dependencies:{syntax_directory:"0.0.0",
underscore:"0.0.0"},testmodules:[],type:"plugins\\supported",name:"syntax_worker"},screen_theme:{resourceURL:"resources/screen_theme/",description:"Bespins standard theme basePlugin",dependencies:{theme_manager:"0.0.0"},testmodules:[],provides:[{url:["theme.less"],ep:"themestyles"},{defaultValue:"@global_font",ep:"themevariable",name:"container_font"},{defaultValue:"@global_font_size",ep:"themevariable",name:"container_font_size"},{defaultValue:"@global_container_background",ep:"themevariable",name:"container_bg"},
{defaultValue:"@global_color",ep:"themevariable",name:"container_color"},{defaultValue:"@global_line_height",ep:"themevariable",name:"container_line_height"},{defaultValue:"@global_pane_background",ep:"themevariable",name:"pane_bg"},{defaultValue:"@global_pane_border_radius",ep:"themevariable",name:"pane_border_radius"},{defaultValue:"@global_form_font",ep:"themevariable",name:"form_font"},{defaultValue:"@global_form_font_size",ep:"themevariable",name:"form_font_size"},{defaultValue:"@global_form_line_height",
ep:"themevariable",name:"form_line_height"},{defaultValue:"@global_form_color",ep:"themevariable",name:"form_color"},{defaultValue:"@global_form_text_shadow",ep:"themevariable",name:"form_text_shadow"},{defaultValue:"@global_pane_link_color",ep:"themevariable",name:"pane_a_color"},{defaultValue:"@global_font",ep:"themevariable",name:"pane_font"},{defaultValue:"@global_font_size",ep:"themevariable",name:"pane_font_size"},{defaultValue:"@global_pane_text_shadow",ep:"themevariable",name:"pane_text_shadow"},
{defaultValue:"@global_pane_h1_font",ep:"themevariable",name:"pane_h1_font"},{defaultValue:"@global_pane_h1_font_size",ep:"themevariable",name:"pane_h1_font_size"},{defaultValue:"@global_pane_h1_color",ep:"themevariable",name:"pane_h1_color"},{defaultValue:"@global_font_size * 1.8",ep:"themevariable",name:"pane_line_height"},{defaultValue:"@global_pane_color",ep:"themevariable",name:"pane_color"},{defaultValue:"@global_text_shadow",ep:"themevariable",name:"pane_text_shadow"},{defaultValue:"@global_font",
ep:"themevariable",name:"button_font"},{defaultValue:"@global_font_size",ep:"themevariable",name:"button_font_size"},{defaultValue:"@global_button_color",ep:"themevariable",name:"button_color"},{defaultValue:"@global_button_background",ep:"themevariable",name:"button_bg"},{defaultValue:"@button_bg - #063A27",ep:"themevariable",name:"button_bg2"},{defaultValue:"@button_bg - #194A5E",ep:"themevariable",name:"button_border"},{defaultValue:"@global_control_background",ep:"themevariable",name:"control_bg"},
{defaultValue:"@global_control_color",ep:"themevariable",name:"control_color"},{defaultValue:"@global_control_border",ep:"themevariable",name:"control_border"},{defaultValue:"@global_control_border_radius",ep:"themevariable",name:"control_border_radius"},{defaultValue:"@global_control_active_background",ep:"themevariable",name:"control_active_bg"},{defaultValue:"@global_control_active_border",ep:"themevariable",name:"control_active_border"},{defaultValue:"@global_control_active_color",ep:"themevariable",
name:"control_active_color"},{defaultValue:"@global_control_active_inset_color",ep:"themevariable",name:"control_active_inset_color"}],type:"plugins\\supported",name:"screen_theme"}})})})();
(function(){var A=bespin.tiki.require("jquery").$,u=function(v,r,o){v=v.style[o]||document.defaultView.getComputedStyle(v,"").getPropertyValue(o);if(!v||v=="auto"||v=="intrinsic")v=r.style[o];return v};bespin.useBespin=function(v,r){var o=bespin.tiki.require("bespin:util/util"),i={},e=i.settings;r=r||{};for(var f in r)i[f]=r[f];r=i.settings;if(e!==undefined)for(f in e)if(r[f]===undefined)i.settings[f]=e[f];var q=null,h=new (bespin.tiki.require("bespin:promise").Promise);bespin.tiki.require.ensurePackage("::appconfig",
function(){var k=bespin.tiki.require("appconfig");if(o.isString(v))v=document.getElementById(v);if(o.none(i.initialContent))i.initialContent=v.value||v.innerHTML;v.innerHTML="";if(v.type=="textarea"){var j=v.parentNode,p=document.createElement("div"),t=function(){var C="position:relative;";["margin-top","margin-left","margin-right","margin-bottom"].forEach(function(M){C+=M+":"+u(v,p,M)+";"});var d=u(v,p,"width"),J=u(v,p,"height");C+="height:"+J+";width:"+d+";";C+="display:inline-block;";p.setAttribute("style",
C)};window.addEventListener("resize",t,false);t();for(v.nextSibling?j.insertBefore(p,v.nextSibling):j.appendChild(p);j!==document;){if(j.tagName.toUpperCase()==="FORM"){var B=j.onsubmit;j.onsubmit=function(C){v.value=q.editor.value;v.innerHTML=q.editor.value;B&&B.call(this,C)};break}j=j.parentNode}v.style.display="none";i.element=p;if(!o.none(v.getAttribute("readonly")))i.readOnly=true}else i.element=v;k.launch(i).then(function(C){q=C;h.resolve(C)})});return h};A(document).ready(function(){for(var v=
[],r=document.querySelectorAll(".bespin"),o=0;o<r.length;o++){var i=r[o],e=i.getAttribute("data-bespinoptions")||"{}";e=bespin.useBespin(i,JSON.parse(e));e.then(function(f){i.bespin=f},function(f){throw new Error("Launch failed: "+f);});v.push(e)}if(window.onBespinLoad){r=bespin.tiki.require("bespin:promise").group;r(v).then(function(){window.onBespinLoad()},function(){throw new Error("At least one Bespin failed to launch!");})}})})();
